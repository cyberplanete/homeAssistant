[{"id":"63ef5fda.dd974","type":"tab","label":"Lumière","disabled":false,"info":"","env":[]},{"id":"7a831b6e2f802ee7","type":"tab","label":"Chauffage","disabled":false,"info":"","env":[]},{"id":"2751f6a3a0a7649a","type":"tab","label":"Alarme","disabled":false,"info":"","env":[]},{"id":"96aba16699ebe8be","type":"tab","label":"Ballon Eau Chaude","disabled":false,"info":"","env":[]},{"id":"335bd89f27c73b7e","type":"tab","label":"Communications - Alexa - SMS - Telegram","disabled":false,"info":"","env":[]},{"id":"8ac4bc30b42b7a7d","type":"tab","label":"Notifications","disabled":false,"info":"","env":[]},{"id":"d9ababc8eca2aa56","type":"tab","label":"Portails et volets","disabled":false,"info":"","env":[]},{"id":"bd8aec8f1871271e","type":"tab","label":"Doorbird && Tablette","disabled":false,"info":"","env":[]},{"id":"32a912a98d31efc0","type":"tab","label":"Alexa - Objets","disabled":false,"info":"","env":[]},{"id":"b094d7f93a062c25","type":"tab","label":"Auto-Reboot HA et add-on","disabled":false,"info":"ha addons list","env":[]},{"id":"b6bf4fb2.8e8618","type":"tab","label":"Téléinfo","disabled":false,"info":""},{"id":"ca87c975.6f38b","type":"tab","label":"Puissance instantanée","disabled":false,"info":""},{"id":"c375fce693136161","type":"tab","label":"Météo","disabled":false,"info":"","env":[]},{"id":"d7f40c000c1a05ef","type":"tab","label":"Informatique","disabled":false,"info":"","env":[]},{"id":"7512dcc2.be07d4","type":"mqtt-broker","name":"mosquitto","broker":"192.168.0.243","port":"1883","clientid":"NodeRed","usetls":false,"compatmode":true,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"29cc3035.d7f7","type":"serial-port","serialport":"/dev/ttyUSB0","serialbaud":"1200","databits":"7","parity":"even","stopbits":"1","waitfor":"","newline":"0x3","bin":"false","out":"char","addchar":"","responsetimeout":"10000"},{"id":"a5f60f435cd422f8","type":"light-scheduler-settings","name":"MaMaison","latitude":"48.856614","longitude":"2.3522219"},{"id":"43d85569dace75e0","type":"server","name":"Home Assistant","version":2,"addon":true,"rejectUnauthorizedCerts":true,"ha_boolean":"y|yes|true|on|home|open","connectionDelay":false,"cacheJson":true,"heartbeat":true,"heartbeatInterval":"30"},{"id":"5837179e.526928","type":"websocket-client","path":"ws://supervisor/core/api/websocket","tls":"","wholemsg":"false"},{"id":"c4125295ecc90f0d","type":"doorbird-config","name":"Doorbird","host":"192.168.0.175","scheme":"https"},{"id":"da25d8286baff521","type":"serial-port","serialport":"/dev/ttyUSB0","serialbaud":"1200","databits":"7","parity":"even","stopbits":"1","waitfor":"","newline":"0x3","bin":"false","out":"char","addchar":"","responsetimeout":"10000"},{"id":"580338f6.25a79","type":"mqtt-broker","name":"mosquitto","broker":"192.168.0.90","port":"1883","clientid":"NodeRed","usetls":false,"compatmode":true,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"3cc77e8f498a61f2","type":"server-state-changed","z":"63ef5fda.dd974","name":"IR Garage","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.ir_garage_occupancy","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"on","halt_if_type":"str","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":80,"y":107,"wires":[["0447dd138dc2f62b"],["a86315cf7f3fb738"]]},{"id":"a86315cf7f3fb738","type":"delay","z":"63ef5fda.dd974","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":340,"y":160,"wires":[["5bc8f1d00b2809f3"]]},{"id":"b6a6cdf2e837a57c","type":"comment","z":"63ef5fda.dd974","name":"Lumière garage","info":"","x":360,"y":47,"wires":[]},{"id":"1f7c2ac821d4a422","type":"link in","z":"63ef5fda.dd974","name":"LumièreGarage","links":["9909e41fa72aad88"],"x":535,"y":140,"wires":[["0447dd138dc2f62b"]]},{"id":"5bc8f1d00b2809f3","type":"link out","z":"63ef5fda.dd974","name":"versLumièreGarageOFF","mode":"link","links":["b504a0cc4c01fe52"],"x":495,"y":220,"wires":[]},{"id":"0447dd138dc2f62b","type":"api-call-service","z":"63ef5fda.dd974","name":"Lumière garage ON","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.multilevel_power_switch_instance_1_level","data":"{\"brightness_pct\":100}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":690,"y":107,"wires":[[]]},{"id":"f94dde5cbcea28a9","type":"server-state-changed","z":"63ef5fda.dd974","name":"IsLightGarageOnFor5Minutes","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"light.multilevel_power_switch_instance_1_level","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"on","halt_if_type":"str","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":"8","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"true","valueType":"bool"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":120,"y":260,"wires":[["1671eb8967b5b31d","6b447626cffbf808"],[]]},{"id":"e44b25d7cdb5aeb4","type":"server-state-changed","z":"63ef5fda.dd974","name":"IR Garage","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.ir_garage_occupancy","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"off","halt_if_type":"str","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"true","valueType":"bool"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":160,"y":320,"wires":[["1671eb8967b5b31d","6b447626cffbf808"],[]]},{"id":"1671eb8967b5b31d","type":"and-gate","z":"63ef5fda.dd974","name":"","rules":[{"t":"true","propertyType":"msg","property":"payload","topic":"light.multilevel_power_switch_instance_1_level"},{"t":"true","propertyType":"msg","property":"payload","topic":"binary_sensor.ir_garage_occupancy"}],"outputTopic":"","gateType":"and","emitOnlyIfTrue":true,"x":380,"y":280,"wires":[["5bc8f1d00b2809f3","6b447626cffbf808"]]},{"id":"6b447626cffbf808","type":"debug","z":"63ef5fda.dd974","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":460,"y":420,"wires":[]},{"id":"545b82574f071d40","type":"comment","z":"63ef5fda.dd974","name":"Télécommande - Eclairage salon lecture","info":"","x":380,"y":800,"wires":[]},{"id":"9e75743d3b936f4c","type":"server-state-changed","z":"63ef5fda.dd974","name":"Télécommande - Eclairage salon","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.telecommande_ampoule_salon_action","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":410,"y":680,"wires":[["f8d9e4f74c1e198c","2257313d46ada8fd"]]},{"id":"f8d9e4f74c1e198c","type":"switch","z":"63ef5fda.dd974","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"eq","v":"off","vt":"str"},{"t":"eq","v":"brightness_move_up","vt":"str"},{"t":"eq","v":"brightness_move_down","vt":"str"}],"checkall":"true","repair":false,"outputs":4,"x":720,"y":680,"wires":[["b4752f9256ad0b6a"],["fc062bfec72a7e1e"],["aaf0d97ca420adda"],["9df81c3525300c5c"]]},{"id":"2257313d46ada8fd","type":"debug","z":"63ef5fda.dd974","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":680,"y":620,"wires":[]},{"id":"b4752f9256ad0b6a","type":"api-call-service","z":"63ef5fda.dd974","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.ampoule_salon","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1020,"y":600,"wires":[[]]},{"id":"fc062bfec72a7e1e","type":"api-call-service","z":"63ef5fda.dd974","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"light.ampoule_salon","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1010,"y":660,"wires":[[]]},{"id":"aaf0d97ca420adda","type":"api-call-service","z":"63ef5fda.dd974","name":"Luminosité +","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.ampoule_salon","data":"{\"brightness_step_pct\":10}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":990,"y":700,"wires":[[]]},{"id":"9df81c3525300c5c","type":"api-call-service","z":"63ef5fda.dd974","name":"Luminosité -","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.ampoule_salon","data":"{\"brightness_step_pct\":-10}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":990,"y":740,"wires":[[]]},{"id":"de416c43a96d6d5e","type":"switch","z":"63ef5fda.dd974","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"eq","v":"off","vt":"str"},{"t":"eq","v":"brightness_move_up","vt":"str"},{"t":"eq","v":"brightness_move_down","vt":"str"}],"checkall":"true","repair":false,"outputs":4,"x":710,"y":900,"wires":[["8c8c8acfb1b37f75"],["7cd8e5fc27bb650a"],["44986fbac8887aba"],["4375414e369b9434"]]},{"id":"7099fa3e601c06b5","type":"server-state-changed","z":"63ef5fda.dd974","name":"Télécommande - Eclairage salon lecture","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.telecommande_lumiere_ampoule_salon_lecture_action","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":420,"y":900,"wires":[["de416c43a96d6d5e"]]},{"id":"b9ebaed8073a0973","type":"comment","z":"63ef5fda.dd974","name":"Télécommande - Eclairage salon","info":"","x":370,"y":560,"wires":[]},{"id":"8c8c8acfb1b37f75","type":"api-call-service","z":"63ef5fda.dd974","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.ampoule_salon_lecture","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":990,"y":840,"wires":[[]]},{"id":"7cd8e5fc27bb650a","type":"api-call-service","z":"63ef5fda.dd974","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"light.ampoule_salon_lecture","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1000,"y":900,"wires":[[]]},{"id":"44986fbac8887aba","type":"api-call-service","z":"63ef5fda.dd974","name":"Luminosité +","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.ampoule_salon_lecture","data":"{\"brightness_step_pct\":10}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":980,"y":940,"wires":[[]]},{"id":"4375414e369b9434","type":"api-call-service","z":"63ef5fda.dd974","name":"Luminosité -","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.ampoule_salon_lecture","data":"{\"brightness_step_pct\":-10}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":980,"y":980,"wires":[[]]},{"id":"c5790fe2a3dbbd1e","type":"comment","z":"63ef5fda.dd974","name":"Télécommande - Eclairage chambre parents","info":"","x":390,"y":1100,"wires":[]},{"id":"80d9b525f995326c","type":"switch","z":"63ef5fda.dd974","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"eq","v":"off","vt":"str"},{"t":"eq","v":"brightness_move_up","vt":"str"},{"t":"eq","v":"brightness_move_down","vt":"str"}],"checkall":"true","repair":false,"outputs":4,"x":710,"y":1200,"wires":[["9cd5a447888bff96"],["1d41ba2ff024b7a5"],["571e033dd1e27cbb"],["a0e11075ef2b3aa1"]]},{"id":"f10743ec0d8cb815","type":"server-state-changed","z":"63ef5fda.dd974","name":"Télécommande - Eclairage chambre parents","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.telecommande_chambre_parents_action","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":430,"y":1200,"wires":[["80d9b525f995326c"]]},{"id":"9cd5a447888bff96","type":"api-call-service","z":"63ef5fda.dd974","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"switch.lumiere_chambre_parents","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1010,"y":1140,"wires":[[]]},{"id":"1d41ba2ff024b7a5","type":"api-call-service","z":"63ef5fda.dd974","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.lumiere_chambre_parents","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1000,"y":1200,"wires":[[]]},{"id":"571e033dd1e27cbb","type":"api-call-service","z":"63ef5fda.dd974","name":"Luminosité +","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.ampoule_chambre_parents_1, light.ampoule_chambre_parents_2","data":"{\"brightness_step_pct\":10}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":980,"y":1240,"wires":[[]]},{"id":"a0e11075ef2b3aa1","type":"api-call-service","z":"63ef5fda.dd974","name":"Luminosité -","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.ampoule_chambre_parents_1, light.ampoule_chambre_parents_2","data":"{\"brightness_step_pct\":-10}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":980,"y":1280,"wires":[[]]},{"id":"31c0c3c77564037b","type":"comment","z":"63ef5fda.dd974","name":"Télécommande - Eclairage chambre clarence","info":"","x":390,"y":1440,"wires":[]},{"id":"a2232bdb6581fc0d","type":"switch","z":"63ef5fda.dd974","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"toggle","vt":"str"},{"t":"eq","v":"brightness_up_click","vt":"str"},{"t":"eq","v":"brightness_down_click","vt":"str"},{"t":"eq","v":"arrow_right_click","vt":"str"},{"t":"eq","v":"arrow_left_click","vt":"str"}],"checkall":"true","repair":false,"outputs":5,"x":710,"y":1540,"wires":[["faf5ec473bdb9165"],["5bbcc7397750789a"],["cce3af9b6c137f01"],["d72fea2fa6cf67ab"],["cce7ac524907057d"]]},{"id":"7725f723d3f53e57","type":"server-state-changed","z":"63ef5fda.dd974","name":"Telecommande - Clarence","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.telecommande_ikea_chambre_clarence_action","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":370,"y":1540,"wires":[["a2232bdb6581fc0d","749c80331638cc37"]]},{"id":"faf5ec473bdb9165","type":"api-call-service","z":"63ef5fda.dd974","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"switch","service":"toggle","entityId":"light.lumiere_chambre_clarence","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":990,"y":1500,"wires":[["7adb4b9a315503a8"]]},{"id":"5bbcc7397750789a","type":"api-call-service","z":"63ef5fda.dd974","name":"Luminosité +","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.ampoule_chambre_clarence","data":"{\"brightness_step_pct\":10}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":970,"y":1560,"wires":[[]]},{"id":"cce3af9b6c137f01","type":"api-call-service","z":"63ef5fda.dd974","name":"Luminosité -","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.ampoule_chambre_clarence","data":"{\"brightness_step_pct\":-10}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":970,"y":1620,"wires":[[]]},{"id":"749c80331638cc37","type":"debug","z":"63ef5fda.dd974","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":640,"y":1480,"wires":[]},{"id":"d72fea2fa6cf67ab","type":"api-call-service","z":"63ef5fda.dd974","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"input_number","service":"increment","entityId":"input_number.color_select_chambre_rue","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":720,"y":1680,"wires":[["bc29350ef27af4ef"]]},{"id":"3989e560190c3209","type":"api-call-service","z":"63ef5fda.dd974","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.ampoule_chambre_clarence","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1350,"y":1760,"wires":[[]]},{"id":"1864e74ff9fbb3e3","type":"function","z":"63ef5fda.dd974","name":"","func":"msg.payload = \n    {\n    data: {\n    \n    xy_color: msg.payloadxy\n    }\n    \n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1180,"y":1680,"wires":[["cd053d811a3d74ba","747683b7502aecfc"]]},{"id":"bc29350ef27af4ef","type":"api-render-template","z":"63ef5fda.dd974","name":"yx","server":"43d85569dace75e0","version":0,"template":"[{{state_attr('sensor.color_template_chambre_rue', 'x') | float}},{{state_attr('sensor.color_template_chambre_rue', 'y') | float}}]","resultsLocation":"payloadxy","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":1010,"y":1680,"wires":[["1864e74ff9fbb3e3"]]},{"id":"7adb4b9a315503a8","type":"api-call-service","z":"63ef5fda.dd974","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"switch","service":"toggle","entityId":"switch.lumiere_chambre_rue","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1290,"y":1500,"wires":[[]]},{"id":"33574e61b3faadd5","type":"function","z":"63ef5fda.dd974","name":"","func":"msg.payload = \n    {\n    data: {\n    \n    xy_color: msg.payloadxy\n    }\n    \n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1160,"y":1760,"wires":[["3989e560190c3209"]]},{"id":"7197cfe7c1876a5d","type":"api-render-template","z":"63ef5fda.dd974","name":"yx","server":"43d85569dace75e0","version":0,"template":"[{{state_attr('sensor.color_template_chambre_rue', 'x') | float}},{{state_attr('sensor.color_template_chambre_rue', 'y') | float}}]","resultsLocation":"payloadxy","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":990,"y":1760,"wires":[["33574e61b3faadd5"]]},{"id":"cd053d811a3d74ba","type":"api-call-service","z":"63ef5fda.dd974","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.ampoule_chambre_clarence","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1390,"y":1680,"wires":[[]]},{"id":"cce7ac524907057d","type":"api-call-service","z":"63ef5fda.dd974","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"input_number","service":"decrement","entityId":"input_number.color_select_chambre_rue","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":690,"y":1760,"wires":[["7197cfe7c1876a5d"]]},{"id":"747683b7502aecfc","type":"debug","z":"63ef5fda.dd974","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":1380,"y":1640,"wires":[]},{"id":"e2e25e792ec57ee9","type":"api-call-service","z":"7a831b6e2f802ee7","name":"Radiateur Sam - Confort","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"climate","service":"set_preset_mode","entityId":"climate.radiateur_sam","data":"{\"preset_mode\":\"comfort\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1370,"y":160,"wires":[[]]},{"id":"392823b42515bb5c","type":"comment","z":"7a831b6e2f802ee7","name":"Chauffage buanderie","info":"","x":340,"y":500,"wires":[]},{"id":"98f74902da0bb149","type":"comment","z":"7a831b6e2f802ee7","name":"Chauffage SAM","info":"","x":400,"y":60,"wires":[]},{"id":"1b306c90311a2df5","type":"light-scheduler","z":"7a831b6e2f802ee7","settings":"a5f60f435cd422f8","events":"[{\"start\":{\"dow\":0,\"mod\":450},\"end\":{\"dow\":0,\"mod\":570}},{\"start\":{\"dow\":1,\"mod\":1110},\"end\":{\"dow\":1,\"mod\":1235}},{\"start\":{\"dow\":2,\"mod\":1110},\"end\":{\"dow\":2,\"mod\":1235}},{\"start\":{\"dow\":3,\"mod\":1110},\"end\":{\"dow\":3,\"mod\":1235}},{\"start\":{\"dow\":4,\"mod\":1110},\"end\":{\"dow\":4,\"mod\":1235}},{\"start\":{\"dow\":5,\"mod\":1110},\"end\":{\"dow\":5,\"mod\":1235}},{\"start\":{\"dow\":6,\"mod\":450},\"end\":{\"dow\":6,\"mod\":570}},{\"start\":{\"dow\":6,\"mod\":720},\"end\":{\"dow\":6,\"mod\":810}},{\"start\":{\"dow\":0,\"mod\":720},\"end\":{\"dow\":0,\"mod\":810}},{\"start\":{\"dow\":0,\"mod\":1110},\"end\":{\"dow\":0,\"mod\":1230}}]","topic":"calendrierCuisine","name":"Chauffage - Cuisine","onPayload":"true","onPayloadType":"bool","offPayload":"false","offPayloadType":"bool","onlyWhenDark":false,"scheduleRndMax":0,"sunElevationThreshold":6,"sunShowElevationInStatus":false,"outputfreq":"output.statechange.startup","x":120,"y":940,"wires":[["6ff256fd4a9b8d43","1ea29afa73a8c45b"]]},{"id":"04be2aebef9a1318","type":"api-call-service","z":"7a831b6e2f802ee7","name":"Radiateur Cuisine - Confort","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"climate","service":"set_preset_mode","entityId":"climate.radiateur_cuisine","data":"{\"preset_mode\":\"comfort\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1200,"y":860,"wires":[[]]},{"id":"3d5e835a8e5b85fb","type":"api-call-service","z":"7a831b6e2f802ee7","name":"Radiateur Cuisine  - eco","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"climate","service":"set_preset_mode","entityId":"climate.radiateur_cuisine","data":"{\"preset_mode\":\"eco\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1210,"y":1000,"wires":[[]]},{"id":"48eaba83bbab6c83","type":"api-render-template","z":"7a831b6e2f802ee7","name":"IsOnOtherPresetThanConfort","server":"43d85569dace75e0","version":0,"template":"{{true if state_attr('climate.radiateur_cuisine', 'preset_mode') != 'comfort' }}\n{{false if state_attr('climate.radiateur_cuisine', 'preset_mode') == 'comfort' }} ","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":800,"y":860,"wires":[["95e0dfedbb7a55ef"]]},{"id":"f25b29d086dc8928","type":"api-render-template","z":"7a831b6e2f802ee7","name":"IsOnOtherPresetThanEco","server":"43d85569dace75e0","version":0,"template":"{{true if state_attr('climate.radiateur_cuisine', 'preset_mode') != 'eco' }}\n{{false if state_attr('climate.radiateur_cuisine', 'preset_mode') == 'eco' }} ","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":790,"y":960,"wires":[["2df0d708da8d8645"]]},{"id":"95e0dfedbb7a55ef","type":"switch","z":"7a831b6e2f802ee7","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"True","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":990,"y":840,"wires":[["04be2aebef9a1318","3f957b21082c0c77"]]},{"id":"2df0d708da8d8645","type":"switch","z":"7a831b6e2f802ee7","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"True","vt":"str"},{"t":"eq","v":"False","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":990,"y":960,"wires":[["3d5e835a8e5b85fb","67b4f79b53b07da1"],[]]},{"id":"ddb906c06a881220","type":"comment","z":"7a831b6e2f802ee7","name":"Chauffage cuisine","info":"","x":370,"y":800,"wires":[]},{"id":"3f957b21082c0c77","type":"function","z":"7a831b6e2f802ee7","name":"Notification - mode confort","func":"msg.payload =\n\n\"Passage du radiateur de la cuisine en mode confort\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1180,"y":800,"wires":[["c46c39c6a03e868d"]]},{"id":"c46c39c6a03e868d","type":"link out","z":"7a831b6e2f802ee7","name":"VersEchos","mode":"link","links":["34dd5813f28f2a42","ced87f2e5d5c0601"],"x":1410,"y":800,"wires":[],"l":true},{"id":"67b4f79b53b07da1","type":"function","z":"7a831b6e2f802ee7","name":"Notification - mode eco","func":"msg.payload =\n\n\"Passage du radiateur de la cuisine en mode éco\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1210,"y":920,"wires":[["5f2f4b2a804ffa16"]]},{"id":"5f2f4b2a804ffa16","type":"link out","z":"7a831b6e2f802ee7","name":"VersEchos","mode":"link","links":["34dd5813f28f2a42","ced87f2e5d5c0601"],"x":1410,"y":920,"wires":[],"l":true},{"id":"c147033a1177be52","type":"function","z":"7a831b6e2f802ee7","name":"Notification - mode confort","func":"msg.payload =\n\n\"Passage du radiateur de la salle à manger en mode confort\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1380,"y":80,"wires":[["17706589d3767fc3"]]},{"id":"17706589d3767fc3","type":"link out","z":"7a831b6e2f802ee7","name":"VersEchos","mode":"link","links":["34dd5813f28f2a42","a7ddbf0dfd2c325b","ced87f2e5d5c0601","f550e12c1257457e"],"x":1610,"y":80,"wires":[],"l":true},{"id":"2f41dcd9008a319c","type":"link out","z":"7a831b6e2f802ee7","name":"VersEchos","mode":"link","links":["ced87f2e5d5c0601"],"x":1530,"y":240,"wires":[],"l":true},{"id":"83b0b7b2533d3339","type":"api-render-template","z":"7a831b6e2f802ee7","name":"IsOnOtherPresetThanComfort","server":"43d85569dace75e0","version":0,"template":"{{true if state_attr('climate.radiateur_sam', 'preset_mode') != 'comfort' }}\n{{false if state_attr('climate.radiateur_sam', 'preset_mode') == 'comfort' }} ","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":850,"y":160,"wires":[["4f90be1e258f0906"]],"outputLabels":["true"]},{"id":"39cc21d6da081a70","type":"comment","z":"7a831b6e2f802ee7","name":"Chauffage chambre Eloise","info":"","x":350,"y":1140,"wires":[]},{"id":"f81b9394463377de","type":"api-call-service","z":"7a831b6e2f802ee7","name":"Radiateur jardin- Confort","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"climate","service":"set_preset_mode","entityId":"climate.radiateur_ch_jardin","data":"{\"preset_mode\":\"comfort\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1230,"y":1220,"wires":[[]]},{"id":"58be7f5c0669a6f2","type":"api-call-service","z":"7a831b6e2f802ee7","name":"Radiateur jardin - eco","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"climate","service":"set_preset_mode","entityId":"climate.radiateur_ch_jardin","data":"{\"preset_mode\":\"eco\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1220,"y":1360,"wires":[[]]},{"id":"248a0861f6b75066","type":"api-render-template","z":"7a831b6e2f802ee7","name":"IsOnOtherPresetThanConfort","server":"43d85569dace75e0","version":0,"template":"{{true if state_attr('climate.radiateur_ch_jardin', 'preset_mode') != 'comfort' }}\n{{false if state_attr('climate.radiateur_ch_jardin', 'preset_mode') == 'comfort' }} ","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":800,"y":1220,"wires":[["3ef55b2d1300619a"]]},{"id":"15cfbaa0fef73c35","type":"api-render-template","z":"7a831b6e2f802ee7","name":"IsOnOtherPresetThanEco","server":"43d85569dace75e0","version":0,"template":"{{true if state_attr('climate.radiateur_ch_jardin', 'preset_mode') != 'eco' }}\n{{false if state_attr('climate.radiateur_ch_jardin', 'preset_mode') == 'eco' }} ","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":790,"y":1320,"wires":[["06b57d075ebce306"]]},{"id":"3ef55b2d1300619a","type":"switch","z":"7a831b6e2f802ee7","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"True","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":990,"y":1220,"wires":[["f81b9394463377de","bcbb757740ac1121"]]},{"id":"06b57d075ebce306","type":"switch","z":"7a831b6e2f802ee7","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"True","vt":"str"},{"t":"eq","v":"False","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":1010,"y":1340,"wires":[["58be7f5c0669a6f2","f41e7cedf17af631"],[]]},{"id":"bcbb757740ac1121","type":"function","z":"7a831b6e2f802ee7","name":"Notification - mode confort","func":"msg.payload =\n\n\"Passage du radiateur chambre eloise en mode confort\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1240,"y":1160,"wires":[["7bd4578970e08cb8"]]},{"id":"7bd4578970e08cb8","type":"link out","z":"7a831b6e2f802ee7","name":"VersEchos","mode":"link","links":["a7ddbf0dfd2c325b"],"x":1480,"y":1160,"wires":[],"l":true},{"id":"f41e7cedf17af631","type":"function","z":"7a831b6e2f802ee7","name":"Notification - mode eco","func":"msg.payload =\n\n\"Passage du radiateur chambre eloise en mode eco\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1230,"y":1300,"wires":[["7892c444cc4ff6b2"]]},{"id":"7892c444cc4ff6b2","type":"link out","z":"7a831b6e2f802ee7","name":"VersEchos","mode":"link","links":["a7ddbf0dfd2c325b"],"x":1470,"y":1300,"wires":[],"l":true},{"id":"1a7075d20b0c4ce0","type":"light-scheduler","z":"7a831b6e2f802ee7","settings":"a5f60f435cd422f8","events":"[{\"start\":{\"dow\":1,\"mod\":480},\"end\":{\"dow\":1,\"mod\":750}},{\"start\":{\"dow\":2,\"mod\":480},\"end\":{\"dow\":2,\"mod\":750}},{\"start\":{\"dow\":3,\"mod\":480},\"end\":{\"dow\":3,\"mod\":750}},{\"start\":{\"dow\":4,\"mod\":480},\"end\":{\"dow\":4,\"mod\":750}},{\"start\":{\"dow\":5,\"mod\":480},\"end\":{\"dow\":5,\"mod\":750}},{\"start\":{\"dow\":6,\"mod\":600},\"end\":{\"dow\":6,\"mod\":750}},{\"start\":{\"dow\":0,\"mod\":600},\"end\":{\"dow\":0,\"mod\":750}},{\"start\":{\"dow\":1,\"mod\":840},\"end\":{\"dow\":1,\"mod\":1320}},{\"start\":{\"dow\":2,\"mod\":840},\"end\":{\"dow\":2,\"mod\":1320}},{\"start\":{\"dow\":3,\"mod\":840},\"end\":{\"dow\":3,\"mod\":1320}},{\"start\":{\"dow\":4,\"mod\":840},\"end\":{\"dow\":4,\"mod\":1320}},{\"start\":{\"dow\":5,\"mod\":840},\"end\":{\"dow\":5,\"mod\":1320}},{\"start\":{\"dow\":6,\"mod\":840},\"end\":{\"dow\":6,\"mod\":1320}}]","topic":"EloiseCalendrier","name":"Jour/nuit","onPayload":"true","onPayloadType":"bool","offPayload":"false","offPayloadType":"bool","onlyWhenDark":false,"scheduleRndMax":0,"sunElevationThreshold":6,"sunShowElevationInStatus":false,"outputfreq":"output.statechange.startup","x":80,"y":1340,"wires":[["8d8423fab6ceef84","faf593bf6d32149b"]]},{"id":"2c0dac6784c5c517","type":"comment","z":"7a831b6e2f802ee7","name":"Chauffage chambre parents","info":"","x":380,"y":1540,"wires":[]},{"id":"6e00c75adaa860a9","type":"api-call-service","z":"7a831b6e2f802ee7","name":"Radiateur parents - Confort","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"climate","service":"set_preset_mode","entityId":"climate.radiateur_ch_parents","data":"{\"preset_mode\":\"comfort\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1220,"y":1600,"wires":[[]]},{"id":"4f2062d5191b0287","type":"api-call-service","z":"7a831b6e2f802ee7","name":"Radiateur parents - eco","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"climate","service":"set_preset_mode","entityId":"climate.radiateur_ch_parents","data":"{\"preset_mode\":\"eco\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1210,"y":1740,"wires":[[]]},{"id":"eb6442e395457d3f","type":"api-render-template","z":"7a831b6e2f802ee7","name":"IsOnOtherPresetThanConfort","server":"43d85569dace75e0","version":0,"template":"{{true if state_attr('climate.radiateur_ch_parents', 'preset_mode') != 'comfort' }}\n{{false if state_attr('climate.radiateur_ch_parents', 'preset_mode') == 'comfort' }} ","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":780,"y":1600,"wires":[["c791bc6abe6c79ca"]]},{"id":"ab843ab40f3c73a3","type":"api-render-template","z":"7a831b6e2f802ee7","name":"IsOnOtherPresetThanEco","server":"43d85569dace75e0","version":0,"template":"{{true if state_attr('climate.radiateur_ch_parents', 'preset_mode') != 'eco' }}\n{{false if state_attr('climate.radiateur_ch_parents', 'preset_mode') == 'eco' }} ","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":770,"y":1740,"wires":[["e9fedf3cb2a3d342"]]},{"id":"c791bc6abe6c79ca","type":"switch","z":"7a831b6e2f802ee7","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"True","vt":"str"},{"t":"eq","v":"False","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":990,"y":1600,"wires":[["6e00c75adaa860a9","b1522de11672435f"],[]]},{"id":"e9fedf3cb2a3d342","type":"switch","z":"7a831b6e2f802ee7","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"True","vt":"str"},{"t":"eq","v":"False","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":990,"y":1720,"wires":[["4f2062d5191b0287","e2fdf53f94de98fe"],[]]},{"id":"b1522de11672435f","type":"function","z":"7a831b6e2f802ee7","name":"Notification - mode confort","func":"msg.payload =\n\n\"Passage du radiateur chambre parents en mode confort\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1220,"y":1540,"wires":[["f37e4d23d6b44aaa"]]},{"id":"f37e4d23d6b44aaa","type":"link out","z":"7a831b6e2f802ee7","name":"VersEchos","mode":"link","links":["a7ddbf0dfd2c325b"],"x":1460,"y":1540,"wires":[],"l":true},{"id":"e2fdf53f94de98fe","type":"function","z":"7a831b6e2f802ee7","name":"Notification - mode eco","func":"msg.payload =\n\n\"Passage du radiateur chambre parents en mode eco\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1210,"y":1680,"wires":[["6b3cc193f1f04e48"]]},{"id":"6b3cc193f1f04e48","type":"link out","z":"7a831b6e2f802ee7","name":"VersEchos","mode":"link","links":["a7ddbf0dfd2c325b"],"x":1450,"y":1680,"wires":[],"l":true},{"id":"a48c7596e3a82ea5","type":"server-state-changed","z":"7a831b6e2f802ee7","name":"isPascalHome","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"device_tracker.portable_pascal","entityidfiltertype":"substring","outputinitially":true,"state_type":"str","haltifstate":"home","halt_if_type":"str","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"true","valueType":"bool"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":70,"y":140,"wires":[["1382b7adc6a3ec0d"],["f397ae265c0f5344"]]},{"id":"ec6d337e8ebeded1","type":"server-state-changed","z":"7a831b6e2f802ee7","name":"isTemp <19","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.temp_chjardin_bt_temperature_3","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"19","halt_if_type":"num","halt_if_compare":"lt","outputs":2,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"true","valueType":"bool"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":70,"y":1260,"wires":[["8d8423fab6ceef84"],["faf593bf6d32149b"]]},{"id":"4672c25362475026","type":"server-state-changed","z":"7a831b6e2f802ee7","name":"isEloiseHome","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"device_tracker.eloise","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"home","halt_if_type":"str","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"true","valueType":"bool"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":70,"y":1180,"wires":[["8d8423fab6ceef84"],["faf593bf6d32149b"]]},{"id":"9afdb852ea3fedea","type":"server-state-changed","z":"7a831b6e2f802ee7","name":"isComputerOn","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.onoff_bureau_salon_electric_consumed_w_3","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"50","halt_if_type":"num","halt_if_compare":"gt","outputs":2,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"true","valueType":"bool"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":70,"y":340,"wires":[["3b28f871af37f07f"],["5fbda43fae0f3d49"]]},{"id":"1382b7adc6a3ec0d","type":"and-gate","z":"7a831b6e2f802ee7","name":"AND","rules":[{"t":"true","propertyType":"msg","property":"payload","topic":"device_tracker.portable_pascal"},{"t":"true","propertyType":"msg","property":"payload","topic":"sensor.temp_sam_bt_temperature"},{"t":"true","propertyType":"msg","property":"payload","topic":"OrGate"}],"outputTopic":"titi","gateType":"and","emitOnlyIfTrue":true,"x":450,"y":160,"wires":[["b156c2b646e7bab6"]],"icon":"node-red-contrib-bool-gate/and.png"},{"id":"3b28f871af37f07f","type":"or-gate","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"true","propertyType":"msg","property":"payload","topic":"sensor.onoff_bureau_salon_electric_consumed_w_3"},{"t":"true","propertyType":"msg","property":"payload","topic":"sensor.prise_tv_salon_energy"}],"outputTopic":"OrGate","gateType":"or","emitOnlyIfTrue":true,"x":300,"y":240,"wires":[["1382b7adc6a3ec0d"]]},{"id":"6962cc75a4cf0643","type":"server-state-changed","z":"7a831b6e2f802ee7","name":"isTemp <19","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.temp_sam_bt_temperature","entityidfiltertype":"exact","outputinitially":true,"state_type":"num","haltifstate":"19","halt_if_type":"num","halt_if_compare":"lte","outputs":2,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":true,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"true","valueType":"bool"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":130,"y":200,"wires":[["1382b7adc6a3ec0d"],["f397ae265c0f5344"]]},{"id":"6b2c10ae38173426","type":"server-state-changed","z":"7a831b6e2f802ee7","name":"isTvOn","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.prise_tv_salon_energy","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"50","halt_if_type":"num","halt_if_compare":"gte","outputs":2,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"true","valueType":"bool"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":70,"y":280,"wires":[["3b28f871af37f07f"],["5fbda43fae0f3d49"]]},{"id":"4f90be1e258f0906","type":"switch","z":"7a831b6e2f802ee7","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"True","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":1070,"y":160,"wires":[["e2e25e792ec57ee9","c147033a1177be52"]]},{"id":"b156c2b646e7bab6","type":"change","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":620,"y":160,"wires":[["83b0b7b2533d3339"]]},{"id":"7e62bab351a4d77f","type":"api-call-service","z":"7a831b6e2f802ee7","name":"Radiateur Sam - eco","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"climate","service":"set_preset_mode","entityId":"climate.radiateur_sam","data":"{\"preset_mode\":\"eco\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1280,"y":300,"wires":[[]]},{"id":"8cf4d55a994326fc","type":"function","z":"7a831b6e2f802ee7","name":"Notification - mode eco","func":"msg.payload =\n\n\"Passage du radiateur de la salle à manger en mode éco\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1290,"y":240,"wires":[["2f41dcd9008a319c"]]},{"id":"6fa13ac6619cef84","type":"switch","z":"7a831b6e2f802ee7","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"True","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":1070,"y":260,"wires":[["8cf4d55a994326fc","7e62bab351a4d77f"]]},{"id":"5fbda43fae0f3d49","type":"and-gate","z":"7a831b6e2f802ee7","name":"AND","rules":[{"t":"true","propertyType":"msg","property":"payload","topic":"sensor.prise_tv_salon_energy"},{"t":"true","propertyType":"msg","property":"payload","topic":"sensor.onoff_bureau_salon_electric_consumed_w_3"}],"outputTopic":"AndGate","gateType":"and","emitOnlyIfTrue":true,"x":310,"y":320,"wires":[["f397ae265c0f5344"]],"icon":"node-red-contrib-bool-gate/and.png"},{"id":"2f2a5668e1708fad","type":"api-render-template","z":"7a831b6e2f802ee7","name":"IsOnOtherPresetThanEco","server":"43d85569dace75e0","version":0,"template":"{{true if state_attr('climate.radiateur_sam', 'preset_mode') != 'eco' }}\n{{false if state_attr('climate.radiateur_sam', 'preset_mode') == 'eco' }} ","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":870,"y":260,"wires":[["6fa13ac6619cef84"]],"outputLabels":["true"]},{"id":"55695ee92395776c","type":"change","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":640,"y":260,"wires":[["2f2a5668e1708fad"]]},{"id":"f397ae265c0f5344","type":"or-gate","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"true","propertyType":"msg","property":"payload","topic":"device_tracker.portable_pascal"},{"t":"true","propertyType":"msg","property":"payload","topic":"AndGate"},{"t":"true","propertyType":"msg","property":"payload","topic":"sensor.temp_sam_bt_temperature"}],"outputTopic":"","gateType":"or","emitOnlyIfTrue":true,"x":460,"y":280,"wires":[["55695ee92395776c"]]},{"id":"73b36b318991bce4","type":"change","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":500,"y":1320,"wires":[["15cfbaa0fef73c35","f37aba1f9f02ea43"]]},{"id":"8d8423fab6ceef84","type":"and-gate","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"true","propertyType":"msg","property":"payload","topic":"device_tracker.eloise"},{"t":"true","propertyType":"msg","property":"payload","topic":"sensor.temp_chjardin_bt_temperature_3"},{"t":"true","propertyType":"msg","property":"payload","topic":"EloiseCalendrier"}],"outputTopic":"","gateType":"and","emitOnlyIfTrue":true,"x":340,"y":1220,"wires":[["ecbdbcf61f86d4cb"]]},{"id":"faf593bf6d32149b","type":"or-gate","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"true","propertyType":"msg","property":"payload","topic":"device_tracker.eloise"},{"t":"true","propertyType":"msg","property":"payload","topic":"sensor.temp_chjardin_bt_temperature_3"},{"t":"false","propertyType":"msg","property":"payload","topic":"EloiseCalendrier"}],"outputTopic":"","gateType":"or","emitOnlyIfTrue":true,"x":320,"y":1320,"wires":[["73b36b318991bce4"]]},{"id":"f37aba1f9f02ea43","type":"link out","z":"7a831b6e2f802ee7","name":"","mode":"link","links":["cbe32f55acef23f2"],"x":625,"y":1420,"wires":[]},{"id":"1b187d282e0e6760","type":"link out","z":"7a831b6e2f802ee7","name":"","mode":"link","links":["b1a36af9e30d2a54"],"x":645,"y":1280,"wires":[]},{"id":"b1a36af9e30d2a54","type":"link in","z":"7a831b6e2f802ee7","name":"radiateurParentsConfort","links":["1b187d282e0e6760","dfc0064001084cd0"],"x":525,"y":1600,"wires":[["eb6442e395457d3f"]]},{"id":"cbe32f55acef23f2","type":"link in","z":"7a831b6e2f802ee7","name":"radiateurParentsEco","links":["f37aba1f9f02ea43","b625ed6e5536f5f0"],"x":535,"y":1740,"wires":[["ab843ab40f3c73a3"]]},{"id":"ecbdbcf61f86d4cb","type":"change","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":540,"y":1220,"wires":[["248a0861f6b75066","1b187d282e0e6760"]]},{"id":"dbadae76b895decc","type":"change","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":540,"y":960,"wires":[["f25b29d086dc8928"]]},{"id":"6ff256fd4a9b8d43","type":"and-gate","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"true","propertyType":"msg","property":"payload","topic":"sensor.ir_cuisine_temperature"},{"t":"true","propertyType":"msg","property":"payload","topic":"calendrierCuisine"}],"outputTopic":"","gateType":"and","emitOnlyIfTrue":true,"x":340,"y":860,"wires":[["66451cf9b43a8e30"]]},{"id":"1ea29afa73a8c45b","type":"or-gate","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"true","propertyType":"msg","property":"payload","topic":"sensor.ir_cuisine_temperature"},{"t":"false","propertyType":"msg","property":"payload","topic":"calendrierCuisine"}],"outputTopic":"","gateType":"or","emitOnlyIfTrue":true,"x":340,"y":960,"wires":[["dbadae76b895decc"]]},{"id":"66451cf9b43a8e30","type":"change","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":540,"y":860,"wires":[["48eaba83bbab6c83"]]},{"id":"b03292d8964ae0b0","type":"server-state-changed","z":"7a831b6e2f802ee7","name":"isTemp < 19","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.ir_cuisine_temperature","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"19","halt_if_type":"num","halt_if_compare":"lt","outputs":2,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"true","valueType":"bool"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":120,"y":860,"wires":[["6ff256fd4a9b8d43"],["1ea29afa73a8c45b"]]},{"id":"d002f596873981b8","type":"api-render-template","z":"7a831b6e2f802ee7","name":"IsOnOtherPresetThanConfort","server":"43d85569dace75e0","version":0,"template":"{{true if state_attr('climate.radiateur_buanderie', 'preset_mode') != 'comfort' }}\n{{false if state_attr('climate.radiateur_buanderie', 'preset_mode') == 'comfort' }} ","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":800,"y":600,"wires":[["61fb1a582904f876"]]},{"id":"67d85580bf20ebc5","type":"api-render-template","z":"7a831b6e2f802ee7","name":"IsOnOtherPresetThanEco","server":"43d85569dace75e0","version":0,"template":"{{true if state_attr('climate.radiateur_buanderie', 'preset_mode') != 'eco' }}\n{{false if state_attr('climate.radiateur_buanderie', 'preset_mode') == 'eco' }} ","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":790,"y":700,"wires":[["80a0868c4753dc08"]]},{"id":"61fb1a582904f876","type":"switch","z":"7a831b6e2f802ee7","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"True","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":990,"y":580,"wires":[["50df2ffb70bd173d","1ce87e1e2fe04f14"]]},{"id":"80a0868c4753dc08","type":"switch","z":"7a831b6e2f802ee7","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"True","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":990,"y":700,"wires":[["2988fa4dc465e564","dfb464041b5e94af"]]},{"id":"7cb3cef86f265f17","type":"change","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":540,"y":700,"wires":[["67d85580bf20ebc5"]]},{"id":"d647120d8ba1c98b","type":"and-gate","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"true","propertyType":"msg","property":"payload","topic":"sensor.temp_buanderie_bt_temperature"},{"t":"true","propertyType":"msg","property":"payload","topic":"calendrierBuanderie"}],"outputTopic":"","gateType":"and","emitOnlyIfTrue":true,"x":340,"y":600,"wires":[["b54fecac8dc676c6"]]},{"id":"bd47d0fe2b7c85f9","type":"or-gate","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"true","propertyType":"msg","property":"payload","topic":"sensor.temp_buanderie_bt_temperature"},{"t":"false","propertyType":"msg","property":"payload","topic":"calendrierBuanderie"}],"outputTopic":"","gateType":"or","emitOnlyIfTrue":true,"x":340,"y":700,"wires":[["7cb3cef86f265f17"]]},{"id":"b54fecac8dc676c6","type":"change","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":540,"y":600,"wires":[["d002f596873981b8"]]},{"id":"6b252d70a50167ed","type":"server-state-changed","z":"7a831b6e2f802ee7","name":"isTemp < 19","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.temp_buanderie_bt_temperature","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"19","halt_if_type":"num","halt_if_compare":"lt","outputs":2,"output_only_on_state_change":true,"for":"30","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"true","valueType":"bool"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":90,"y":660,"wires":[["d647120d8ba1c98b"],["bd47d0fe2b7c85f9"]]},{"id":"bc457a9ccfa56a2a","type":"light-scheduler","z":"7a831b6e2f802ee7","settings":"a5f60f435cd422f8","events":"[{\"start\":{\"dow\":3,\"mod\":450},\"end\":{\"dow\":3,\"mod\":870}},{\"start\":{\"dow\":4,\"mod\":450},\"end\":{\"dow\":4,\"mod\":870}},{\"start\":{\"dow\":5,\"mod\":450},\"end\":{\"dow\":5,\"mod\":870}},{\"start\":{\"dow\":6,\"mod\":600},\"end\":{\"dow\":6,\"mod\":750}},{\"start\":{\"dow\":0,\"mod\":600},\"end\":{\"dow\":0,\"mod\":750}},{\"start\":{\"dow\":2,\"mod\":450},\"end\":{\"dow\":2,\"mod\":870}},{\"start\":{\"dow\":1,\"mod\":450},\"end\":{\"dow\":1,\"mod\":870}},{\"start\":{\"dow\":1,\"mod\":960},\"end\":{\"dow\":1,\"mod\":1080}},{\"start\":{\"dow\":2,\"mod\":960},\"end\":{\"dow\":2,\"mod\":1080}},{\"start\":{\"dow\":3,\"mod\":960},\"end\":{\"dow\":3,\"mod\":1080}},{\"start\":{\"dow\":4,\"mod\":960},\"end\":{\"dow\":4,\"mod\":1080}},{\"start\":{\"dow\":5,\"mod\":960},\"end\":{\"dow\":5,\"mod\":1080}}]","topic":"calendrierBuanderie","name":"Agenda - Buanderie","onPayload":"true","onPayloadType":"bool","offPayload":"false","offPayloadType":"bool","onlyWhenDark":false,"scheduleRndMax":0,"sunElevationThreshold":6,"sunShowElevationInStatus":false,"outputfreq":"output.statechange.startup","x":120,"y":600,"wires":[["d647120d8ba1c98b","bd47d0fe2b7c85f9"]]},{"id":"1ce87e1e2fe04f14","type":"api-call-service","z":"7a831b6e2f802ee7","name":"Radiateur Buanderie - Confort","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"climate","service":"set_preset_mode","entityId":"climate.radiateur_buanderie","data":"{\"preset_mode\":\"comfort\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1230,"y":600,"wires":[["1b4087e29ce87db6"]]},{"id":"50df2ffb70bd173d","type":"function","z":"7a831b6e2f802ee7","name":"Notification - mode confort","func":"msg.payload =\n\n\"Passage du radiateur de la buanderie en mode confort\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1220,"y":560,"wires":[["73a8d137381b7e3e"]]},{"id":"73a8d137381b7e3e","type":"link out","z":"7a831b6e2f802ee7","name":"VersEchos","mode":"link","links":["34dd5813f28f2a42","ced87f2e5d5c0601"],"x":1460,"y":560,"wires":[],"l":true},{"id":"dfb464041b5e94af","type":"api-call-service","z":"7a831b6e2f802ee7","name":"Radiateur Buanderie - eco","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"climate","service":"set_preset_mode","entityId":"climate.radiateur_buanderie","data":"{\"preset_mode\":\"eco\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1200,"y":740,"wires":[[]]},{"id":"2988fa4dc465e564","type":"function","z":"7a831b6e2f802ee7","name":"Notification - mode eco","func":"msg.payload =\n\n\"Passage du radiateur de la buanderie en mode éco\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1190,"y":680,"wires":[["308795887e84b451"]]},{"id":"308795887e84b451","type":"link out","z":"7a831b6e2f802ee7","name":"VersEchos","mode":"link","links":["34dd5813f28f2a42","ced87f2e5d5c0601"],"x":1430,"y":680,"wires":[],"l":true},{"id":"1b4087e29ce87db6","type":"debug","z":"7a831b6e2f802ee7","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1500,"y":500,"wires":[]},{"id":"21e49c34ac54c44e","type":"inject","z":"7a831b6e2f802ee7","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":970,"y":480,"wires":[["1ce87e1e2fe04f14"]]},{"id":"bf2876d9d86168f5","type":"inject","z":"7a831b6e2f802ee7","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1040,"y":60,"wires":[["c147033a1177be52"]]},{"id":"078843ba91f95bdb","type":"comment","z":"7a831b6e2f802ee7","name":"Chauffage chambre Clarence","info":"","x":400,"y":1920,"wires":[]},{"id":"acc124fd763ee83c","type":"api-call-service","z":"7a831b6e2f802ee7","name":"Radiateur jardin- Confort","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"climate","service":"set_preset_mode","entityId":"climate.radiateur_ch_rue","data":"{\"preset_mode\":\"comfort\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1270,"y":2000,"wires":[[]]},{"id":"8795f1d59dbd3a31","type":"api-call-service","z":"7a831b6e2f802ee7","name":"Radiateur jardin - eco","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"climate","service":"set_preset_mode","entityId":"climate.radiateur_ch_rue","data":"{\"preset_mode\":\"eco\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1260,"y":2140,"wires":[[]]},{"id":"4f4302cb8180ee19","type":"api-render-template","z":"7a831b6e2f802ee7","name":"IsOnOtherPresetThanConfort","server":"43d85569dace75e0","version":0,"template":"{{true if state_attr('climate.radiateur_ch_rue', 'preset_mode') != 'comfort' }}\n{{false if state_attr('climate.radiateur_ch_rue', 'preset_mode') == 'comfort' }} ","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":840,"y":2000,"wires":[["bcdc10760b8acae7"]]},{"id":"c8c48ccb48f3827e","type":"api-render-template","z":"7a831b6e2f802ee7","name":"IsOnOtherPresetThanEco","server":"43d85569dace75e0","version":0,"template":"{{true if state_attr('climate.radiateur_ch_rue', 'preset_mode') != 'eco' }}\n{{false if state_attr('climate.radiateur_ch_rue', 'preset_mode') == 'eco' }} ","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":830,"y":2100,"wires":[["c773e89820e776b1"]]},{"id":"bcdc10760b8acae7","type":"switch","z":"7a831b6e2f802ee7","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"True","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":1030,"y":2000,"wires":[["acc124fd763ee83c","1a3681a88116ed54"]]},{"id":"c773e89820e776b1","type":"switch","z":"7a831b6e2f802ee7","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"True","vt":"str"},{"t":"eq","v":"False","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":1050,"y":2120,"wires":[["8795f1d59dbd3a31","693c4110da126693"],[]]},{"id":"1a3681a88116ed54","type":"function","z":"7a831b6e2f802ee7","name":"Notification - mode confort","func":"msg.payload =\n\n\"Passage du radiateur chambre clarence en mode confort\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1280,"y":1940,"wires":[["c11e0c64c64fa4db"]]},{"id":"c11e0c64c64fa4db","type":"link out","z":"7a831b6e2f802ee7","name":"VersEchos","mode":"link","links":["a7ddbf0dfd2c325b"],"x":1520,"y":1940,"wires":[],"l":true},{"id":"693c4110da126693","type":"function","z":"7a831b6e2f802ee7","name":"Notification - mode eco","func":"msg.payload =\n\n\"Passage du radiateur chambre clarence en mode eco\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1270,"y":2080,"wires":[["87c8497266b9e62c"]]},{"id":"87c8497266b9e62c","type":"link out","z":"7a831b6e2f802ee7","name":"VersEchos","mode":"link","links":["a7ddbf0dfd2c325b"],"x":1510,"y":2080,"wires":[],"l":true},{"id":"b63e7aac4b32c903","type":"light-scheduler","z":"7a831b6e2f802ee7","settings":"a5f60f435cd422f8","events":"[{\"start\":{\"dow\":1,\"mod\":480},\"end\":{\"dow\":1,\"mod\":750}},{\"start\":{\"dow\":2,\"mod\":480},\"end\":{\"dow\":2,\"mod\":750}},{\"start\":{\"dow\":3,\"mod\":480},\"end\":{\"dow\":3,\"mod\":750}},{\"start\":{\"dow\":4,\"mod\":480},\"end\":{\"dow\":4,\"mod\":750}},{\"start\":{\"dow\":5,\"mod\":480},\"end\":{\"dow\":5,\"mod\":750}},{\"start\":{\"dow\":6,\"mod\":600},\"end\":{\"dow\":6,\"mod\":750}},{\"start\":{\"dow\":0,\"mod\":600},\"end\":{\"dow\":0,\"mod\":750}},{\"start\":{\"dow\":1,\"mod\":840},\"end\":{\"dow\":1,\"mod\":1320}},{\"start\":{\"dow\":2,\"mod\":840},\"end\":{\"dow\":2,\"mod\":1320}},{\"start\":{\"dow\":3,\"mod\":840},\"end\":{\"dow\":3,\"mod\":1320}},{\"start\":{\"dow\":4,\"mod\":840},\"end\":{\"dow\":4,\"mod\":1320}},{\"start\":{\"dow\":5,\"mod\":840},\"end\":{\"dow\":5,\"mod\":1320}},{\"start\":{\"dow\":6,\"mod\":840},\"end\":{\"dow\":6,\"mod\":1320}}]","topic":"CalendrierClarence","name":"Jour/nuit","onPayload":"true","onPayloadType":"bool","offPayload":"false","offPayloadType":"bool","onlyWhenDark":false,"scheduleRndMax":0,"sunElevationThreshold":6,"sunShowElevationInStatus":false,"outputfreq":"output.statechange.startup","x":120,"y":2120,"wires":[["1848dfc6be8b3ffa","4481f49c03885ffc"]]},{"id":"396b905b2bda0080","type":"server-state-changed","z":"7a831b6e2f802ee7","name":"isTemp <19","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.temp_chclarence_bt_temperature","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"19","halt_if_type":"num","halt_if_compare":"lt","outputs":2,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"true","valueType":"bool"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":110,"y":2040,"wires":[["1848dfc6be8b3ffa"],["4481f49c03885ffc"]]},{"id":"c2ef1912493f89ee","type":"server-state-changed","z":"7a831b6e2f802ee7","name":"isEloiseHome","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"device_tracker.eloise","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"home","halt_if_type":"str","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"true","valueType":"bool"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":110,"y":1960,"wires":[["1848dfc6be8b3ffa"],["4481f49c03885ffc"]]},{"id":"22bbb573483358c8","type":"change","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":540,"y":2100,"wires":[["c8c48ccb48f3827e"]]},{"id":"1848dfc6be8b3ffa","type":"and-gate","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"true","propertyType":"msg","property":"payload","topic":"device_tracker.eloise"},{"t":"true","propertyType":"msg","property":"payload","topic":"sensor.temp_chclarence_bt_temperature"},{"t":"true","propertyType":"msg","property":"payload","topic":"CalendrierClarence"}],"outputTopic":"","gateType":"and","emitOnlyIfTrue":true,"x":380,"y":2000,"wires":[["496e5b9c58f1f72f"]]},{"id":"4481f49c03885ffc","type":"or-gate","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"true","propertyType":"msg","property":"payload","topic":"device_tracker.eloise"},{"t":"true","propertyType":"msg","property":"payload","topic":"sensor.temp_chclarence_bt_temperature"},{"t":"false","propertyType":"msg","property":"payload","topic":"CalendrierClarence"}],"outputTopic":"","gateType":"or","emitOnlyIfTrue":true,"x":360,"y":2100,"wires":[["22bbb573483358c8"]]},{"id":"496e5b9c58f1f72f","type":"change","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":580,"y":2000,"wires":[["4f4302cb8180ee19"]]},{"id":"092d70bd9122ee49","type":"comment","z":"7a831b6e2f802ee7","name":"Chauffage Entree","info":"","x":620,"y":2260,"wires":[]},{"id":"c75c779194463359","type":"api-call-service","z":"7a831b6e2f802ee7","name":"Radiateur Entree - Confort","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.radiateur_entree_level","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1260,"y":2340,"wires":[[]]},{"id":"7bd1fc9c438706f6","type":"api-call-service","z":"7a831b6e2f802ee7","name":"Radiateur entree - eco","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"light.radiateur_entree_level","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1240,"y":2480,"wires":[[]]},{"id":"dc244e3018fd4c4b","type":"api-render-template","z":"7a831b6e2f802ee7","name":"IsOnOtherPresetThanConfort","server":"43d85569dace75e0","version":0,"template":"{{true if states('light.radiateur_entree_level') != 'on' }}\n{{false if states('light.radiateur_entree_level') == 'on' }} ","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":820,"y":2340,"wires":[["8bb45d5c38bfce67"]]},{"id":"47d24de99f4d5891","type":"api-render-template","z":"7a831b6e2f802ee7","name":"IsOnOtherPresetThanEco","server":"43d85569dace75e0","version":0,"template":"{{true if states('light.radiateur_entree_level') != 'off' }}\n{{false if states('light.radiateur_entree_level') == 'off' }} ","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":810,"y":2440,"wires":[["acb3ce2720b23c69"]]},{"id":"8bb45d5c38bfce67","type":"switch","z":"7a831b6e2f802ee7","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"True","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":1010,"y":2340,"wires":[["c75c779194463359","a522500b641e9eec"]]},{"id":"acb3ce2720b23c69","type":"switch","z":"7a831b6e2f802ee7","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"True","vt":"str"},{"t":"eq","v":"False","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":1030,"y":2460,"wires":[["7bd1fc9c438706f6","f19796000de1422e"],[]]},{"id":"a522500b641e9eec","type":"function","z":"7a831b6e2f802ee7","name":"Notification - mode confort","func":"msg.payload =\n\n\"Passage du radiateur chambre Entree en mode confort\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1260,"y":2280,"wires":[["33ff312129ca488d"]]},{"id":"33ff312129ca488d","type":"link out","z":"7a831b6e2f802ee7","name":"VersEchos","mode":"link","links":["a7ddbf0dfd2c325b"],"x":1500,"y":2280,"wires":[],"l":true},{"id":"f19796000de1422e","type":"function","z":"7a831b6e2f802ee7","name":"Notification - mode eco","func":"msg.payload =\n\n\"Passage du radiateur chambre Entree en mode eco\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1250,"y":2420,"wires":[["622de4989d2d1ff8"]]},{"id":"622de4989d2d1ff8","type":"link out","z":"7a831b6e2f802ee7","name":"VersEchos","mode":"link","links":["a7ddbf0dfd2c325b"],"x":1490,"y":2420,"wires":[],"l":true},{"id":"641a05abad155210","type":"light-scheduler","z":"7a831b6e2f802ee7","settings":"a5f60f435cd422f8","events":"[{\"start\":{\"dow\":2,\"mod\":380},\"end\":{\"dow\":2,\"mod\":540}},{\"start\":{\"dow\":5,\"mod\":380},\"end\":{\"dow\":5,\"mod\":540}},{\"start\":{\"dow\":3,\"mod\":380},\"end\":{\"dow\":3,\"mod\":540}},{\"start\":{\"dow\":1,\"mod\":1020},\"end\":{\"dow\":1,\"mod\":1170}},{\"start\":{\"dow\":2,\"mod\":1020},\"end\":{\"dow\":2,\"mod\":1170}},{\"start\":{\"dow\":3,\"mod\":1020},\"end\":{\"dow\":3,\"mod\":1170}},{\"start\":{\"dow\":4,\"mod\":1020},\"end\":{\"dow\":4,\"mod\":1170}},{\"start\":{\"dow\":5,\"mod\":1020},\"end\":{\"dow\":5,\"mod\":1170}},{\"start\":{\"dow\":4,\"mod\":380},\"end\":{\"dow\":4,\"mod\":540}},{\"start\":{\"dow\":6,\"mod\":540},\"end\":{\"dow\":6,\"mod\":630}},{\"start\":{\"dow\":0,\"mod\":540},\"end\":{\"dow\":0,\"mod\":630}},{\"start\":{\"dow\":1,\"mod\":380},\"end\":{\"dow\":1,\"mod\":540}},{\"start\":{\"dow\":6,\"mod\":1020},\"end\":{\"dow\":6,\"mod\":1170}},{\"start\":{\"dow\":0,\"mod\":1020},\"end\":{\"dow\":0,\"mod\":1170}}]","topic":"CalendrierEntree","name":"CalendrierEntree","onPayload":"true","onPayloadType":"bool","offPayload":"false","offPayloadType":"bool","onlyWhenDark":false,"scheduleRndMax":0,"sunElevationThreshold":6,"sunShowElevationInStatus":false,"outputfreq":"output.statechange.startup","x":130,"y":2460,"wires":[["f737a74a01c13583","d54e17c1d893ed8a"]]},{"id":"3ed39797df303e3c","type":"server-state-changed","z":"7a831b6e2f802ee7","name":"isTemp <19","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.degc_clima_entree_temperature","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"19","halt_if_type":"num","halt_if_compare":"lt","outputs":2,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"true","valueType":"bool"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":90,"y":2380,"wires":[["f737a74a01c13583"],["d54e17c1d893ed8a"]]},{"id":"98da3e4705f8c2e9","type":"change","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":520,"y":2440,"wires":[["47d24de99f4d5891"]]},{"id":"f737a74a01c13583","type":"and-gate","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"true","propertyType":"msg","property":"payload","topic":"orGate"},{"t":"true","propertyType":"msg","property":"payload","topic":"sensor.degc_clima_entree_temperature"},{"t":"true","propertyType":"msg","property":"payload","topic":"CalendrierEntree"}],"outputTopic":"","gateType":"and","emitOnlyIfTrue":true,"x":360,"y":2340,"wires":[["6c8206eb9a57d811"]]},{"id":"d54e17c1d893ed8a","type":"or-gate","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"true","propertyType":"msg","property":"payload","topic":"device_tracker.eloise"},{"t":"true","propertyType":"msg","property":"payload","topic":"sensor.degc_clima_entree_temperature"},{"t":"false","propertyType":"msg","property":"payload","topic":"CalendrierEntree"},{"t":"true","propertyType":"msg","property":"payload","topic":"device_tracker.portable_pascal"}],"outputTopic":"","gateType":"or","emitOnlyIfTrue":true,"x":340,"y":2440,"wires":[["98da3e4705f8c2e9"]]},{"id":"6c8206eb9a57d811","type":"change","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":560,"y":2340,"wires":[["dc244e3018fd4c4b"]]},{"id":"16129a45bb75e082","type":"server-state-changed","z":"7a831b6e2f802ee7","name":"isPascalHome","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"device_tracker.portable_pascal","entityidfiltertype":"substring","outputinitially":true,"state_type":"str","haltifstate":"home","halt_if_type":"str","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"true","valueType":"bool"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":70,"y":2300,"wires":[["b62725325aa7b5b2"],["d54e17c1d893ed8a"]]},{"id":"b62725325aa7b5b2","type":"or-gate","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"true","propertyType":"msg","property":"payload","topic":"device_tracker.portable_pascal"},{"t":"true","propertyType":"msg","property":"payload","topic":"device_tracker.eloise"}],"outputTopic":"orGate","gateType":"or","emitOnlyIfTrue":false,"x":320,"y":2260,"wires":[["f737a74a01c13583"]]},{"id":"622c9cfdd5b9e102","type":"server-state-changed","z":"7a831b6e2f802ee7","name":"isEloiseHome","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"device_tracker.eloise","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"home","halt_if_type":"str","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"true","valueType":"bool"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":70,"y":2240,"wires":[["b62725325aa7b5b2"],["d54e17c1d893ed8a"]]},{"id":"942dd70f49577dc1","type":"inject","z":"7a831b6e2f802ee7","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":930,"y":2560,"wires":[["c75c779194463359"]]},{"id":"146798c3a6974e7d","type":"comment","z":"7a831b6e2f802ee7","name":"Chauffage SDB","info":"","x":640,"y":2760,"wires":[]},{"id":"e29e4a10aacb3969","type":"api-render-template","z":"7a831b6e2f802ee7","name":"IsOnOtherPresetThanConfort","server":"43d85569dace75e0","version":0,"template":"{{true if state_attr('climate.radiateur_sdb', 'preset_mode') != 'comfort' }}\n{{false if state_attr('climate.radiateur_sdb', 'preset_mode') == 'comfort' }} ","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":840,"y":2840,"wires":[["730573c143f9b37e"]]},{"id":"f32deb61f0e02ab0","type":"api-render-template","z":"7a831b6e2f802ee7","name":"IsOnOtherPresetThanAway","server":"43d85569dace75e0","version":0,"template":"{{true if state_attr('climate.radiateur_sdb', 'preset_mode') != 'away' }}\n{{false if state_attr('climate.radiateur_sdb', 'preset_mode') == 'away' }}  ","resultsLocation":"payloadsdb","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":840,"y":2940,"wires":[["36643a3dc248f9df","ef6c083f40148ec1"]]},{"id":"730573c143f9b37e","type":"switch","z":"7a831b6e2f802ee7","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"True","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":1030,"y":2840,"wires":[["d720fee33b792682","2b29fe2840d9c911"]]},{"id":"36643a3dc248f9df","type":"switch","z":"7a831b6e2f802ee7","name":"","property":"payloadsdb","propertyType":"msg","rules":[{"t":"eq","v":"True","vt":"str"},{"t":"eq","v":"False","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":1050,"y":2960,"wires":[["75a447d4b7f6f7a6","32746e0c24145eec"],[]]},{"id":"d720fee33b792682","type":"function","z":"7a831b6e2f802ee7","name":"Notification - mode confort","func":"msg.payload =\n\n\"Passage du radiateur salle de bain en mode confort\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1280,"y":2780,"wires":[["6fc14ab0bd392f14"]]},{"id":"6fc14ab0bd392f14","type":"link out","z":"7a831b6e2f802ee7","name":"VersEchos","mode":"link","links":["34dd5813f28f2a42","a7ddbf0dfd2c325b"],"x":1520,"y":2780,"wires":[],"l":true},{"id":"75a447d4b7f6f7a6","type":"function","z":"7a831b6e2f802ee7","name":"Notification - mode eco","func":"msg.payload =\n\n\"Passage du radiateur de la salle de bain en mode eco\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1270,"y":2920,"wires":[["27cc23d3549c144a"]]},{"id":"27cc23d3549c144a","type":"link out","z":"7a831b6e2f802ee7","name":"VersEchos","mode":"link","links":["34dd5813f28f2a42"],"x":1510,"y":2920,"wires":[],"l":true},{"id":"6fae01a53a330b8a","type":"light-scheduler","z":"7a831b6e2f802ee7","settings":"a5f60f435cd422f8","events":"[{\"start\":{\"dow\":6,\"mod\":510},\"end\":{\"dow\":6,\"mod\":600}},{\"start\":{\"dow\":1,\"mod\":375},\"end\":{\"dow\":1,\"mod\":480}},{\"start\":{\"dow\":2,\"mod\":375},\"end\":{\"dow\":2,\"mod\":480}},{\"start\":{\"dow\":3,\"mod\":375},\"end\":{\"dow\":3,\"mod\":480}},{\"start\":{\"dow\":4,\"mod\":375},\"end\":{\"dow\":4,\"mod\":480}},{\"start\":{\"dow\":5,\"mod\":375},\"end\":{\"dow\":5,\"mod\":480}},{\"start\":{\"dow\":0,\"mod\":510},\"end\":{\"dow\":0,\"mod\":600}},{\"start\":{\"dow\":1,\"mod\":1065},\"end\":{\"dow\":1,\"mod\":1200}},{\"start\":{\"dow\":2,\"mod\":1065},\"end\":{\"dow\":2,\"mod\":1200}},{\"start\":{\"dow\":3,\"mod\":1065},\"end\":{\"dow\":3,\"mod\":1200}},{\"start\":{\"dow\":4,\"mod\":1065},\"end\":{\"dow\":4,\"mod\":1200}},{\"start\":{\"dow\":5,\"mod\":1065},\"end\":{\"dow\":5,\"mod\":1200}},{\"start\":{\"dow\":6,\"mod\":1020},\"end\":{\"dow\":6,\"mod\":1200}},{\"start\":{\"dow\":0,\"mod\":1020},\"end\":{\"dow\":0,\"mod\":1200}}]","topic":"CalendrierSDB","name":"CalendrierSDB","onPayload":"true","onPayloadType":"bool","offPayload":"false","offPayloadType":"bool","onlyWhenDark":false,"scheduleRndMax":0,"sunElevationThreshold":6,"sunShowElevationInStatus":false,"outputfreq":"output.statechange.startup","x":140,"y":2960,"wires":[["86899949152ec32d","f988a1e0a633ae89"]]},{"id":"9bf75937d8c1116d","type":"server-state-changed","z":"7a831b6e2f802ee7","name":"isTemp <22","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.temp_sdb_bt_temperature","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"22","halt_if_type":"num","halt_if_compare":"lt","outputs":2,"output_only_on_state_change":true,"for":"30","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"true","valueType":"bool"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":110,"y":2880,"wires":[["86899949152ec32d"],["f988a1e0a633ae89"]]},{"id":"b8bfc119e8a659b9","type":"change","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":540,"y":2940,"wires":[["f32deb61f0e02ab0"]]},{"id":"86899949152ec32d","type":"and-gate","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"true","propertyType":"msg","property":"payload","topic":"orGate"},{"t":"true","propertyType":"msg","property":"payload","topic":"sensor.temp_sdb_bt_temperature"},{"t":"true","propertyType":"msg","property":"payload","topic":"CalendrierSDB"}],"outputTopic":"","gateType":"and","emitOnlyIfTrue":true,"x":380,"y":2840,"wires":[["634046c60a6e12e0"]]},{"id":"f988a1e0a633ae89","type":"or-gate","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"true","propertyType":"msg","property":"payload","topic":"device_tracker.eloise"},{"t":"true","propertyType":"msg","property":"payload","topic":"sensor.temp_sdb_bt_temperature"},{"t":"false","propertyType":"msg","property":"payload","topic":"CalendrierSDB"},{"t":"true","propertyType":"msg","property":"payload","topic":"device_tracker.portable_pascal"}],"outputTopic":"","gateType":"or","emitOnlyIfTrue":true,"x":360,"y":2940,"wires":[["b8bfc119e8a659b9"]]},{"id":"634046c60a6e12e0","type":"change","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":580,"y":2840,"wires":[["e29e4a10aacb3969"]]},{"id":"2211415857c1ea66","type":"server-state-changed","z":"7a831b6e2f802ee7","name":"isPascalHome","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"device_tracker.portable_pascal","entityidfiltertype":"substring","outputinitially":true,"state_type":"str","haltifstate":"home","halt_if_type":"str","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"true","valueType":"bool"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":90,"y":2800,"wires":[["0669be7808ddf2c0"],["f988a1e0a633ae89"]]},{"id":"0669be7808ddf2c0","type":"or-gate","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"true","propertyType":"msg","property":"payload","topic":"device_tracker.portable_pascal"},{"t":"true","propertyType":"msg","property":"payload","topic":"device_tracker.eloise"}],"outputTopic":"orGate","gateType":"or","emitOnlyIfTrue":false,"x":340,"y":2760,"wires":[["86899949152ec32d"]]},{"id":"ab93f4fc62431d4b","type":"server-state-changed","z":"7a831b6e2f802ee7","name":"isEloiseHome","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"device_tracker.eloise","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"home","halt_if_type":"str","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"true","valueType":"bool"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":90,"y":2740,"wires":[["0669be7808ddf2c0"],["f988a1e0a633ae89"]]},{"id":"8b2a69640a900486","type":"inject","z":"7a831b6e2f802ee7","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":820,"y":3040,"wires":[[]]},{"id":"e3346b1ef554ab32","type":"comment","z":"7a831b6e2f802ee7","name":"Chauffage Couloir etage","info":"","x":690,"y":3220,"wires":[]},{"id":"50a73d4f9996b2c0","type":"api-render-template","z":"7a831b6e2f802ee7","name":"IsOnOtherPresetThanConfort","server":"43d85569dace75e0","version":0,"template":"{{true if state_attr('climate.radiateur_couloir_etage', 'preset_mode') != 'comfort' }}\n{{false if state_attr('climate.radiateur_couloir_etage', 'preset_mode') == 'comfort' }}  ","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":860,"y":3300,"wires":[["8c7e8c803c0cac01"]]},{"id":"a353280465255ed9","type":"api-render-template","z":"7a831b6e2f802ee7","name":"IsOnOtherPresetThanEco","server":"43d85569dace75e0","version":0,"template":"{{true if state_attr('climate.radiateur_couloir_etage', 'preset_mode') != 'eco' }}\n{{false if state_attr('climate.radiateur_couloir_etage', 'preset_mode') == 'eco' }}  ","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":850,"y":3400,"wires":[["9fdc3f76fe69c9c7"]]},{"id":"8c7e8c803c0cac01","type":"switch","z":"7a831b6e2f802ee7","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"True","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":1050,"y":3300,"wires":[["1ac5697b7c8a9fdb","4d55702dcb7e0a09"]]},{"id":"9fdc3f76fe69c9c7","type":"switch","z":"7a831b6e2f802ee7","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"True","vt":"str"},{"t":"eq","v":"False","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":3420,"wires":[["9b4a1f17564780e4","f863bc55b510bd73"],[]]},{"id":"1ac5697b7c8a9fdb","type":"function","z":"7a831b6e2f802ee7","name":"Notification - mode confort","func":"msg.payload =\n\n\"Passage du radiateur couloir etage en mode confort\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1300,"y":3240,"wires":[["b142ae970a0603a8"]]},{"id":"b142ae970a0603a8","type":"link out","z":"7a831b6e2f802ee7","name":"VersEchos","mode":"link","links":["a7ddbf0dfd2c325b"],"x":1540,"y":3240,"wires":[],"l":true},{"id":"9b4a1f17564780e4","type":"function","z":"7a831b6e2f802ee7","name":"Notification - mode eco","func":"msg.payload =\n\n\"Passage du radiateur couloir etage en mode eco\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1290,"y":3380,"wires":[["6a0707332bcb3390"]]},{"id":"6a0707332bcb3390","type":"link out","z":"7a831b6e2f802ee7","name":"VersEchos","mode":"link","links":["a7ddbf0dfd2c325b"],"x":1530,"y":3380,"wires":[],"l":true},{"id":"66bd513398db4626","type":"light-scheduler","z":"7a831b6e2f802ee7","settings":"a5f60f435cd422f8","events":"[{\"start\":{\"dow\":1,\"mod\":1065},\"end\":{\"dow\":1,\"mod\":1200}},{\"start\":{\"dow\":2,\"mod\":1065},\"end\":{\"dow\":2,\"mod\":1200}},{\"start\":{\"dow\":3,\"mod\":1065},\"end\":{\"dow\":3,\"mod\":1200}},{\"start\":{\"dow\":4,\"mod\":1065},\"end\":{\"dow\":4,\"mod\":1200}},{\"start\":{\"dow\":5,\"mod\":1065},\"end\":{\"dow\":5,\"mod\":1200}},{\"start\":{\"dow\":6,\"mod\":1020},\"end\":{\"dow\":6,\"mod\":1200}},{\"start\":{\"dow\":0,\"mod\":1020},\"end\":{\"dow\":0,\"mod\":1200}}]","topic":"CalendrierEtage","name":"CalendrierEtage","onPayload":"true","onPayloadType":"bool","offPayload":"false","offPayloadType":"bool","onlyWhenDark":false,"scheduleRndMax":0,"sunElevationThreshold":6,"sunShowElevationInStatus":false,"outputfreq":"output.statechange.startup","x":120,"y":3420,"wires":[["a6057a53f8ae723c","55308614311e6e99"]]},{"id":"51d1637409ad2829","type":"server-state-changed","z":"7a831b6e2f802ee7","name":"isTemp <18","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.temp_couloiretage_bt_temperature","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"18","halt_if_type":"num","halt_if_compare":"lt","outputs":2,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"true","valueType":"bool"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":110,"y":3340,"wires":[["a6057a53f8ae723c"],["55308614311e6e99"]]},{"id":"ed33daf20424c6b9","type":"change","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":560,"y":3400,"wires":[["a353280465255ed9"]]},{"id":"a6057a53f8ae723c","type":"and-gate","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"true","propertyType":"msg","property":"payload","topic":"orGate"},{"t":"true","propertyType":"msg","property":"payload","topic":"sensor.temp_couloiretage_bt_temperature"},{"t":"true","propertyType":"msg","property":"payload","topic":"CalendrierEtage"}],"outputTopic":"","gateType":"and","emitOnlyIfTrue":true,"x":400,"y":3300,"wires":[["2cf299995f232936"]]},{"id":"55308614311e6e99","type":"or-gate","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"true","propertyType":"msg","property":"payload","topic":"device_tracker.eloise"},{"t":"true","propertyType":"msg","property":"payload","topic":"sensor.temp_couloiretage_bt_temperature"},{"t":"false","propertyType":"msg","property":"payload","topic":"CalendrierEtage"},{"t":"true","propertyType":"msg","property":"payload","topic":"device_tracker.portable_pascal"}],"outputTopic":"","gateType":"or","emitOnlyIfTrue":true,"x":380,"y":3400,"wires":[["ed33daf20424c6b9"]]},{"id":"2cf299995f232936","type":"change","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":600,"y":3300,"wires":[["50a73d4f9996b2c0"]]},{"id":"9b32dec58f5f6405","type":"server-state-changed","z":"7a831b6e2f802ee7","name":"isPascalHome","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"device_tracker.portable_pascal","entityidfiltertype":"substring","outputinitially":true,"state_type":"str","haltifstate":"home","halt_if_type":"str","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"true","valueType":"bool"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":110,"y":3260,"wires":[["f6732fd3ed742549"],["55308614311e6e99"]]},{"id":"f6732fd3ed742549","type":"or-gate","z":"7a831b6e2f802ee7","name":"","rules":[{"t":"true","propertyType":"msg","property":"payload","topic":"device_tracker.portable_pascal"},{"t":"true","propertyType":"msg","property":"payload","topic":"device_tracker.eloise"}],"outputTopic":"orGate","gateType":"or","emitOnlyIfTrue":false,"x":360,"y":3220,"wires":[["a6057a53f8ae723c"]]},{"id":"c1a4cbfb2a79d408","type":"server-state-changed","z":"7a831b6e2f802ee7","name":"isEloiseHome","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"device_tracker.eloise","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"home","halt_if_type":"str","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"true","valueType":"bool"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":110,"y":3200,"wires":[["f6732fd3ed742549"],["55308614311e6e99"]]},{"id":"39a9868a94b62a4f","type":"inject","z":"7a831b6e2f802ee7","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":970,"y":3520,"wires":[[]]},{"id":"4d55702dcb7e0a09","type":"api-call-service","z":"7a831b6e2f802ee7","name":"Radiateur couloir- Confort","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"climate","service":"set_preset_mode","entityId":"climate.radiateur_couloir_etage","data":"{\"preset_mode\":\"comfort\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1270,"y":3300,"wires":[[]]},{"id":"f863bc55b510bd73","type":"api-call-service","z":"7a831b6e2f802ee7","name":"Radiateur couloir- eco","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"climate","service":"set_preset_mode","entityId":"climate.radiateur_couloir_etage","data":"{\"preset_mode\":\"eco\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1280,"y":3440,"wires":[[]]},{"id":"2b29fe2840d9c911","type":"api-call-service","z":"7a831b6e2f802ee7","name":"Radiateur SDB - Confort","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"climate","service":"set_preset_mode","entityId":"climate.radiateur_sdb","data":"{\"preset_mode\":\"comfort\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1270,"y":2860,"wires":[[]]},{"id":"32746e0c24145eec","type":"api-call-service","z":"7a831b6e2f802ee7","name":"Radiateur SDB - away","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"climate","service":"set_preset_mode","entityId":"climate.radiateur_sdb","data":"{\"preset_mode\":\"away\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1260,"y":3000,"wires":[[]]},{"id":"ef6c083f40148ec1","type":"debug","z":"7a831b6e2f802ee7","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payloadsdb","targetType":"msg","statusVal":"","statusType":"auto","x":1040,"y":3100,"wires":[]},{"id":"78cae640b0ed2b99","type":"server-state-changed","z":"2751f6a3a0a7649a","name":"Alarme HA","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"alarm_control_panel.alarme_maison","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":130,"y":220,"wires":[["d248d9b79a7ec1c0","2ad61e6cbb9096da"]]},{"id":"d248d9b79a7ec1c0","type":"debug","z":"2751f6a3a0a7649a","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":350,"y":80,"wires":[]},{"id":"2ad61e6cbb9096da","type":"switch","z":"2751f6a3a0a7649a","name":"Statuts alarme","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"arming","vt":"str"},{"t":"eq","v":"disarmed","vt":"str"},{"t":"eq","v":"armed_home","vt":"str"},{"t":"eq","v":"armed_away","vt":"str"},{"t":"eq","v":"armed_night","vt":"str"},{"t":"eq","v":"pending","vt":"str"},{"t":"eq","v":"triggered","vt":"str"}],"checkall":"true","repair":false,"outputs":7,"x":340,"y":260,"wires":[["34ac921fd026e4bc","1c62624d970e0122"],["192d7d5c3db58b77","34ac921fd026e4bc"],["2eb71b71a5827f45","34ac921fd026e4bc","7411d46daf781256"],["2eb71b71a5827f45","34ac921fd026e4bc","7411d46daf781256"],["192e9b1d90455377"],["e9d0ba7fd412237b","34ac921fd026e4bc"],["29a8ac0256bc867e","34ac921fd026e4bc"]]},{"id":"1c62624d970e0122","type":"function","z":"2751f6a3a0a7649a","name":"Activation de l'alarme","func":"msg.payload =\n\n\"60 secondes avant activation de l'alarme\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":780,"y":120,"wires":[["c858a79d18d17e42"]]},{"id":"c858a79d18d17e42","type":"link out","z":"2751f6a3a0a7649a","name":"VersNotifications - Telegram - SMS - Echo","mode":"link","links":["22186f7a74fec36f","34dd5813f28f2a42","93d062bbf9af5c89","a7ddbf0dfd2c325b","f550e12c1257457e"],"x":1320,"y":220,"wires":[],"l":true},{"id":"0e0e9f01537a464c","type":"inject","z":"2751f6a3a0a7649a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":570,"y":80,"wires":[["1c62624d970e0122"]]},{"id":"51c599bf94a790a1","type":"function","z":"2751f6a3a0a7649a","name":"Désactivation de l'alarme nuit","func":"msg.payload =\n\n\"Désactivation de l'alarme en mode nuit\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1120,"y":540,"wires":[["844126695f1020be"]]},{"id":"e1695473f4f5eed7","type":"function","z":"2751f6a3a0a7649a","name":"Alarme activée - Totale","func":"msg.payload =\n\n\"Alarme activée en mode totale\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":900,"y":240,"wires":[["c858a79d18d17e42"]]},{"id":"0947ee6869defae6","type":"function","z":"2751f6a3a0a7649a","name":"Alarme activée - nuit","func":"msg.payload =\n\n\"Alarme en mode nuit activée\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":900,"y":280,"wires":[["c2a0c5b8ddc1f615"]]},{"id":"c2a0c5b8ddc1f615","type":"link out","z":"2751f6a3a0a7649a","name":"VersNotifications - ECHO","mode":"link","links":["34dd5813f28f2a42"],"x":1270,"y":260,"wires":[],"l":true},{"id":"e9d0ba7fd412237b","type":"function","z":"2751f6a3a0a7649a","name":"Rappel désactivation alarme","func":"msg.payload =\n\n\"Veuillez désactiver l'alarme!\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":620,"y":320,"wires":[["c858a79d18d17e42"]]},{"id":"673cea63e6db801d","type":"switch","z":"2751f6a3a0a7649a","name":"Etat précédent ?","property":"data.old_state.state","propertyType":"msg","rules":[{"t":"eq","v":"armed_away","vt":"str"},{"t":"eq","v":"armed_home","vt":"str"},{"t":"eq","v":"armed_night","vt":"str"},{"t":"eq","v":"disarmed","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":5,"x":720,"y":540,"wires":[["3a7582ba1370d1f2","59120d316859a466"],["3a7582ba1370d1f2","59120d316859a466","95a61b79df5b70fb"],["51c599bf94a790a1","59120d316859a466"],["7bf7f43e48d0d8ce"],["7bf7f43e48d0d8ce","59120d316859a466","95a61b79df5b70fb"]]},{"id":"3a7582ba1370d1f2","type":"function","z":"2751f6a3a0a7649a","name":"Désactivation de l'alarme Totale","func":"msg.payload =\n\n\"Désactivation de l'alarme en mode totale\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1130,"y":500,"wires":[["c858a79d18d17e42"]]},{"id":"7bf7f43e48d0d8ce","type":"function","z":"2751f6a3a0a7649a","name":"Désactivation de l'alarme","func":"msg.payload =\n\n\"Alarme désactivée \"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1090,"y":600,"wires":[["844126695f1020be"]]},{"id":"844126695f1020be","type":"link out","z":"2751f6a3a0a7649a","name":"VersNotifications - Telegram","mode":"link","links":["a7ddbf0dfd2c325b","f550e12c1257457e"],"x":1360,"y":600,"wires":[],"l":true},{"id":"17259af75856254d","type":"link out","z":"2751f6a3a0a7649a","name":"VersEtatPrécedent","mode":"link","links":["63f0cbdfdcf05dca"],"x":830,"y":200,"wires":[],"l":true},{"id":"63f0cbdfdcf05dca","type":"link in","z":"2751f6a3a0a7649a","name":"EtatPrecedent","links":["17259af75856254d"],"x":530,"y":540,"wires":[["673cea63e6db801d"]],"l":true},{"id":"192d7d5c3db58b77","type":"api-call-service","z":"2751f6a3a0a7649a","name":"Script Allumer appareils","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"script","service":"allumer_des_appareils_quand_alarme_eteinte","entityId":"","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":610,"y":200,"wires":[["17259af75856254d"]]},{"id":"2eb71b71a5827f45","type":"api-call-service","z":"2751f6a3a0a7649a","name":"Script eteindre appareils - Totale","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"script","service":"alarme_eteindre_des_appareils_en_mode_totale","entityId":"","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":630,"y":240,"wires":[["e1695473f4f5eed7"]]},{"id":"192e9b1d90455377","type":"api-call-service","z":"2751f6a3a0a7649a","name":"Script eteindre appareils - Nuit","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"script","service":"eteindre_des_appareils_pour_la_nuit","entityId":"","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":630,"y":280,"wires":[["0947ee6869defae6"]]},{"id":"29a8ac0256bc867e","type":"link out","z":"2751f6a3a0a7649a","name":"VersDéclenchemenAlarme","mode":"link","links":["a66e966f7f5e94ff"],"x":630,"y":400,"wires":[],"l":true},{"id":"a66e966f7f5e94ff","type":"link in","z":"2751f6a3a0a7649a","name":"DéclenchementAlarme","links":["29a8ac0256bc867e"],"x":540,"y":780,"wires":[["174f734c3abae27b"]],"l":true},{"id":"aed35cdfa33f2884","type":"api-call-service","z":"2751f6a3a0a7649a","name":"Sirene Entree - ON","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"switch.sirene_entree_switch_2","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1050,"y":800,"wires":[[]]},{"id":"174f734c3abae27b","type":"switch","z":"2751f6a3a0a7649a","name":"Etat précédent ?","property":"data.old_state.state","propertyType":"msg","rules":[{"t":"eq","v":"armed_night","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":760,"y":780,"wires":[["caccd1bf551632db","e3dd133cf84acdf4"],["aed35cdfa33f2884","caccd1bf551632db","29bda6cb1588516b"]]},{"id":"caccd1bf551632db","type":"api-call-service","z":"2751f6a3a0a7649a","name":"Sirene Garage - ON","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"switch.sirene_garage_switch","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1060,"y":740,"wires":[[]]},{"id":"85cd51a497b8d3eb","type":"link out","z":"2751f6a3a0a7649a","name":"VersNotifications - Telegram - SMS - Echo","mode":"link","links":["34dd5813f28f2a42","9017154cf2b33cbe","a7ddbf0dfd2c325b","f550e12c1257457e"],"x":1240,"y":680,"wires":[],"l":true},{"id":"21d3b514b2df5ab9","type":"link out","z":"2751f6a3a0a7649a","name":"VersNotifications - Telegram - SMS - Echo","mode":"link","links":["22186f7a74fec36f","34dd5813f28f2a42","9017154cf2b33cbe","93d062bbf9af5c89","a7ddbf0dfd2c325b","f550e12c1257457e"],"x":1240,"y":880,"wires":[],"l":true},{"id":"e3dd133cf84acdf4","type":"function","z":"2751f6a3a0a7649a","name":"Intrusion détectée","func":"msg.payload =\n\n\"Attention!!! intrusion détectée \"+\n\"{% for state in states|selectattr('entity_id','in',state_attr('group.alarme_nuit_detecteurs','entity_id'))|selectattr('state','eq','on')|list %}{{state.name+', '}}{%- endfor %}\"\n\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":870,"y":680,"wires":[["85cd51a497b8d3eb"]]},{"id":"29bda6cb1588516b","type":"function","z":"2751f6a3a0a7649a","name":"Intrusion détectée","func":"msg.payload =\n\n\"Attention!!! intrusion détectée \"+\n\"{% for state in states|selectattr('entity_id','in',state_attr('group.alarme_nuit_detecteurs','entity_id'))|selectattr('state','eq','on')|list %}{{state.name+', '}}{%- endfor %}\"\n\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":930,"y":880,"wires":[["21d3b514b2df5ab9"]]},{"id":"bc6c28060037d161","type":"comment","z":"2751f6a3a0a7649a","name":"Déclenchement de l'alarme","info":"","x":570,"y":700,"wires":[]},{"id":"910533b15066023c","type":"comment","z":"2751f6a3a0a7649a","name":"Désactivation de l'alarme","info":"","x":570,"y":480,"wires":[]},{"id":"59120d316859a466","type":"api-call-service","z":"2751f6a3a0a7649a","name":"Sirene Garage - OFF","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.sirene_garage_switch","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":980,"y":460,"wires":[[]]},{"id":"95a61b79df5b70fb","type":"api-call-service","z":"2751f6a3a0a7649a","name":"Sirene Entree - OFF","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.sirene_entree_switch_2","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":980,"y":400,"wires":[[]]},{"id":"34ac921fd026e4bc","type":"debug","z":"2751f6a3a0a7649a","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":250,"y":600,"wires":[]},{"id":"a263eed10af9a065","type":"comment","z":"2751f6a3a0a7649a","name":"Alarme maison","info":"","x":150,"y":60,"wires":[]},{"id":"74c744ec9caa556e","type":"comment","z":"2751f6a3a0a7649a","name":"Alarme incendie","info":"","x":150,"y":940,"wires":[]},{"id":"f970b39965d85d45","type":"trigger-state","z":"2751f6a3a0a7649a","name":"","server":"43d85569dace75e0","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"group.detecteurs_incendie","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":210,"y":1060,"wires":[["3cf4a2ae07ef6af7"],[]]},{"id":"3cf4a2ae07ef6af7","type":"function","z":"2751f6a3a0a7649a","name":"Incendie détectée","func":"msg.payload =\n\n\"Attention!!! Alerte incendie sur \"+\n\"{% for state in states|selectattr('entity_id','in',state_attr('group.detecteurs_incendie','entity_id'))|selectattr('state','eq','on')|list %}{{state.name+', '}}{%- endfor %}\"\n\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":510,"y":1040,"wires":[["3fcaeebeabb9988c"]]},{"id":"3fcaeebeabb9988c","type":"link out","z":"2751f6a3a0a7649a","name":"VersNotifications - Telegram - SMS - Echo","mode":"link","links":["34dd5813f28f2a42","9017154cf2b33cbe","a7ddbf0dfd2c325b","e8df3e37b83f6011","f550e12c1257457e"],"x":840,"y":1040,"wires":[],"l":true},{"id":"c7ca925adf6d6a85","type":"comment","z":"2751f6a3a0a7649a","name":"Alarme inondation","info":"","x":150,"y":1240,"wires":[]},{"id":"7d0ca8a967f452f8","type":"trigger-state","z":"2751f6a3a0a7649a","name":"","server":"43d85569dace75e0","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"group.detecteurs_inondation","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":210,"y":1360,"wires":[["68d87bb68294cbaa"],[]]},{"id":"68d87bb68294cbaa","type":"function","z":"2751f6a3a0a7649a","name":"innondation détectée","func":"msg.payload =\n\n\"Attention!!! Alerte innondation sur \"+\n\"{% for state in states|selectattr('entity_id','in',state_attr('group.detecteurs_inondation','entity_id'))|selectattr('state','eq','on')|list %}{{state.name+', '}}{%- endfor %}\"\n\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":520,"y":1360,"wires":[["e2d4d5c6e5d82874"]]},{"id":"e2d4d5c6e5d82874","type":"link out","z":"2751f6a3a0a7649a","name":"VersNotifications - Telegram - SMS - Echo","mode":"link","links":["34dd5813f28f2a42","9017154cf2b33cbe","a7ddbf0dfd2c325b","ced87f2e5d5c0601","d1dc7f1a2fa6359d","e8df3e37b83f6011","f550e12c1257457e"],"x":840,"y":1360,"wires":[],"l":true},{"id":"7411d46daf781256","type":"link out","z":"2751f6a3a0a7649a","name":"VersFermetureDesVolets","mode":"link","links":["66295810f042bf59"],"x":490,"y":140,"wires":[],"l":true},{"id":"c64d35daa715d9ae","type":"cron","z":"2751f6a3a0a7649a","name":"At 6 30 AM","crontab":"30 6 * * *","x":140,"y":1540,"wires":[["04ab28d92c0d179a"]]},{"id":"62e847b6e035621c","type":"function","z":"2751f6a3a0a7649a","name":"Désactivation de l'alarme","func":"msg.payload =\n\n\"Alarme nuit désactivée \"\n\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1090,"y":1540,"wires":[["d297501805f43348"]]},{"id":"d297501805f43348","type":"link out","z":"2751f6a3a0a7649a","name":"VersNotifications - Telegram - SMS - Echo","mode":"link","links":["22186f7a74fec36f","93d062bbf9af5c89","a7ddbf0dfd2c325b","f550e12c1257457e"],"x":1420,"y":1540,"wires":[],"l":true},{"id":"60538268621d4c12","type":"switch","z":"2751f6a3a0a7649a","name":"Statuts alarme","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"armed_night","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":780,"y":1540,"wires":[["c2a8aeb87ceace16","62e847b6e035621c","d07fb6e9763629c1"]]},{"id":"04ab28d92c0d179a","type":"api-current-state","z":"2751f6a3a0a7649a","name":"","server":"43d85569dace75e0","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"alarm_control_panel.alarme_maison","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":470,"y":1540,"wires":[["60538268621d4c12","c2a8aeb87ceace16"]]},{"id":"a271829be768b26d","type":"comment","z":"2751f6a3a0a7649a","name":"Désactivation auto alarme nuit","info":"","x":390,"y":1480,"wires":[]},{"id":"b26569510a3ffec7","type":"inject","z":"2751f6a3a0a7649a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":150,"y":1460,"wires":[["04ab28d92c0d179a"]]},{"id":"c2a8aeb87ceace16","type":"debug","z":"2751f6a3a0a7649a","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":1000,"y":1440,"wires":[]},{"id":"d07fb6e9763629c1","type":"api-call-service","z":"2751f6a3a0a7649a","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"alarm_control_panel","service":"alarm_disarm","entityId":"","data":"{\"code\":1234}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1140,"y":1500,"wires":[[]]},{"id":"e003e767c35951b4","type":"api-render-template","z":"96aba16699ebe8be","name":"Temp ballon < 42","server":"43d85569dace75e0","version":0,"template":"{{ states.sensor.temperature_ballon_eau_chaude.state | float < 42 }}","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":750,"y":160,"wires":[["c497da57748a9f9a"]]},{"id":"8e9ec192cb17c671","type":"api-call-service","z":"96aba16699ebe8be","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.onoff_ballon_eau_chaude_switch","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1170,"y":300,"wires":[["a0f0d77c949b2bfc"]]},{"id":"ca202181e66ef8e2","type":"time-range-switch","z":"96aba16699ebe8be","name":"Dans la periode du matin - ON","lat":"47.0942","lon":"1.6124","startTime":"03:30","endTime":"05:00","startOffset":0,"endOffset":0,"x":330,"y":200,"wires":[["e003e767c35951b4"],["f0dc0a7e77db0249"]]},{"id":"03d82b2ef5b2ea26","type":"server-state-changed","z":"96aba16699ebe8be","name":"Temp <= 45","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.temperature_ballon_eau_chaude","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"45","halt_if_type":"num","halt_if_compare":"lte","outputs":2,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":110,"y":280,"wires":[["ca202181e66ef8e2"],[]]},{"id":"f0dc0a7e77db0249","type":"time-range-switch","z":"96aba16699ebe8be","name":"Dans la periode de l'après midi - ON","lat":"47.0942","lon":"1.6124","startTime":"16:30","endTime":"19:30","startOffset":0,"endOffset":0,"x":650,"y":240,"wires":[["e003e767c35951b4"],[]]},{"id":"74548d4e3b1383e2","type":"api-call-service","z":"96aba16699ebe8be","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"switch.onoff_ballon_eau_chaude_switch","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1130,"y":160,"wires":[["1331ef0576414a70"]]},{"id":"7e4844206e3e90de","type":"time-range-switch","z":"96aba16699ebe8be","name":"Dans la periode du matin - OFF","lat":"47.0942","lon":"1.6124","startTime":"05:15","endTime":"08:00","startOffset":0,"endOffset":0,"x":390,"y":360,"wires":[["d3c7bf69ce3428eb"],["30d71d67c6e0b768"]]},{"id":"30d71d67c6e0b768","type":"time-range-switch","z":"96aba16699ebe8be","name":"Dans la periode de l'après midi - OFF","lat":"47.0942","lon":"1.6124","startTime":"18:30","endTime":"20:00","startOffset":0,"endOffset":0,"x":750,"y":380,"wires":[["d3c7bf69ce3428eb"],[]]},{"id":"1331ef0576414a70","type":"function","z":"96aba16699ebe8be","name":"Notification ballon eau chaude - Mise en marche","func":"msg.payload =\n\n\"Mise en marche du ballon eau chaude!\"+\n\n\n\"La température de l'eau est de \"+ \n\"{{states('sensor.temperature_ballon_eau_chaude') }}\"+\n\"degrées\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1440,"y":160,"wires":[["8cb1b630a05f37fb"]]},{"id":"8cb1b630a05f37fb","type":"link out","z":"96aba16699ebe8be","name":"VersEchos","mode":"link","links":["34dd5813f28f2a42","ced87f2e5d5c0601"],"x":1730,"y":160,"wires":[],"l":true},{"id":"a0f0d77c949b2bfc","type":"function","z":"96aba16699ebe8be","name":"Notification ballon eau chaude - Arrêt","func":"msg.payload =\n\n\"Arrêt du ballon eau chaude!\"+\n\n\n\"La température de l'eau est de \"+ \n\"{{states('sensor.temperature_ballon_eau_chaude') }}\"+\n\"degrées\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1450,"y":300,"wires":[["8a2c9324ee6ed2b2"]]},{"id":"8a2c9324ee6ed2b2","type":"link out","z":"96aba16699ebe8be","name":"VersEchos","mode":"link","links":["34dd5813f28f2a42","ced87f2e5d5c0601"],"x":1770,"y":260,"wires":[],"l":true},{"id":"672fc88d346d23b7","type":"comment","z":"96aba16699ebe8be","name":"Ballon Eau Chaude","info":"","x":370,"y":120,"wires":[]},{"id":"d3c7bf69ce3428eb","type":"api-current-state","z":"96aba16699ebe8be","name":"IsBallonOn","server":"43d85569dace75e0","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"switch.onoff_ballon_eau_chaude_switch","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":970,"y":300,"wires":[["8e9ec192cb17c671"],[]]},{"id":"0840955ef3add1b5","type":"server-state-changed","z":"96aba16699ebe8be","name":"Temp > 55","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.temperature_ballon_eau_chaude","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"55","halt_if_type":"num","halt_if_compare":"gte","outputs":2,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":100,"y":360,"wires":[["7e4844206e3e90de"],[]]},{"id":"c497da57748a9f9a","type":"api-current-state","z":"96aba16699ebe8be","name":"IsBallonOff","server":"43d85569dace75e0","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"switch.onoff_ballon_eau_chaude_switch","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":950,"y":160,"wires":[["74548d4e3b1383e2"],[]]},{"id":"a2c946eba66eb203","type":"inject","z":"335bd89f27c73b7e","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":900,"y":400,"wires":[["93d5ef698a73d77a"]]},{"id":"93d5ef698a73d77a","type":"function","z":"335bd89f27c73b7e","name":"","func":"msg.payload =\n\n\"test de message\"\n\n\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1080,"y":380,"wires":[["eb15cb17b518e3c0"]]},{"id":"34dd5813f28f2a42","type":"link in","z":"335bd89f27c73b7e","name":"VersEchoCuisine","links":["c858a79d18d17e42","8edc6d7303c2db5d","c2a0c5b8ddc1f615","85cd51a497b8d3eb","21d3b514b2df5ab9","cc4b322392797d03","808fc3d6f770457e","c46c39c6a03e868d","5f2f4b2a804ffa16","a6a57d0ecd2dfa3b","b9e9713fda5bce12","3785c846db38725f","5430e8d9f63ec903","a204df79d980c106","8cb1b630a05f37fb","8a2c9324ee6ed2b2","07eb6ece469c79da","7dc79138d067c52c","5a3d78a114021e01","3fcaeebeabb9988c","e2d4d5c6e5d82874","474620c26f182f77","477d585d0c37ac25","8f66c8e31e0ae6d5","c1f4a02e52dfe300","73a8d137381b7e3e","308795887e84b451","561ed58991368f81","0d127975593821ca","14a3025c7b125b60","990baf9e01b6a9ce","57ee44c606b96e70","6908e2a3199a31c7","b13a8ab49920bed2","a677cc24a51f5129","15c61d96edec970c","a3ba06745fbaa52e","0465761875be4dce","86c168a0e72d583a","dcb7ae9b918826d0","96be6e4d60ae3a6e","c0aba76949d071e3","17706589d3767fc3","27cc23d3549c144a","6fc14ab0bd392f14","2fe5c6b7ff380b2b","fa12bca9737319c0"],"x":180,"y":140,"wires":[["550cd211c55576d0","42401ddfdfef7cd8"]],"l":true},{"id":"ced87f2e5d5c0601","type":"link in","z":"335bd89f27c73b7e","name":"VersEcoSAM","links":["cc4b322392797d03","808fc3d6f770457e","c46c39c6a03e868d","5f2f4b2a804ffa16","a6a57d0ecd2dfa3b","17706589d3767fc3","2f41dcd9008a319c","b9e9713fda5bce12","3785c846db38725f","5430e8d9f63ec903","a204df79d980c106","8cb1b630a05f37fb","8a2c9324ee6ed2b2","07eb6ece469c79da","7dc79138d067c52c","5a3d78a114021e01","e2d4d5c6e5d82874","474620c26f182f77","477d585d0c37ac25","8f66c8e31e0ae6d5","c1f4a02e52dfe300","73a8d137381b7e3e","308795887e84b451","561ed58991368f81","0d127975593821ca","14a3025c7b125b60","990baf9e01b6a9ce","57ee44c606b96e70","6908e2a3199a31c7","b13a8ab49920bed2","a677cc24a51f5129","15c61d96edec970c","a3ba06745fbaa52e","0465761875be4dce","86c168a0e72d583a","dcb7ae9b918826d0","96be6e4d60ae3a6e","c0aba76949d071e3","b5359c758b2f6f21","7f272b5f9ef785e8","05a88e8e7e8e1416","4708774d67038072","3009b39565906fc8","a223a810b90ddc58","c0393896f8e316ad","e32386ebd0b6b628","fa12bca9737319c0"],"x":170,"y":220,"wires":[["f96d44e481fa03b3"]],"l":true},{"id":"d1dc7f1a2fa6359d","type":"link in","z":"335bd89f27c73b7e","name":"VersEchoClarence","links":["e2d4d5c6e5d82874","b5359c758b2f6f21","7d9904c5006222ba","72eedeac12cbea25","3009b39565906fc8","a223a810b90ddc58","c0393896f8e316ad"],"x":190,"y":300,"wires":[["b735de666a8c722b"]],"l":true},{"id":"e8df3e37b83f6011","type":"link in","z":"335bd89f27c73b7e","name":"VersEchoEloise","links":["3fcaeebeabb9988c","e2d4d5c6e5d82874","73f1964d1612465e"],"x":180,"y":380,"wires":[["11dbb202381278fa"]],"l":true},{"id":"a7ddbf0dfd2c325b","type":"link in","z":"335bd89f27c73b7e","name":"VersTelegramPascal","links":["c858a79d18d17e42","8edc6d7303c2db5d","844126695f1020be","85cd51a497b8d3eb","21d3b514b2df5ab9","07eb6ece469c79da","7dc79138d067c52c","17706589d3767fc3","7bd4578970e08cb8","7892c444cc4ff6b2","f37e4d23d6b44aaa","6b3cc193f1f04e48","3fcaeebeabb9988c","e2d4d5c6e5d82874","f5e044a4166e34af","3838e32361eaade2","5367c0af079bcc54","8fa2afd67118af9a","477d585d0c37ac25","6908e2a3199a31c7","57ee44c606b96e70","990baf9e01b6a9ce","14a3025c7b125b60","0d127975593821ca","561ed58991368f81","d28a6f3f2403526c","60f429d98a1a4efe","b13a8ab49920bed2","a677cc24a51f5129","15c61d96edec970c","5273e2c3703c2b8b","a3ba06745fbaa52e","0465761875be4dce","5a3d78a114021e01","86c168a0e72d583a","dcb7ae9b918826d0","96be6e4d60ae3a6e","c0aba76949d071e3","144ba20a5879cc1f","b5359c758b2f6f21","6610eacdb60d442a","d297501805f43348","c11e0c64c64fa4db","87c8497266b9e62c","33ff312129ca488d","622de4989d2d1ff8","6fc14ab0bd392f14","b142ae970a0603a8","6a0707332bcb3390","1ac313adc77c3f51","3009b39565906fc8","128e3eabd26f2558","a223a810b90ddc58","7352a58f1f38b85b","c0393896f8e316ad","9a92f32be29dff0b"],"x":910,"y":140,"wires":[["3a4fba5c5cf341e9"]],"l":true},{"id":"f550e12c1257457e","type":"link in","z":"335bd89f27c73b7e","name":"VersTelegramStephanie","links":["c858a79d18d17e42","8edc6d7303c2db5d","844126695f1020be","85cd51a497b8d3eb","21d3b514b2df5ab9","17706589d3767fc3","3fcaeebeabb9988c","e2d4d5c6e5d82874","d297501805f43348"],"x":920,"y":240,"wires":[["755392b5b77b98e7"]],"l":true},{"id":"22186f7a74fec36f","type":"link in","z":"335bd89f27c73b7e","name":"VersSMSStephanie","links":["c858a79d18d17e42","8edc6d7303c2db5d","21d3b514b2df5ab9","96be6e4d60ae3a6e","c0aba76949d071e3","d297501805f43348","6610eacdb60d442a","2fe5c6b7ff380b2b","fa12bca9737319c0"],"x":170,"y":620,"wires":[["507a42fa5550cfad"]],"l":true},{"id":"93d062bbf9af5c89","type":"link in","z":"335bd89f27c73b7e","name":"VersSMSPascal","links":["07eb6ece469c79da","21d3b514b2df5ab9","50550b3226604282","52ce9b2eeac28c0a","6610eacdb60d442a","7dc79138d067c52c","96be6e4d60ae3a6e","c0aba76949d071e3","c858a79d18d17e42","d297501805f43348","617bac76d94e3936","1ac313adc77c3f51","e32386ebd0b6b628","fa12bca9737319c0"],"x":164.0142059326172,"y":700.7329711914062,"wires":[["9951a005e86fa0d8"]],"l":true},{"id":"88f4a6b9887ab019","type":"link in","z":"335bd89f27c73b7e","name":"VersSMSEloise","links":["73f1964d1612465e"],"x":160,"y":860,"wires":[["86069a115c5b61a2"]],"l":true},{"id":"343866db0d57e779","type":"link in","z":"335bd89f27c73b7e","name":"VersSMSClarence","links":["7d9904c5006222ba","72eedeac12cbea25"],"x":170,"y":780,"wires":[["eea9762aaf9125e3"]],"l":true},{"id":"f979c8b43295f730","type":"comment","z":"335bd89f27c73b7e","name":"SMS","info":"","x":350,"y":560,"wires":[]},{"id":"145324512d5b0e46","type":"comment","z":"335bd89f27c73b7e","name":"Telegram","info":"","x":1100,"y":80,"wires":[]},{"id":"a047ad67eb2985fe","type":"comment","z":"335bd89f27c73b7e","name":"ECHO","info":"","x":310,"y":40,"wires":[]},{"id":"550cd211c55576d0","type":"debug","z":"335bd89f27c73b7e","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":820,"y":80,"wires":[]},{"id":"d503b3b5b927c0f4","type":"api-call-service","z":"335bd89f27c73b7e","name":"Doorbird Snapshot","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"camera","service":"snapshot","entityId":"camera.portier_live","data":"{\"filename\":\"/config/www/snapshots/snapshots_doorbird.jpg\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":570,"y":1100,"wires":[["43dda70c5b52fc73"]]},{"id":"d2cf314ff90e5b3f","type":"api-call-service","z":"335bd89f27c73b7e","name":"Envoyer une photo via telegram - Doorbird","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"telegram_bot","service":"send_photo","entityId":"","data":"{\t   \"file\":\"/config/www/snapshots/snapshots_doorbird.jpg\",\t   \"target\":[246735540, 315573228]\t}\t","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1110,"y":1100,"wires":[["cd58ad44dd8394e1"]]},{"id":"43dda70c5b52fc73","type":"delay","z":"335bd89f27c73b7e","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":800,"y":1100,"wires":[["d2cf314ff90e5b3f"]]},{"id":"cd58ad44dd8394e1","type":"debug","z":"335bd89f27c73b7e","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":1360,"y":1180,"wires":[]},{"id":"ccdd6a391c5ed645","type":"comment","z":"335bd89f27c73b7e","name":"Telegram - Photo","info":"","x":390,"y":1060,"wires":[]},{"id":"231b1b91f3733db4","type":"link in","z":"335bd89f27c73b7e","name":"TelegramPhotoDoorbird","links":["91019890881dd890","bf524822f4db734d"],"x":295,"y":1100,"wires":[["d503b3b5b927c0f4"]]},{"id":"3a4fba5c5cf341e9","type":"api-call-service","z":"335bd89f27c73b7e","name":"Telegram Pascal","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"telegram_bot","service":"send_message","entityId":"","data":"{\"message\":msg.payload,\"title\":\"Message Domotique\",\"target\":246735540}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1330,"y":120,"wires":[[]]},{"id":"755392b5b77b98e7","type":"api-call-service","z":"335bd89f27c73b7e","name":"Telegram Stéphanie","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"telegram_bot","service":"send_message","entityId":"","data":"{\t   \"message\":msg.payload,\t   \"title\":\"Message Domotique\",\t   \"target\":315573228\t}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1360,"y":260,"wires":[[]]},{"id":"f96d44e481fa03b3","type":"api-call-service","z":"335bd89f27c73b7e","name":"Echo SAM","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"notify","service":"alexa_media_echo_flex_sam","entityId":"","data":"{\t   \"message\": msg.payload,\t   \"data\":\t            \t            {\t       \"type\":\"announce\"\t            }\t}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":510,"y":180,"wires":[[]]},{"id":"b735de666a8c722b","type":"api-call-service","z":"335bd89f27c73b7e","name":"Echo Clarence","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"notify","service":"alexa_media_echo_clarence","entityId":"","data":"{\t   \"message\": msg.payload,\t   \"data\":\t            \t            {\t       \"type\":\"announce\"\t            }\t}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":520,"y":280,"wires":[[]]},{"id":"42401ddfdfef7cd8","type":"api-call-service","z":"335bd89f27c73b7e","name":"Echo Cuisine","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"notify","service":"alexa_media_echo_cuisine","entityId":"","data":"{\t   \"message\": msg.payload,\t   \"data\":\t            \t            {\t       \"type\":\"announce\"\t            }\t}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":510,"y":80,"wires":[[]]},{"id":"11dbb202381278fa","type":"api-call-service","z":"335bd89f27c73b7e","name":"Echo Eloise","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"notify","service":"alexa_media_echo_eloise","entityId":"","data":"{\t   \"message\": msg.payload,\t   \"data\":\t            \t            {\t       \"type\":\"announce\"\t            }\t}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":530,"y":380,"wires":[[]]},{"id":"242cc1bf2145c26e","type":"api-call-service","z":"335bd89f27c73b7e","name":"Echo - Tous","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"notify","service":"alexa_media_partout","entityId":"","data":"{\t   \"message\": msg.payload,\t   \"data\":\t            \t            {\t       \"type\":\"announce\"\t            }\t}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":530,"y":460,"wires":[[]]},{"id":"321ba33471679b48","type":"link in","z":"335bd89f27c73b7e","name":"VersTousLesEcho","links":[],"x":190,"y":460,"wires":[["242cc1bf2145c26e"]],"l":true},{"id":"a25668893330824c","type":"api-call-service","z":"335bd89f27c73b7e","name":"SMS Pascal","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"notify","service":"huawei_lte","entityId":"","data":"{\t   \"message\":msg.payload,\t   \"target\":650295195\t}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1210,"y":600,"wires":[[]]},{"id":"9951a005e86fa0d8","type":"api-call-service","z":"335bd89f27c73b7e","name":"SMS Pascal","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"notify","service":"huawei_lte","entityId":"","data":"{\t   \"message\":msg.payload,\t   \"target\":650295195\t}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":530,"y":700,"wires":[[]]},{"id":"507a42fa5550cfad","type":"api-call-service","z":"335bd89f27c73b7e","name":"SMS Stéphanie","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"notify","service":"huawei_lte","entityId":"","data":"{\t   \"message\":msg.payload,\t   \"target\":604420252\t}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":540,"y":620,"wires":[[]]},{"id":"eea9762aaf9125e3","type":"api-call-service","z":"335bd89f27c73b7e","name":"SMS Clarence","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"notify","service":"huawei_lte","entityId":"","data":"{\t   \"message\":msg.payload,\t   \"target\":752031947\t}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":540,"y":780,"wires":[[]]},{"id":"86069a115c5b61a2","type":"api-call-service","z":"335bd89f27c73b7e","name":"SMS Eloise","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"notify","service":"huawei_lte","entityId":"","data":"{\t   \"message\":msg.payload,\t   \"target\":651213063\t}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":530,"y":860,"wires":[[]]},{"id":"eb15cb17b518e3c0","type":"api-call-service","z":"335bd89f27c73b7e","name":"SMS Tous","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"notify","service":"huawei_lte","entityId":"","data":"{\t   \"message\":msg.payload,\t   \"target\":[651213063,604420252,752031947,650295195]\t}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1290,"y":420,"wires":[[]]},{"id":"29fe90582ddafc5f","type":"api-call-service","z":"335bd89f27c73b7e","name":"SMS Tous","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"notify","service":"huawei_lte","entityId":"","data":"{\t   \"message\":msg.payload,\t   \"target\":[651213063,604420252,752031947,650295195]\t}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":530,"y":940,"wires":[[]]},{"id":"9017154cf2b33cbe","type":"link in","z":"335bd89f27c73b7e","name":"VersSMSTous","links":["85cd51a497b8d3eb","21d3b514b2df5ab9","3fcaeebeabb9988c","e2d4d5c6e5d82874"],"x":150,"y":940,"wires":[["29fe90582ddafc5f"]],"l":true},{"id":"52f1118be7c19138","type":"comment","z":"335bd89f27c73b7e","name":"Tablette","info":"","x":200,"y":1240,"wires":[]},{"id":"86da929d329c8da5","type":"api-call-service","z":"335bd89f27c73b7e","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"rest_command","service":"fully_kiosk_cuisine_cmd","entityId":"","data":"{\t    \"url\": msg.payload\t}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":430,"y":1300,"wires":[[]]},{"id":"685bdcecb00a3c9e","type":"link in","z":"335bd89f27c73b7e","name":"VersTabletteCuisine","links":["ecd1b8cfa47eced4"],"x":145,"y":1300,"wires":[["86da929d329c8da5"]]},{"id":"6a81d1fe531efb26","type":"debug","z":"8ac4bc30b42b7a7d","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":490,"y":120,"wires":[]},{"id":"7209415a4aa9f6dd","type":"switch","z":"8ac4bc30b42b7a7d","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"On Battery Battery Discharging","vt":"str"},{"t":"eq","v":"Online Battery Charging","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":430,"y":260,"wires":[["6a81d1fe531efb26","becda4442ef086e4","9a39a06458e07d35"],["6a81d1fe531efb26","77f18194c6eb48b6"]]},{"id":"344360a1fd75c2f1","type":"server-state-changed","z":"8ac4bc30b42b7a7d","name":"","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.myups_status","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":170,"y":260,"wires":[["7209415a4aa9f6dd","6a81d1fe531efb26"]]},{"id":"becda4442ef086e4","type":"api-call-service","z":"8ac4bc30b42b7a7d","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"shell_command","service":"turn_off_nas_netgear","entityId":"","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":710,"y":200,"wires":[["0219aa3aba7d0863"]]},{"id":"9a39a06458e07d35","type":"api-call-service","z":"8ac4bc30b42b7a7d","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"shell_command","service":"turn_off_nas_nl54l","entityId":"","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":700,"y":160,"wires":[["0219aa3aba7d0863"]]},{"id":"07eb6ece469c79da","type":"link out","z":"8ac4bc30b42b7a7d","name":"VersNotifications - Telegram - SMS - Echo","mode":"link","links":["34dd5813f28f2a42","93d062bbf9af5c89","a7ddbf0dfd2c325b","ced87f2e5d5c0601"],"x":1340,"y":180,"wires":[],"l":true},{"id":"0219aa3aba7d0863","type":"function","z":"8ac4bc30b42b7a7d","name":"Coupure électrique détectée","func":"msg.payload =\n\n\"Coupure électrique détectée!\"+\n\"Extinction des NAS!\"+ \n\"Statut de l'onduleur!\"+\"{{ states('sensor.myups_status') }}\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1040,"y":180,"wires":[["07eb6ece469c79da"]]},{"id":"7dc79138d067c52c","type":"link out","z":"8ac4bc30b42b7a7d","name":"VersNotifications - Telegram - SMS - Echo","mode":"link","links":["34dd5813f28f2a42","93d062bbf9af5c89","a7ddbf0dfd2c325b","ced87f2e5d5c0601"],"x":1340,"y":260,"wires":[],"l":true},{"id":"77f18194c6eb48b6","type":"function","z":"8ac4bc30b42b7a7d","name":"Coupure électrique détectée","func":"msg.payload =\n\n\"Retour électrique détectée!\"+\n\"Batterie de l'onduleur en charge !\"+ \n\"Statut de l'onduleur!\"+\"{{ states('sensor.myups_status') }}\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1040,"y":260,"wires":[["7dc79138d067c52c"]]},{"id":"8d3225795fd44357","type":"comment","z":"8ac4bc30b42b7a7d","name":"Coupure électrique","info":"","x":260,"y":100,"wires":[]},{"id":"7fe9986ac3be1269","type":"comment","z":"8ac4bc30b42b7a7d","name":"Ouverture fermeture portail garage","info":"","x":320,"y":460,"wires":[]},{"id":"82b0ebc98174dc11","type":"function","z":"8ac4bc30b42b7a7d","name":"Notification - portail garage fermé","func":"msg.payload =\n\n\"Le portail du garage est fermé !\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":860,"y":580,"wires":[["86c168a0e72d583a"]]},{"id":"86c168a0e72d583a","type":"link out","z":"8ac4bc30b42b7a7d","name":"VersEchos","mode":"link","links":["34dd5813f28f2a42","a7ddbf0dfd2c325b","ced87f2e5d5c0601"],"x":1110,"y":580,"wires":[],"l":true},{"id":"b3b5317af0173d0f","type":"function","z":"8ac4bc30b42b7a7d","name":"Notification - Ouverture du portail","func":"msg.payload =\n\n\"Le portail du garage est ouvert !\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":860,"y":480,"wires":[["dcb7ae9b918826d0"]]},{"id":"dcb7ae9b918826d0","type":"link out","z":"8ac4bc30b42b7a7d","name":"VersEchos","mode":"link","links":["34dd5813f28f2a42","a7ddbf0dfd2c325b","ced87f2e5d5c0601"],"x":1110,"y":480,"wires":[],"l":true},{"id":"34f4f67a6f773e62","type":"comment","z":"8ac4bc30b42b7a7d","name":"Boite aux lettres -  Colis","info":"","x":350,"y":740,"wires":[]},{"id":"d0076350c0f37b23","type":"comment","z":"8ac4bc30b42b7a7d","name":"Boite aux lettres -  Lettres","info":"","x":350,"y":960,"wires":[]},{"id":"db0416aa8ab8ec35","type":"switch","z":"8ac4bc30b42b7a7d","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":490,"y":840,"wires":[["94362ad1bff9a6ea","bf524822f4db734d","559ffc9b1cc28961"]]},{"id":"df3c1473a368154d","type":"and-gate","z":"8ac4bc30b42b7a7d","name":"","rules":[{"t":"eq","v":"on","vt":"str","propertyType":"msg","property":"payload","topic":"binary_sensor.co_boite_aux_lettres_lettres"},{"t":"eq","v":"off","vt":"str","propertyType":"msg","property":"payload","topic":"binary_sensor.co_boites_aux_lettres_colis"}],"outputTopic":"","gateType":"and","emitOnlyIfTrue":true,"x":500,"y":1060,"wires":[["953bb15e45cf2ab9"]]},{"id":"94362ad1bff9a6ea","type":"function","z":"8ac4bc30b42b7a7d","name":"Notification - Colis","func":"msg.payload =\n\n\"Un colis à été déposé dans la boite aux lettres\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":770,"y":840,"wires":[["96be6e4d60ae3a6e"]]},{"id":"96be6e4d60ae3a6e","type":"link out","z":"8ac4bc30b42b7a7d","name":"VersEchos","mode":"link","links":["22186f7a74fec36f","34dd5813f28f2a42","93d062bbf9af5c89","a7ddbf0dfd2c325b","ced87f2e5d5c0601"],"x":990,"y":840,"wires":[],"l":true},{"id":"393b8d98a4c7669c","type":"function","z":"8ac4bc30b42b7a7d","name":"Notification - Colis","func":"msg.payload =\n\n\"Du courrier à été déposé dans la boite aux lettres\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1150,"y":1060,"wires":[["c0aba76949d071e3"]]},{"id":"c0aba76949d071e3","type":"link out","z":"8ac4bc30b42b7a7d","name":"VersEchos","mode":"link","links":["22186f7a74fec36f","34dd5813f28f2a42","93d062bbf9af5c89","a7ddbf0dfd2c325b","ced87f2e5d5c0601"],"x":1370,"y":1060,"wires":[],"l":true},{"id":"953bb15e45cf2ab9","type":"api-render-template","z":"8ac4bc30b42b7a7d","name":"Prevention notif vent","server":"43d85569dace75e0","version":0,"template":"{{true if state_attr('weather.maison', 'wind_speed')|float <= 25 }}\n{{false if state_attr('weather.maison', 'wind_speed')|float > 25 }} ","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":700,"y":1060,"wires":[["cc566b0def2813b7","7dd1e87165907cbf"]]},{"id":"cc566b0def2813b7","type":"switch","z":"8ac4bc30b42b7a7d","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"True","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":930,"y":1060,"wires":[["393b8d98a4c7669c","bf524822f4db734d","559ffc9b1cc28961"]]},{"id":"7dd1e87165907cbf","type":"debug","z":"8ac4bc30b42b7a7d","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":710,"y":920,"wires":[]},{"id":"bf524822f4db734d","type":"link out","z":"8ac4bc30b42b7a7d","name":"Demande de photo Doorbird","mode":"link","links":["231b1b91f3733db4"],"x":1140,"y":920,"wires":[],"l":true},{"id":"ee924113568e096c","type":"server-state-changed","z":"8ac4bc30b42b7a7d","name":"","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.rappel_agenda_clarence","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":300,"y":1260,"wires":[["cdf1c95e7f6db5a0"]]},{"id":"cdf1c95e7f6db5a0","type":"switch","z":"8ac4bc30b42b7a7d","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"120","vt":"str"},{"t":"eq","v":"1440","vt":"str"},{"t":"eq","v":"2880","vt":"str"}],"checkall":"true","repair":false,"outputs":3,"x":590,"y":1260,"wires":[["27e4ed1365d23bac"],["93bbdd981e40d3b0"],["294db659b4623c95"]]},{"id":"39203268a8888c49","type":"server-state-changed","z":"8ac4bc30b42b7a7d","name":"","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.rappel_agenda_pascal","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":270,"y":1480,"wires":[["4193189813097d23"]]},{"id":"4193189813097d23","type":"switch","z":"8ac4bc30b42b7a7d","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"120","vt":"str"},{"t":"eq","v":"1440","vt":"str"},{"t":"eq","v":"2880","vt":"str"}],"checkall":"true","repair":false,"outputs":3,"x":570,"y":1480,"wires":[["2b5baca10244ff6d"],["7665ab922c7ad5ca"],["bd73af209de73daf"]]},{"id":"e32386ebd0b6b628","type":"link out","z":"8ac4bc30b42b7a7d","name":"","mode":"link","links":["93d062bbf9af5c89","ced87f2e5d5c0601"],"x":1135,"y":1500,"wires":[]},{"id":"72eedeac12cbea25","type":"link out","z":"8ac4bc30b42b7a7d","name":"","mode":"link","links":["343866db0d57e779","d1dc7f1a2fa6359d"],"x":1175,"y":1220,"wires":[]},{"id":"baafa8e00d5472d9","type":"function","z":"8ac4bc30b42b7a7d","name":"Agenda Clarence","func":"msg.payload =\n\n\"Rappel d'un évenement de votre agenda! \"+\n\n\"{{(states.calendar.joret_clarence_gmail_com.attributes.message)}} \"+\nmsg.payload\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1010,"y":1220,"wires":[["72eedeac12cbea25"]]},{"id":"35145a13051930f8","type":"server-state-changed","z":"8ac4bc30b42b7a7d","name":"","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.rappel_agenda_eloise","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":270,"y":1740,"wires":[["c0a70d645e29e80c"]]},{"id":"c0a70d645e29e80c","type":"switch","z":"8ac4bc30b42b7a7d","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"120","vt":"str"},{"t":"eq","v":"1440","vt":"str"},{"t":"eq","v":"2880","vt":"str"}],"checkall":"true","repair":false,"outputs":3,"x":570,"y":1740,"wires":[["2fbbe75e82889a7d"],["887a457d18f1c984"],["9592be99549930de"]]},{"id":"73f1964d1612465e","type":"link out","z":"8ac4bc30b42b7a7d","name":"","mode":"link","links":["88f4a6b9887ab019","e8df3e37b83f6011"],"x":1275,"y":1740,"wires":[]},{"id":"4173147485eb2e15","type":"function","z":"8ac4bc30b42b7a7d","name":"Agenda Eloise","func":"msg.payload =\n\n\"Rappel d'un évenement de votre agenda! \"+\n\n\"{{(states.calendar.eloise_joret_gmail_com.attributes.message)}} \"+\nmsg.payload\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1060,"y":1740,"wires":[["73f1964d1612465e"]]},{"id":"511eeb547a02149b","type":"comment","z":"8ac4bc30b42b7a7d","name":"Rappel Agenda","info":"","x":100,"y":1200,"wires":[]},{"id":"10d29581f2317061","type":"inject","z":"8ac4bc30b42b7a7d","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":420,"y":1860,"wires":[["d2d97b4b170e80ed"]]},{"id":"c3182103944e887a","type":"cron","z":"8ac4bc30b42b7a7d","name":"At 14 PM","crontab":"0 14 * * *","x":100,"y":1920,"wires":[["469fe2413452d5b5"]]},{"id":"a60c2f4da2710433","type":"switch","z":"8ac4bc30b42b7a7d","name":"","property":"isBatteryLow","propertyType":"msg","rules":[{"t":"eq","v":"True","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":410,"y":1920,"wires":[["d2d97b4b170e80ed"]]},{"id":"6610eacdb60d442a","type":"link out","z":"8ac4bc30b42b7a7d","name":"","mode":"link","links":["22186f7a74fec36f","93d062bbf9af5c89","a7ddbf0dfd2c325b"],"x":855,"y":1900,"wires":[]},{"id":"873c0deb3c42b25b","type":"comment","z":"8ac4bc30b42b7a7d","name":"Notification de niveau de batterie","info":"","x":400,"y":1820,"wires":[]},{"id":"a8dc5190f3d1d134","type":"api-render-template","z":"8ac4bc30b42b7a7d","name":"if True on else off","server":"43d85569dace75e0","version":0,"template":"{{true if states('binary_sensor.co_portail_garage_contact') != 'off' }}\n{{false if states('binary_sensor.co_portail_garage_contact') == 'off' }}","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":1270,"y":340,"wires":[["9e82d326110ce9cf"]]},{"id":"9e82d326110ce9cf","type":"switch","z":"8ac4bc30b42b7a7d","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"True","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":1410,"y":380,"wires":[[]]},{"id":"0d1f6eef0e5e3849","type":"debug","z":"8ac4bc30b42b7a7d","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":650,"y":360,"wires":[]},{"id":"341c3f54065dfc4f","type":"server-state-changed","z":"8ac4bc30b42b7a7d","name":"","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.co_portail_garage_contact","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"on","halt_if_type":"str","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":"5","forType":"num","forUnits":"seconds","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":390,"y":500,"wires":[["0d1f6eef0e5e3849","b3b5317af0173d0f"],[]]},{"id":"d2d97b4b170e80ed","type":"api-render-template","z":"8ac4bc30b42b7a7d","name":"Liste des détecteurs","server":"43d85569dace75e0","version":0,"template":"    {% set result = namespace(sensors=[]) %}\n    {% set ns = namespace(found = 'Attention niveau batterie !! sur: ') %}\n    {% set exclude = [] %}\n    {% set threshold = 20 %}\n    {% for state in states.sensor | selectattr('attributes.device_class', '==', 'battery') %}\n      {% if 0 < state.state | int < threshold | int and not state.entity_id in exclude %}\n        {% set result.sensors = result.sensors + [state.name] %}\n      {% endif %}\n    {% endfor %}\n    {% for state in states.binary_sensor | selectattr('attributes.device_class', '==', 'battery') | selectattr('state', '==', 'on') %}\n      {% if not state.entity_id in exclude %}\n        {% set result.sensors = result.sensors + [state.name] %}\n      {% endif %}\n    {% endfor %}\n    {{ns.found + result.sensors|join(',  ')}}","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":640,"y":1920,"wires":[["6610eacdb60d442a"]]},{"id":"469fe2413452d5b5","type":"api-render-template","z":"8ac4bc30b42b7a7d","name":"isBatteryLow","server":"43d85569dace75e0","version":0,"template":"  {% set ns = namespace(found = false) %}\n    {% set exclude = [] %}\n    {% set threshold = 20 %}\n    {% for state in states.sensor | selectattr('attributes.device_class', '==', 'battery') %}\n      {% if 0 < state.state | int < threshold | int and not state.entity_id in exclude %}\n        {% set ns.found = true %}\n      {% endif %}\n    {% endfor %}\n    {% for state in states.binary_sensor | selectattr('attributes.device_class', '==', 'battery') | selectattr('state', '==', 'on') %}\n      {% if not state.entity_id in exclude %}\n        {% set ns.found = true %}\n      {% endif %}\n    {% endfor %}\n    {{ ns.found }}","resultsLocation":"isBatteryLow","resultsLocationType":"msg","templateLocation":"templateIsBatteryLow","templateLocationType":"msg","x":270,"y":1920,"wires":[["a60c2f4da2710433"]]},{"id":"d9e7d96d715b9843","type":"inject","z":"8ac4bc30b42b7a7d","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":100,"y":1820,"wires":[["469fe2413452d5b5"]]},{"id":"f0abe699c5fa5dad","type":"api-render-template","z":"8ac4bc30b42b7a7d","name":"if True on else off","server":"43d85569dace75e0","version":0,"template":"{{true if states('binary_sensor.co_portail_garage_contact') != 'on' }}\n{{false if states('binary_sensor.co_portail_garage_contact') == 'on' }}","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":870,"y":360,"wires":[["90a85ddaa7f7991e"]]},{"id":"90a85ddaa7f7991e","type":"switch","z":"8ac4bc30b42b7a7d","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"True","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":1070,"y":360,"wires":[[]]},{"id":"3e6bee7f23f19685","type":"server-state-changed","z":"8ac4bc30b42b7a7d","name":"","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.co_portail_garage_contact","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"off","halt_if_type":"str","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":"5","forType":"num","forUnits":"seconds","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":390,"y":560,"wires":[["82b0ebc98174dc11"],[]]},{"id":"559ffc9b1cc28961","type":"link out","z":"8ac4bc30b42b7a7d","name":"VersDoorbirdVersHAFrontend","mode":"link","links":["d24025ec168c1be2"],"x":1150,"y":980,"wires":[],"l":true},{"id":"2103ff8cf57a0f73","type":"server-state-changed","z":"8ac4bc30b42b7a7d","name":"","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.rappel_agenda_famille","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":270,"y":1600,"wires":[["32034412bd8c02d8"]]},{"id":"32034412bd8c02d8","type":"switch","z":"8ac4bc30b42b7a7d","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"120","vt":"str"},{"t":"eq","v":"1440","vt":"str"},{"t":"eq","v":"2880","vt":"str"}],"checkall":"true","repair":false,"outputs":3,"x":570,"y":1600,"wires":[["c6829cf3a57b62dd"],["1182e33dbd75871a"],["251c4a3025d40dda"]]},{"id":"fa12bca9737319c0","type":"link out","z":"8ac4bc30b42b7a7d","name":"","mode":"link","links":["22186f7a74fec36f","34dd5813f28f2a42","93d062bbf9af5c89","ced87f2e5d5c0601"],"x":1275,"y":1620,"wires":[]},{"id":"7b9941cab81b7d45","type":"function","z":"8ac4bc30b42b7a7d","name":"Agenda Nous","func":"msg.payload =\n\n\"Rappel d'un évenement de votre agenda! \"+\n\n\"{{(states.calendar.famille.attributes.message)}} \"+\nmsg.payload\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1040,"y":1620,"wires":[["fa12bca9737319c0"]]},{"id":"c1e758ec75f8bcbb","type":"server-state-changed","z":"8ac4bc30b42b7a7d","name":"","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.rappel_agenda_stephanie","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":280,"y":1360,"wires":[["ba38815f61991201"]]},{"id":"ba38815f61991201","type":"switch","z":"8ac4bc30b42b7a7d","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"120","vt":"str"},{"t":"eq","v":"1440","vt":"str"},{"t":"eq","v":"2880","vt":"str"}],"checkall":"true","repair":false,"outputs":3,"x":570,"y":1360,"wires":[["de7c96706ccfd65c"],["272f4b061281a37f"],["c9f36f306cf1ea83"]]},{"id":"2fe5c6b7ff380b2b","type":"link out","z":"8ac4bc30b42b7a7d","name":"","mode":"link","links":["22186f7a74fec36f","34dd5813f28f2a42"],"x":1175,"y":1360,"wires":[]},{"id":"d2f4f95b01ded92c","type":"function","z":"8ac4bc30b42b7a7d","name":"Agenda Stéphanie","func":"msg.payload =\n\n\"Rappel d'un évenement de votre agenda! \"+\n\n\"{{(states.calendar.stephanie.attributes.message)}} \"+\nmsg.payload\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1010,"y":1360,"wires":[["2fe5c6b7ff380b2b"]]},{"id":"cd65961ec4a18883","type":"debug","z":"8ac4bc30b42b7a7d","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":550,"y":1000,"wires":[]},{"id":"5da9360b2fea6718","type":"server-state-changed","z":"8ac4bc30b42b7a7d","name":"Boites aux lettres - Colis","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.co_boites_aux_lettres_colis","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":210,"y":840,"wires":[["db0416aa8ab8ec35","cd65961ec4a18883"]]},{"id":"4f6eabc35390803c","type":"server-state-changed","z":"8ac4bc30b42b7a7d","name":"Boites aux lettres - Colis","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.co_boites_aux_lettres_colis","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":250,"y":1120,"wires":[["df3c1473a368154d"]]},{"id":"cfbcbc19733fecea","type":"server-state-changed","z":"8ac4bc30b42b7a7d","name":"Boites aux lettres - Lettres","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.co_boite_aux_lettres_lettres","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":230,"y":1040,"wires":[["df3c1473a368154d"]]},{"id":"bc81ba42daf0b6eb","type":"function","z":"8ac4bc30b42b7a7d","name":"Agenda Pascal","func":"msg.payload =\n\n\"Rappel d'un évenement de votre agenda! \"+\n\n\"{{(states.calendar.pascal_joret_gmail_com.attributes.message)}} \"+\nmsg.payload\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1000,"y":1500,"wires":[["e32386ebd0b6b628"]]},{"id":"2b5baca10244ff6d","type":"api-render-template","z":"8ac4bc30b42b7a7d","name":"Aujourd'hui","server":"43d85569dace75e0","version":0,"template":"aujourd'hui à {{ strptime(states.calendar.famille.attributes.start_time, \"%Y-%m-%d %H:%M:%S\").strftime( \"%H heures %M\") }}\"","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":750,"y":1460,"wires":[["bc81ba42daf0b6eb"]]},{"id":"7665ab922c7ad5ca","type":"api-render-template","z":"8ac4bc30b42b7a7d","name":"Demain","server":"43d85569dace75e0","version":0,"template":"Demain à {{ strptime(states.calendar.famille.attributes.start_time, \"%Y-%m-%d %H:%M:%S\").strftime( \"%H heures %M\") }}\"","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":740,"y":1500,"wires":[["bc81ba42daf0b6eb"]]},{"id":"bd73af209de73daf","type":"api-render-template","z":"8ac4bc30b42b7a7d","name":"Après demain","server":"43d85569dace75e0","version":0,"template":"{{ strptime(states.calendar.famille.attributes.start_time, \"%Y-%m-%d %H:%M:%S\").strftime( \"le %d %m à %H heures %M\") }}\"","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":760,"y":1540,"wires":[["bc81ba42daf0b6eb"]]},{"id":"de7c96706ccfd65c","type":"api-render-template","z":"8ac4bc30b42b7a7d","name":"Aujourd'hui","server":"43d85569dace75e0","version":0,"template":"aujourd'hui à {{ strptime(states.calendar.stephanie.attributes.start_time, \"%Y-%m-%d %H:%M:%S\").strftime( \"%H heures %M\") }}\"","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":750,"y":1320,"wires":[["d2f4f95b01ded92c"]]},{"id":"272f4b061281a37f","type":"api-render-template","z":"8ac4bc30b42b7a7d","name":"Demain","server":"43d85569dace75e0","version":0,"template":"Demain à {{ strptime(states.calendar.stephanie.attributes.start_time, \"%Y-%m-%d %H:%M:%S\").strftime( \"%H heures %M\") }}\"","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":740,"y":1360,"wires":[["d2f4f95b01ded92c"]]},{"id":"c9f36f306cf1ea83","type":"api-render-template","z":"8ac4bc30b42b7a7d","name":"Après demain","server":"43d85569dace75e0","version":0,"template":"{{ strptime(states.calendar.stephanie.attributes.start_time, \"%Y-%m-%d %H:%M:%S\").strftime( \"le %d %m à %H heures %M\") }}\"","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":760,"y":1400,"wires":[["d2f4f95b01ded92c"]]},{"id":"c6829cf3a57b62dd","type":"api-render-template","z":"8ac4bc30b42b7a7d","name":"Aujourd'hui","server":"43d85569dace75e0","version":0,"template":"aujourd'hui à {{ strptime(states.calendar.famille.attributes.start_time, \"%Y-%m-%d %H:%M:%S\").strftime( \"%H heures %M\") }}\"","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":750,"y":1600,"wires":[["7b9941cab81b7d45"]]},{"id":"1182e33dbd75871a","type":"api-render-template","z":"8ac4bc30b42b7a7d","name":"Demain","server":"43d85569dace75e0","version":0,"template":"Demain à {{ strptime(states.calendar.famille.attributes.start_time, \"%Y-%m-%d %H:%M:%S\").strftime( \"%H heures %M\") }}\"","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":740,"y":1640,"wires":[["7b9941cab81b7d45"]]},{"id":"251c4a3025d40dda","type":"api-render-template","z":"8ac4bc30b42b7a7d","name":"Après demain","server":"43d85569dace75e0","version":0,"template":"{{ strptime(states.calendar.famille.attributes.start_time, \"%Y-%m-%d %H:%M:%S\").strftime( \"le %d %m à %H heures %M\") }}\"","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":760,"y":1680,"wires":[["7b9941cab81b7d45"]]},{"id":"2fbbe75e82889a7d","type":"api-render-template","z":"8ac4bc30b42b7a7d","name":"Aujourd'hui","server":"43d85569dace75e0","version":0,"template":"aujourd'hui à {{ strptime(states.calendar.eloise_joret_gmail_com.attributes.start_time, \"%Y-%m-%d %H:%M:%S\").strftime( \"%H heures %M\") }}\"","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":750,"y":1740,"wires":[["4173147485eb2e15"]]},{"id":"887a457d18f1c984","type":"api-render-template","z":"8ac4bc30b42b7a7d","name":"Demain","server":"43d85569dace75e0","version":0,"template":"Demain à {{ strptime(states.calendar.eloise_joret_gmail_com.attributes.start_time, \"%Y-%m-%d %H:%M:%S\").strftime( \"%H heures %M\") }}\"","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":740,"y":1780,"wires":[["4173147485eb2e15"]]},{"id":"9592be99549930de","type":"api-render-template","z":"8ac4bc30b42b7a7d","name":"Après demain","server":"43d85569dace75e0","version":0,"template":"{{ strptime(states.calendar.eloise_joret_gmail_com.attributes.start_time, \"%Y-%m-%d %H:%M:%S\").strftime( \"le %d %m à %H heures %M\") }}\"","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":760,"y":1820,"wires":[["4173147485eb2e15"]]},{"id":"27e4ed1365d23bac","type":"api-render-template","z":"8ac4bc30b42b7a7d","name":"Aujourd'hui","server":"43d85569dace75e0","version":0,"template":"aujourd'hui à {{ strptime(states.calendar.joret_clarence_gmail_com.attributes.start_time, \"%Y-%m-%d %H:%M:%S\").strftime( \"%H heures %M\") }}\"","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":750,"y":1200,"wires":[["baafa8e00d5472d9"]]},{"id":"93bbdd981e40d3b0","type":"api-render-template","z":"8ac4bc30b42b7a7d","name":"Demain","server":"43d85569dace75e0","version":0,"template":"Demain à {{ strptime(states.calendar.joret_clarence_gmail_com.attributes.start_time, \"%Y-%m-%d %H:%M:%S\").strftime( \"%H heures %M\") }}\"","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":740,"y":1240,"wires":[["baafa8e00d5472d9"]]},{"id":"294db659b4623c95","type":"api-render-template","z":"8ac4bc30b42b7a7d","name":"Après demain","server":"43d85569dace75e0","version":0,"template":"{{ strptime(states.calendar.joret_clarence_gmail_com.attributes.start_time, \"%Y-%m-%d %H:%M:%S\").strftime( \"le %d %m à %H heures %M\") }}\"","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":760,"y":1280,"wires":[["baafa8e00d5472d9"]]},{"id":"26f7af6023071363","type":"inject","z":"8ac4bc30b42b7a7d","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":430,"y":1540,"wires":[["c6829cf3a57b62dd"]]},{"id":"86386127d4e3d9d1","type":"comment","z":"d9ababc8eca2aa56","name":"Portails - Ouvertures des portails en rentrant","info":"","x":460,"y":120,"wires":[]},{"id":"a7d949351ca82ffc","type":"api-call-service","z":"d9ababc8eca2aa56","name":"Ouverture Portail extérieur","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"switch.portail_exterieur","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":320,"y":280,"wires":[["4e14133c246a780a"]]},{"id":"4e14133c246a780a","type":"delay","z":"d9ababc8eca2aa56","name":"","pauseType":"delay","timeout":"10","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":550,"y":280,"wires":[["ba38777a7c717c0e"]]},{"id":"fd8e5afba706863c","type":"comment","z":"d9ababc8eca2aa56","name":"Ouverture portail garage","info":"","x":330,"y":660,"wires":[]},{"id":"f25e67a3d9b5c2b5","type":"inject","z":"d9ababc8eca2aa56","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":90,"y":220,"wires":[["a7d949351ca82ffc"]]},{"id":"c96e244f7488b4aa","type":"api-call-service","z":"d9ababc8eca2aa56","name":"Ouverture portail garage","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"switch.portail_garage_switch_2","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":310,"y":840,"wires":[["25a9b3dfea3749b0"]]},{"id":"3c07fdf0235b59b2","type":"link in","z":"d9ababc8eca2aa56","name":"Ouverture portail garage","links":["b6b1d44599cc9d12","e8ec6d8ca85fda51","88509dc6c4592504"],"x":35,"y":760,"wires":[["c96e244f7488b4aa","89164a7a20d38ec4"]]},{"id":"26fc0810a4d91bde","type":"api-call-service","z":"d9ababc8eca2aa56","name":"fermeture portail garage","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"switch.portail_garage_switch_2","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":330,"y":1120,"wires":[["2e9de0ce3e1928e8"]]},{"id":"05a4ecb60dabf623","type":"comment","z":"d9ababc8eca2aa56","name":"Fermeture portail garage","info":"","x":350,"y":960,"wires":[]},{"id":"0123659092d4b55c","type":"function","z":"d9ababc8eca2aa56","name":"Notification - Fermeture du portail garage","func":"msg.payload =\n\n\"Fermeture du portail garage en cours !\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":540,"y":1040,"wires":[["990baf9e01b6a9ce"]]},{"id":"990baf9e01b6a9ce","type":"link out","z":"d9ababc8eca2aa56","name":"VersEchos","mode":"link","links":["34dd5813f28f2a42","a7ddbf0dfd2c325b","ced87f2e5d5c0601"],"x":830,"y":1040,"wires":[],"l":true},{"id":"89164a7a20d38ec4","type":"function","z":"d9ababc8eca2aa56","name":"Notification - Ouverture du portail garage","func":"msg.payload =\n\n\"Ouverture du portail garage en cours !\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":320,"y":760,"wires":[["561ed58991368f81"]]},{"id":"561ed58991368f81","type":"link out","z":"d9ababc8eca2aa56","name":"VersEchos","mode":"link","links":["34dd5813f28f2a42","a7ddbf0dfd2c325b","ced87f2e5d5c0601"],"x":590,"y":760,"wires":[],"l":true},{"id":"25a9b3dfea3749b0","type":"delay","z":"d9ababc8eca2aa56","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":640,"y":840,"wires":[["2cddfa8971abbaa5"]]},{"id":"9780d18bcf46416f","type":"link in","z":"d9ababc8eca2aa56","name":"fermeture portail garage","links":["57b03eb75692d971","92d2a8b42e735e94","b6b1d44599cc9d12","dfa1855a12f3108d"],"x":55,"y":1040,"wires":[["26fc0810a4d91bde","0123659092d4b55c"]]},{"id":"ad9aeb982f835360","type":"link in","z":"d9ababc8eca2aa56","name":"ouverture des portails en entrant","links":["58de140d97a68928"],"x":95,"y":280,"wires":[["a7d949351ca82ffc"]]},{"id":"7cd448b601c4a9ac","type":"inject","z":"d9ababc8eca2aa56","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":90,"y":420,"wires":[[]]},{"id":"184e0da0456f4f94","type":"link in","z":"d9ababc8eca2aa56","name":"ouverture des portails en sortant","links":["16c90ccc7be8d952"],"x":95,"y":480,"wires":[["88509dc6c4592504","9b1f159c78e937b5"]]},{"id":"dfa1855a12f3108d","type":"link out","z":"d9ababc8eca2aa56","name":"","mode":"link","links":["9780d18bcf46416f"],"x":1345,"y":300,"wires":[]},{"id":"ba38777a7c717c0e","type":"api-call-service","z":"d9ababc8eca2aa56","name":"Ouverture portail garage","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"switch.portail_garage_switch_2","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":770,"y":280,"wires":[["675339fc697a28f8"]]},{"id":"675339fc697a28f8","type":"ha-wait-until","z":"d9ababc8eca2aa56","name":"","server":"43d85569dace75e0","version":0,"outputs":2,"entityId":"binary_sensor.ir_garage_occupancy","entityIdFilterType":"exact","property":"state","comparator":"is","value":"on","valueType":"str","timeout":"1","timeoutType":"num","timeoutUnits":"minutes","entityLocation":"data","entityLocationType":"none","checkCurrentState":true,"blockInputOverrides":true,"x":980,"y":280,"wires":[["fe451551cf02c3eb"],["dfa1855a12f3108d"]]},{"id":"fe451551cf02c3eb","type":"delay","z":"d9ababc8eca2aa56","name":"","pauseType":"delay","timeout":"30","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":1140,"y":260,"wires":[["dfa1855a12f3108d"]]},{"id":"25df3c958da2fa78","type":"comment","z":"d9ababc8eca2aa56","name":"Portails - Ouverture des portails en sortant","info":"","x":420,"y":400,"wires":[]},{"id":"7ea880440883d771","type":"comment","z":"d9ababc8eca2aa56","name":"Portail extérieur","info":"","x":400,"y":1300,"wires":[]},{"id":"959b7857ae6e42c1","type":"api-call-service","z":"d9ababc8eca2aa56","name":"Ouverture Portail extérieur","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"switch.portail_exterieur","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":380,"y":1380,"wires":[["c8e3314aaab3742e"]]},{"id":"c8e3314aaab3742e","type":"function","z":"d9ababc8eca2aa56","name":"Notification - Ouverture du portail","func":"msg.payload =\n\n\"Ouverture du portail extérieur en cours !\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":720,"y":1380,"wires":[["a3ba06745fbaa52e"]]},{"id":"a3ba06745fbaa52e","type":"link out","z":"d9ababc8eca2aa56","name":"VersEchos","mode":"link","links":["34dd5813f28f2a42","a7ddbf0dfd2c325b","ced87f2e5d5c0601"],"x":970,"y":1380,"wires":[],"l":true},{"id":"34b7e91a12cecf33","type":"link in","z":"d9ababc8eca2aa56","name":"Ouverture Portail exterieur","links":["b4744f65cdb0c65f"],"x":175,"y":1380,"wires":[["959b7857ae6e42c1"]]},{"id":"88509dc6c4592504","type":"link out","z":"d9ababc8eca2aa56","name":"Ouverture portail garage","mode":"link","links":["3c07fdf0235b59b2"],"x":290,"y":460,"wires":[],"l":true},{"id":"b4744f65cdb0c65f","type":"link out","z":"d9ababc8eca2aa56","name":"Ouverture portail extérieur","mode":"link","links":["34b7e91a12cecf33"],"x":455,"y":540,"wires":[]},{"id":"9b1f159c78e937b5","type":"delay","z":"d9ababc8eca2aa56","name":"Ouverture portail exterieur","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":300,"y":540,"wires":[["b4744f65cdb0c65f","be5dbdf6a1665cb9"]]},{"id":"be5dbdf6a1665cb9","type":"delay","z":"d9ababc8eca2aa56","name":"Fermeture du portail garage","pauseType":"delay","timeout":"1","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":600,"y":460,"wires":[["92d2a8b42e735e94"]]},{"id":"92d2a8b42e735e94","type":"link out","z":"d9ababc8eca2aa56","name":"","mode":"link","links":["9780d18bcf46416f"],"x":755,"y":460,"wires":[]},{"id":"2aeac184d5da1877","type":"comment","z":"d9ababc8eca2aa56","name":"Fermeture des Volets - RDC","info":"","x":420,"y":1560,"wires":[]},{"id":"f91445d4b4ce9fb1","type":"api-call-service","z":"d9ababc8eca2aa56","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"cover","service":"close_cover","entityId":"cover.volet_buanderie, cover.volet_salon, cover.volet_sam, cover.volet_sam_grand, cover.volet_cuisine","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":440,"y":1700,"wires":[[]]},{"id":"d60ef121ccf6e325","type":"link in","z":"d9ababc8eca2aa56","name":"Fermeture des Volets rdc","links":["10c5a5c00e705eb5"],"x":235,"y":1700,"wires":[["f91445d4b4ce9fb1"]]},{"id":"4030cce89d67016e","type":"comment","z":"d9ababc8eca2aa56","name":"Fermeture des Volets - Etage","info":"","x":420,"y":1860,"wires":[]},{"id":"a9a90fc638995fec","type":"api-call-service","z":"d9ababc8eca2aa56","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"cover","service":"close_cover","entityId":"cover.volet_chambre_clarence, cover.volet_chambre_parents, cover.volet_eloise, cover.volet_sdb","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":440,"y":2000,"wires":[[]]},{"id":"5d8568cfb86064cc","type":"link in","z":"d9ababc8eca2aa56","name":"Fermeture des Volets etage","links":["fcc5a93f1ed2e495"],"x":235,"y":2000,"wires":[["a9a90fc638995fec"]]},{"id":"430f91079b0bb471","type":"comment","z":"d9ababc8eca2aa56","name":"Fermeture des Volets - RDC et etage","info":"","x":460,"y":2160,"wires":[]},{"id":"fadbfaf796ea21b2","type":"api-call-service","z":"d9ababc8eca2aa56","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"cover","service":"close_cover","entityId":"cover.volet_buanderie, cover.volet_salon, cover.volet_sam, cover.volet_sam_grand, cover.volet_cuisine, cover.volet_chambre_clarence, cover.volet_chambre_parents, cover.volet_eloise, cover.volet_sdb, cover.volet_garage, cover.volet_garage_2","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":460,"y":2300,"wires":[[]]},{"id":"66295810f042bf59","type":"link in","z":"d9ababc8eca2aa56","name":"Fermeture des Volets rdc et etage","links":["d42f5b55c068a9b3","7411d46daf781256"],"x":255,"y":2300,"wires":[["fadbfaf796ea21b2"]]},{"id":"2cddfa8971abbaa5","type":"link out","z":"d9ababc8eca2aa56","name":"","mode":"link","links":["29cd4a8f8808211b"],"x":1055,"y":980,"wires":[]},{"id":"2ae3214f848836f0","type":"comment","z":"d9ababc8eca2aa56","name":"Portails - exterieur - Intérieur - Auto off","info":"Remise à Off du switch pour permettre la fermeture ou l'ouverture","x":540,"y":2520,"wires":[]},{"id":"b3449546180593ab","type":"server-state-changed","z":"d9ababc8eca2aa56","name":"Portail extérieur","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"switch.portail_exterieur","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":240,"y":2660,"wires":[["348d387009ff4d7a"]]},{"id":"348d387009ff4d7a","type":"switch","z":"d9ababc8eca2aa56","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":470,"y":2660,"wires":[["b36ed40e84092880"]]},{"id":"5d8a252d034b2096","type":"server-state-changed","z":"d9ababc8eca2aa56","name":"Portail Garage","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"switch.portail_garage_switch_2","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":230,"y":2780,"wires":[["4ad7b89e82938871"]]},{"id":"4ad7b89e82938871","type":"switch","z":"d9ababc8eca2aa56","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":470,"y":2780,"wires":[["1d70c45745de43d2"]]},{"id":"17430f8bc5941b26","type":"api-call-service","z":"d9ababc8eca2aa56","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.portail_exterieur","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":810,"y":2660,"wires":[[]]},{"id":"b36ed40e84092880","type":"delay","z":"d9ababc8eca2aa56","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":600,"y":2660,"wires":[["17430f8bc5941b26"]]},{"id":"1d70c45745de43d2","type":"delay","z":"d9ababc8eca2aa56","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":620,"y":2780,"wires":[["6f220d080ab3d0e9"]]},{"id":"6f220d080ab3d0e9","type":"api-call-service","z":"d9ababc8eca2aa56","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.portail_garage_switch_2","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":810,"y":2780,"wires":[[]]},{"id":"2e9de0ce3e1928e8","type":"delay","z":"d9ababc8eca2aa56","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":640,"y":1120,"wires":[["2cddfa8971abbaa5"]]},{"id":"586ad27957aefd26","type":"debug","z":"bd8aec8f1871271e","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":670,"y":200,"wires":[]},{"id":"7e91924d8a912796","type":"server-events","z":"bd8aec8f1871271e","name":"","server":"43d85569dace75e0","version":1,"event_type":"doorbird_portier_une_personne_sonne","exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"waitForRunning":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"$outputData(\"eventData\").event_type","valueType":"jsonata"}],"x":310,"y":380,"wires":[["98880199f1176c79","586ad27957aefd26","ce1ba4885e7c9404","91019890881dd890","4878751a8d1b0500"]]},{"id":"98880199f1176c79","type":"function","z":"bd8aec8f1871271e","name":"Une personne sonne","func":"msg.payload =\n\n\"Une personne sonne au portail!!\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":700,"y":360,"wires":[["477d585d0c37ac25"]]},{"id":"477d585d0c37ac25","type":"link out","z":"bd8aec8f1871271e","name":"VersEchos","mode":"link","links":["34dd5813f28f2a42","a7ddbf0dfd2c325b","ced87f2e5d5c0601"],"x":970,"y":360,"wires":[],"l":true},{"id":"ce1ba4885e7c9404","type":"api-call-service","z":"bd8aec8f1871271e","name":"Faire sonner le carillon","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"switch.carillon_switch","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":700,"y":420,"wires":[["b198bad7c7f84a01"]]},{"id":"91019890881dd890","type":"link out","z":"bd8aec8f1871271e","name":"VersTelegramPhotoDoorbird","mode":"link","links":["231b1b91f3733db4"],"x":720,"y":280,"wires":[],"l":true},{"id":"b198bad7c7f84a01","type":"api-call-service","z":"bd8aec8f1871271e","name":"Doorbird en premier plan","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"rest_command","service":"launch_doorbird_on_android_tab","entityId":"","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":990,"y":420,"wires":[["f402f4e819ec9aa3","0f42e9ba31ea7116"]]},{"id":"f402f4e819ec9aa3","type":"debug","z":"bd8aec8f1871271e","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":1250,"y":540,"wires":[]},{"id":"2962a429d609e2d8","type":"api-call-service","z":"bd8aec8f1871271e","name":"HA en premier plan","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"button","service":"press","entityId":"button.lenovo_tab_m10_fhd_plus_bring_to_foreground","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1390,"y":420,"wires":[[]]},{"id":"0f42e9ba31ea7116","type":"delay","z":"bd8aec8f1871271e","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":1200,"y":420,"wires":[["2962a429d609e2d8"]]},{"id":"a1fba6b629d0d7e8","type":"cron","z":"bd8aec8f1871271e","name":"Every 10 minutes","crontab":"*/10 * * * *","x":1100,"y":580,"wires":[["2962a429d609e2d8"]]},{"id":"d6369fc9dde8fd65","type":"inject","z":"bd8aec8f1871271e","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1130,"y":720,"wires":[["2962a429d609e2d8"]]},{"id":"d24025ec168c1be2","type":"link in","z":"bd8aec8f1871271e","name":"DoorbirdVersHAFrontend","links":["559ffc9b1cc28961"],"x":780,"y":580,"wires":[["b198bad7c7f84a01"]],"l":true},{"id":"adcc5097c0af086d","type":"api-call-service","z":"bd8aec8f1871271e","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"rest_command","service":"fully_kiosk_cuisine_cmd","entityId":"","data":"{\t    \"url\": msg.payload\t}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":810,"y":880,"wires":[["c017d02d25dceb75"]]},{"id":"2d2d659fa9c74160","type":"inject","z":"bd8aec8f1871271e","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":320,"y":800,"wires":[["bebdf821bfc5820e"]]},{"id":"c017d02d25dceb75","type":"debug","z":"bd8aec8f1871271e","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":1150,"y":880,"wires":[]},{"id":"bebdf821bfc5820e","type":"function","z":"bd8aec8f1871271e","name":"Une personne sonne","func":"msg.payload =\n\n\"cmd=textToSpeech&text=Une personne sonne au portail!!\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":480,"y":880,"wires":[["adcc5097c0af086d"]]},{"id":"4878751a8d1b0500","type":"function","z":"bd8aec8f1871271e","name":"Une personne sonne","func":"msg.payload =\n\n\"cmd=textToSpeech&text=Une personne sonne au portail!!\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":700,"y":320,"wires":[["ecd1b8cfa47eced4"]]},{"id":"ecd1b8cfa47eced4","type":"link out","z":"bd8aec8f1871271e","name":"Vers Tablette","mode":"link","links":["685bdcecb00a3c9e"],"x":970,"y":320,"wires":[],"l":true},{"id":"20d5e1a28d74de7d","type":"api-call-service","z":"32a912a98d31efc0","name":"Lumière garage OFF","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.multilevel_power_switch_instance_1_level","data":"{\"brightness_pct\":0}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1020,"y":160,"wires":[[]]},{"id":"145ca90c48d9cba0","type":"switch","z":"32a912a98d31efc0","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"eq","v":"off","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":790,"y":300,"wires":[["2bed1946f5e1a802"],["d7fce633865d91d7"]]},{"id":"2bed1946f5e1a802","type":"api-call-service","z":"32a912a98d31efc0","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"switch.lumiere_sam","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":910,"y":240,"wires":[[]]},{"id":"d7fce633865d91d7","type":"api-call-service","z":"32a912a98d31efc0","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.lumiere_sam","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":910,"y":360,"wires":[[]]},{"id":"52ef89303226cf1a","type":"comment","z":"32a912a98d31efc0","name":"Lumière SAM","info":"","x":590,"y":240,"wires":[]},{"id":"4a5459ecc83fdb9c","type":"switch","z":"32a912a98d31efc0","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"eq","v":"off","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":830,"y":500,"wires":[["3b45771989e69d7d"],["6e9b26805b66d0ca"]]},{"id":"3b45771989e69d7d","type":"api-call-service","z":"32a912a98d31efc0","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"switch.lumiere_chambre_rue","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":910,"y":440,"wires":[[]]},{"id":"6e9b26805b66d0ca","type":"api-call-service","z":"32a912a98d31efc0","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.lumiere_chambre_rue","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":910,"y":560,"wires":[[]]},{"id":"ce1e23875b709066","type":"comment","z":"32a912a98d31efc0","name":"Lumière chambre clarence","info":"","x":610,"y":440,"wires":[]},{"id":"9ea36a9ed2aa587f","type":"switch","z":"32a912a98d31efc0","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"eq","v":"off","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":810,"y":700,"wires":[["d84609d2c2a88a3b"],["04b878340eb31666"]]},{"id":"d84609d2c2a88a3b","type":"api-call-service","z":"32a912a98d31efc0","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"switch.lumiere_chambre_parents","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":910,"y":640,"wires":[[]]},{"id":"04b878340eb31666","type":"api-call-service","z":"32a912a98d31efc0","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.lumiere_chambre_parents","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":910,"y":760,"wires":[[]]},{"id":"e8c5727870271b17","type":"comment","z":"32a912a98d31efc0","name":"Lumière chambre parents","info":"","x":610,"y":620,"wires":[]},{"id":"c4b6788d142bf7a1","type":"switch","z":"32a912a98d31efc0","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"eq","v":"off","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":160,"wires":[["9909e41fa72aad88"],["20d5e1a28d74de7d"]]},{"id":"7e44462718ae7224","type":"switch","z":"32a912a98d31efc0","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"eq","v":"off","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":730,"y":860,"wires":[["b6b1d44599cc9d12"],["57b03eb75692d971"]]},{"id":"97b44dc3879389e4","type":"switch","z":"32a912a98d31efc0","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"eq","v":"off","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":1033,"wires":[["03d452a46fe57c4c"],["76c0e5a7cb34f639"]]},{"id":"03d452a46fe57c4c","type":"api-call-service","z":"32a912a98d31efc0","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"switch.lumiere_salon","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":890,"y":973,"wires":[[]]},{"id":"76c0e5a7cb34f639","type":"api-call-service","z":"32a912a98d31efc0","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.lumiere_salon","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":890,"y":1093,"wires":[[]]},{"id":"36f45a034f835280","type":"comment","z":"32a912a98d31efc0","name":"Lumière Salon","info":"","x":550,"y":973,"wires":[]},{"id":"9909e41fa72aad88","type":"link out","z":"32a912a98d31efc0","name":"versLumièreGarageOn","mode":"link","links":["1f7c2ac821d4a422"],"x":855,"y":120,"wires":[]},{"id":"a01c14bd70730916","type":"function","z":"32a912a98d31efc0","name":"Notification ballon eau chaude - Arrêt","func":"msg.payload =\n\n\"La température de l'eau est de \"+ \n\"{{states('sensor.temperature_ballon_eau_chaude') }}\"+\n\"degrées\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1110,"y":80,"wires":[["5a3d78a114021e01"]]},{"id":"5a3d78a114021e01","type":"link out","z":"32a912a98d31efc0","name":"VersEchos","mode":"link","links":["34dd5813f28f2a42","a7ddbf0dfd2c325b","ced87f2e5d5c0601"],"x":1370,"y":80,"wires":[],"l":true},{"id":"b504a0cc4c01fe52","type":"link in","z":"32a912a98d31efc0","name":"LumièreGarageOff","links":["5bc8f1d00b2809f3"],"x":815,"y":200,"wires":[["20d5e1a28d74de7d"]]},{"id":"f967f42959cbe81c","type":"amazon-echo-device","z":"32a912a98d31efc0","name":"Serveur netgear","topic":"","x":590,"y":1180,"wires":[["30f9f0d577dc9dd6"]]},{"id":"a10f4f4a4ba28d04","type":"api-call-service","z":"32a912a98d31efc0","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"switch.nas_netgear","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":930,"y":1160,"wires":[[]]},{"id":"b6b1d44599cc9d12","type":"link out","z":"32a912a98d31efc0","name":"","mode":"link","links":["3c07fdf0235b59b2","9780d18bcf46416f"],"x":865,"y":840,"wires":[]},{"id":"57b03eb75692d971","type":"link out","z":"32a912a98d31efc0","name":"","mode":"link","links":["9780d18bcf46416f"],"x":865,"y":900,"wires":[]},{"id":"d186880a1355bde9","type":"amazon-echo-device","z":"32a912a98d31efc0","name":"lumière garage","topic":"","x":600,"y":160,"wires":[["c4b6788d142bf7a1"]]},{"id":"5af330f4c8c7114f","type":"amazon-echo-device","z":"32a912a98d31efc0","name":"lumière salle à manger","topic":"","x":600,"y":300,"wires":[["145ca90c48d9cba0"]]},{"id":"4ef0627ef676e133","type":"amazon-echo-device","z":"32a912a98d31efc0","name":"lumière chambre clarence","topic":"","x":610,"y":500,"wires":[["4a5459ecc83fdb9c"]]},{"id":"a0d02cf7968a1a2f","type":"amazon-echo-device","z":"32a912a98d31efc0","name":"lumière chambre parents","topic":"","x":610,"y":700,"wires":[["9ea36a9ed2aa587f"]]},{"id":"609860cc4e09eaef","type":"amazon-echo-device","z":"32a912a98d31efc0","name":"lumière salon","topic":"","x":580,"y":1040,"wires":[["97b44dc3879389e4"]]},{"id":"2c02f50a3c551fe0","type":"amazon-echo-hub","z":"32a912a98d31efc0","port":"80","processinput":0,"discovery":true,"x":290,"y":620,"wires":[["d186880a1355bde9","5af330f4c8c7114f","4ef0627ef676e133","a0d02cf7968a1a2f","609860cc4e09eaef","f967f42959cbe81c","cb83a94ce169ba92","52b6b10c49d409de","2006833b2745959f","1eb35ef23d231cf5","b0450ac1c6db6334","f5cf844dcb854371","e11aaec3497f9b9e"]]},{"id":"3524aa1bf9f15426","type":"switch","z":"32a912a98d31efc0","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":830,"y":1300,"wires":[["16c90ccc7be8d952"]]},{"id":"16c90ccc7be8d952","type":"link out","z":"32a912a98d31efc0","name":"","mode":"link","links":["184e0da0456f4f94"],"x":935,"y":1300,"wires":[]},{"id":"672bfc6a532d3cfc","type":"debug","z":"32a912a98d31efc0","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":880,"y":40,"wires":[]},{"id":"a62c2915a4067d34","type":"switch","z":"32a912a98d31efc0","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":880,"y":80,"wires":[["a01c14bd70730916"]]},{"id":"f5a891ac87e54e53","type":"switch","z":"32a912a98d31efc0","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":830,"y":1400,"wires":[["58de140d97a68928"]]},{"id":"58de140d97a68928","type":"link out","z":"32a912a98d31efc0","name":"","mode":"link","links":["ad9aeb982f835360"],"x":935,"y":1400,"wires":[]},{"id":"30f9f0d577dc9dd6","type":"switch","z":"32a912a98d31efc0","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"eq","v":"off","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":750,"y":1180,"wires":[["a10f4f4a4ba28d04"],[]]},{"id":"9d6c56dd6ed79a0a","type":"switch","z":"32a912a98d31efc0","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":830,"y":1500,"wires":[["10c5a5c00e705eb5"]]},{"id":"10c5a5c00e705eb5","type":"link out","z":"32a912a98d31efc0","name":"","mode":"link","links":["d60ef121ccf6e325"],"x":955,"y":1500,"wires":[]},{"id":"304ba2cb90f4954f","type":"switch","z":"32a912a98d31efc0","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":770,"y":1620,"wires":[["fcc5a93f1ed2e495"]]},{"id":"10c0c8137eb8a3e8","type":"switch","z":"32a912a98d31efc0","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":830,"y":1700,"wires":[["d42f5b55c068a9b3"]]},{"id":"fcc5a93f1ed2e495","type":"link out","z":"32a912a98d31efc0","name":"","mode":"link","links":["5d8568cfb86064cc"],"x":895,"y":1620,"wires":[]},{"id":"d42f5b55c068a9b3","type":"link out","z":"32a912a98d31efc0","name":"","mode":"link","links":["66295810f042bf59"],"x":975,"y":1700,"wires":[]},{"id":"52b6b10c49d409de","type":"amazon-echo-device","z":"32a912a98d31efc0","name":"volets étage","topic":"","x":570,"y":1620,"wires":[["304ba2cb90f4954f"]]},{"id":"cb83a94ce169ba92","type":"amazon-echo-device","z":"32a912a98d31efc0","name":"tous les volets","topic":"","x":580,"y":1700,"wires":[["10c0c8137eb8a3e8"]]},{"id":"f5cf844dcb854371","type":"amazon-echo-device","z":"32a912a98d31efc0","name":"portail garage","topic":"","x":580,"y":860,"wires":[["7e44462718ae7224"]]},{"id":"b0450ac1c6db6334","type":"amazon-echo-device","z":"32a912a98d31efc0","name":"Portails en sortant","topic":"","x":590,"y":1300,"wires":[["3524aa1bf9f15426"]]},{"id":"1eb35ef23d231cf5","type":"amazon-echo-device","z":"32a912a98d31efc0","name":"Portails en rentant","topic":"","x":570,"y":1400,"wires":[["f5a891ac87e54e53"]]},{"id":"2006833b2745959f","type":"amazon-echo-device","z":"32a912a98d31efc0","name":"Volets rez-de-chaussée","topic":"","x":570,"y":1500,"wires":[["9d6c56dd6ed79a0a"]]},{"id":"e11aaec3497f9b9e","type":"amazon-echo-device","z":"32a912a98d31efc0","name":"température eau chaude","topic":"","x":630,"y":80,"wires":[["a62c2915a4067d34"]]},{"id":"59deab440bf0efe4","type":"api-call-service","z":"b094d7f93a062c25","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"hassio","service":"host_reboot","entityId":"","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":610,"y":260,"wires":[["85a7440ef5172bd1"]]},{"id":"949aadcb4e226f34","type":"api-call-service","z":"b094d7f93a062c25","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"hassio","service":"addon_restart","entityId":"","data":"{\"addon\":\"core_mosquitto\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":610,"y":380,"wires":[["7d46632296a03958"]]},{"id":"85a7440ef5172bd1","type":"function","z":"b094d7f93a062c25","name":"Notification - Restart de HA","func":"msg.payload =\n\n\"Rédemmarrage de Home Assistant\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":900,"y":260,"wires":[["f5e044a4166e34af"]]},{"id":"f5e044a4166e34af","type":"link out","z":"b094d7f93a062c25","name":"VersTelegram","mode":"link","links":["a7ddbf0dfd2c325b"],"x":1140,"y":260,"wires":[],"l":true},{"id":"7d46632296a03958","type":"function","z":"b094d7f93a062c25","name":"Notification - Restart mosquitto","func":"msg.payload =\n\n\"Restart de mosquitto\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":380,"wires":[["3838e32361eaade2"]]},{"id":"3838e32361eaade2","type":"link out","z":"b094d7f93a062c25","name":"VersTelegram","mode":"link","links":["a7ddbf0dfd2c325b"],"x":1140,"y":380,"wires":[],"l":true},{"id":"d8efbb44305d89a8","type":"api-call-service","z":"b094d7f93a062c25","name":"","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"hassio","service":"addon_restart","entityId":"","data":"{\"addon\":\"a0d7b954_zwavejs2mqtt\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":650,"y":520,"wires":[["e3627fd7b8dc6a56"]]},{"id":"e3627fd7b8dc6a56","type":"function","z":"b094d7f93a062c25","name":"Notification - Restart zwaveJS","func":"msg.payload =\n\n\"Restart de mosquitto\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":950,"y":520,"wires":[["5367c0af079bcc54"]]},{"id":"5367c0af079bcc54","type":"link out","z":"b094d7f93a062c25","name":"VersTelegram","mode":"link","links":["a7ddbf0dfd2c325b"],"x":1180,"y":520,"wires":[],"l":true},{"id":"527492a2c10fcfd6","type":"cron","z":"b094d7f93a062c25","name":"At 1 AM","crontab":"0 1 * * *","x":350,"y":260,"wires":[[]]},{"id":"f8cde21a0fba0ff5","type":"comment","z":"b094d7f93a062c25","name":"Reboot HA","info":"","x":360,"y":180,"wires":[]},{"id":"a6b72a7661ad7fe1","type":"cron","z":"b094d7f93a062c25","name":"At 1:15 AM","crontab":"15 1 * * *","x":360,"y":380,"wires":[["949aadcb4e226f34"]]},{"id":"18b6f78cd922e92b","type":"cron","z":"b094d7f93a062c25","name":"At 1:20 AM","crontab":"20 1 * * *","x":360,"y":520,"wires":[[]]},{"id":"44e45396c52dc3e5","type":"comment","z":"b094d7f93a062c25","name":"Reboot Mosquitto","info":"","x":380,"y":320,"wires":[]},{"id":"a1484fcd62a65527","type":"comment","z":"b094d7f93a062c25","name":"Reboot Zwave JS","info":"","x":390,"y":460,"wires":[]},{"id":"bf394d5a.9fd29","type":"debug","z":"b6bf4fb2.8e8618","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1290,"y":380,"wires":[]},{"id":"b599d42c.8ecc7","type":"function","z":"b6bf4fb2.8e8618","name":"Structure payload","func":"function isNumeric(n) { \n      return !isNaN(parseFloat(n)) && isFinite(n); \n}\n\n// Pour tous les labels \nfor (var label in msg.payload ) {\n    var value = msg.payload[label];\n    \n\t// Correction des valeurs type string en numérique \t\t\n\tif (label == \"OPTARIF\")\t{\n  \t\t// L'option tarifaire choisie (Groupe \"OPTARIF\") est codée sur 4 caractères alphanumériques \n  \t\t// J'ai pris un nombre arbitraire codé dans l'ordre ci-dessous \n  \t\t// je mets le 4eme char à 0, trop de possibilités \n      \tvalue = value.substring(0, 3);\n    \n       \tif      (value==\"BAS\") value=1;// BASE => Option Base. \n  \t\telse if (value==\"HC.\") value=2;// HC.. => Option Heures Creuses. \n  \t\telse if (value==\"EJP\") value=3;// EJP. => Option EJP. \n  \t\telse if (value==\"BBR\") value=4;// BBRx => Option Tempo\n  \t\telse value = 0;\n  \t\t\n  \t\tmsg.payload[label] = value;\n\t} else if (label==\"HHPHC\") {\n      // L'horaire heures pleines/heures creuses (Groupe \"HHPHC\") est codé par un caractère A à Y \n      // J'ai choisi de prendre son code ASCII\n      msg.payload[label] = value.charCodeAt();\n    } else if ( label == \"PTEC\") {\n      // La période tarifaire en cours (Groupe \"PTEC\"), est codée sur 4 caractères \n      // J'ai pris un nombre arbitraire codé dans l'ordre ci-dessous\n      if      (value==\"TH..\") value= 1; // Toutes les Heures. \n      else if (value==\"HC..\") value= \"Heures Creuses\"; // Heures Creuses. \n      else if (value==\"HP..\") value= \"Heures Pleines\"; // Heures Pleines. \n      else if (value==\"HN..\") value= 4; // Heures Normales. \n      else if (value==\"PM..\") value= 5; // Heures de Pointe Mobile. \n      else if (value==\"HCJB\") value= 6; // Heures Creuses Jours Bleus. \n      else if (value==\"HCJW\") value= 7; // Heures Creuses Jours Blancs (White). \n      else if (value==\"HCJR\") value= 8; // Heures Creuses Jours Rouges. \n      else if (value==\"HPJB\") value= 9; // Heures Pleines Jours Bleus. \n      else if (value==\"HPJW\") value= 10;// Heures Pleines Jours Blancs (White). \n      else if (value==\"HPJR\") value= 11;// Heures Pleines Jours Rouges. \n      else value = 0;\n      \n      msg.payload[label] = value;\n    } else if ( label == \"IINST\") {\n        delete msg.payload.IINST;\n        msg.payload.IINST = Number(value)\n    } else if ( label == \"IMAX\") {\n        delete msg.payload.IMAX;\n        msg.payload.IMAX1 = Number(value);\n    } else if ( isNumeric(value) && label != \"ADCO\" ) {\n        // Transformer les valeurs numériques\n        msg.payload[label] = Number(value);\n    }\n}\n\n// Sauvegarde dans le contexte global\ncontext.global.teleinfo = msg.payload;\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":650,"y":400,"wires":[["38966188.3838be","17473b62.0be655","5203f231.a9309c","f8b9a9d0.28a1d8","58790411.399b94","bc2cf4c3.18dc9","cf3f5ea2.318c38"]]},{"id":"e6ae1666.7e85e","type":"mqtt out","z":"b6bf4fb2.8e8618","name":"edf/index_wh","topic":"edf/index_wh","qos":"","retain":"true","broker":"580338f6.25a79","x":1310,"y":420,"wires":[]},{"id":"2b6d68ce.c4a64","type":"mqtt out","z":"b6bf4fb2.8e8618","name":"edf/index_kwh","topic":"edf/index_kwh","qos":"","retain":"true","broker":"580338f6.25a79","x":1320,"y":520,"wires":[]},{"id":"57a56df7.4661d4","type":"mqtt out","z":"b6bf4fb2.8e8618","name":"edf/iinst","topic":"edf/iinst","qos":"","retain":"true","broker":"580338f6.25a79","x":1300,"y":620,"wires":[]},{"id":"9229bd29.ca27b8","type":"serial in","z":"b6bf4fb2.8e8618","name":"","serial":"29cc3035.d7f7","x":70,"y":400,"wires":[["7c005dc3.81bf24"]]},{"id":"38966188.3838be","type":"function","z":"b6bf4fb2.8e8618","name":"INDEX TOTAL WH","func":"var INDEX = msg.payload.HCHC + msg.payload.HCHP\n\nmsg.payload = INDEX\nreturn msg;","outputs":1,"noerr":0,"x":910,"y":400,"wires":[["71022c13.706b44"]]},{"id":"700dcde7.3c3524","type":"function","z":"b6bf4fb2.8e8618","name":"valide trame","func":"// La trame complète est reçue dans 'msg'\nvar teleinfo={};\n\n// Enlever les codes début et fin de trame et récupérer les lignes 1 à 1\nvar lines = msg.payload.toString().replace(\"\\u0002\\n\",\"\").replace(\"\\r\\u0003\",\"\");\nlines = lines.split(\"\\r\\n\");\n\n// Pour chaque ligne\nfor (var line in lines) {\n\tvar i;\n  \tvar checksum = 32;\n  \t\n  \t// Recupérer le label, la valeur et la checksum\n  \t// si la checksum est un espace on le remplace par un caractère non \n  \t// autorisé en checksum (ici 's') pour eviter pb de split\n  \t// donc espace espace devient espace s\n\tvar myline = lines[line].toString().replace(\"  \",\" s\").split(\" \");\n\t\n\t// on dépile nos 3 valeurs\n\tvar check = myline.pop();\n\tvar value = myline.pop();\n\tvar label = myline.pop();\n\t\n\t// On peu repositionner la checksum à espace si c'était le cas\n\tif (check == \"s\") check = \" \";\n\n\t// Calcul de la checksum sur ce qu'on a reçu, on balaye tous les caractères\t\t\n  \tfor (i = 0; i < label.length; i++) checksum += label.charCodeAt(i);\n  \tfor (i = 0; i < value.length; i++) checksum += value.charCodeAt(i);\n \tchecksum = ((checksum%256) & 63) + 32;\n \tchecksum = String.fromCharCode(checksum);\n\t\n\t// Checksum correcte ?\n \tif (checksum == check ) {\n\t\tteleinfo[label] = value;\n\t} else {\n\t\tconsole.log(\"'%s' '%s' '%s' => Bad Checksum '%s'\", label, value, check, checksum );\n\t}\n}\nreturn [ { payload: teleinfo } ];","outputs":1,"noerr":0,"initialize":"","finalize":"","x":450,"y":400,"wires":[["b599d42c.8ecc7","a34454a0.f9e508"]]},{"id":"71022c13.706b44","type":"rbe","z":"b6bf4fb2.8e8618","name":"","func":"rbe","gap":"","start":"","inout":"out","property":"payload","x":1110,"y":400,"wires":[["bf394d5a.9fd29","e6ae1666.7e85e"]]},{"id":"17473b62.0be655","type":"function","z":"b6bf4fb2.8e8618","name":"INDEX TOTAL KWH","func":"var INDEX = msg.payload.HCHC + msg.payload.HCHP\n\nmsg.payload = INDEX / 1000\nreturn msg;","outputs":1,"noerr":0,"x":920,"y":460,"wires":[["8bcf3845.76c17"]]},{"id":"8bcf3845.76c17","type":"rbe","z":"b6bf4fb2.8e8618","name":"","func":"rbe","gap":"","start":"","inout":"out","property":"payload","x":1110,"y":460,"wires":[["2427788b.79c72","2b6d68ce.c4a64"]]},{"id":"2427788b.79c72","type":"debug","z":"b6bf4fb2.8e8618","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1290,"y":480,"wires":[]},{"id":"bc2cf4c3.18dc9","type":"function","z":"b6bf4fb2.8e8618","name":"IINST","func":"var IINST = msg.payload.IINST\n\nmsg.payload = IINST\nreturn msg;","outputs":1,"noerr":0,"x":870,"y":520,"wires":[["c06a8f31.0565d"]]},{"id":"dd6250c4.56d518","type":"debug","z":"b6bf4fb2.8e8618","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1290,"y":580,"wires":[]},{"id":"c06a8f31.0565d","type":"rbe","z":"b6bf4fb2.8e8618","name":"","func":"rbe","gap":"","start":"","inout":"out","property":"payload","x":1110,"y":520,"wires":[["dd6250c4.56d518","57a56df7.4661d4"]]},{"id":"7c005dc3.81bf24","type":"delay","z":"b6bf4fb2.8e8618","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"20","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"outputs":1,"x":260,"y":400,"wires":[["700dcde7.3c3524","420cccfd.18dbfc"]]},{"id":"5203f231.a9309c","type":"function","z":"b6bf4fb2.8e8618","name":"INDEX HC KWH","func":"var INDEX = msg.payload.HCHC\n\nmsg.payload = INDEX / 1000\nreturn msg;","outputs":1,"noerr":0,"x":900,"y":340,"wires":[["b042d1e6.2264e"]]},{"id":"f8b9a9d0.28a1d8","type":"function","z":"b6bf4fb2.8e8618","name":"INDEX HP KWH","func":"var INDEX = msg.payload.HCHP\n\nmsg.payload = INDEX / 1000\nreturn msg;","outputs":1,"noerr":0,"x":900,"y":280,"wires":[["3adb384.0d426c8","9cca2954.3e65e"]]},{"id":"9cca2954.3e65e","type":"debug","z":"b6bf4fb2.8e8618","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1290,"y":180,"wires":[]},{"id":"7a3dcfd0.a80b8","type":"mqtt out","z":"b6bf4fb2.8e8618","name":"edf/index_hp_kwh","topic":"edf/index_hp_kwh","qos":"","retain":"true","broker":"580338f6.25a79","x":1330,"y":220,"wires":[]},{"id":"2a2f87fa.cb4dc8","type":"debug","z":"b6bf4fb2.8e8618","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1290,"y":280,"wires":[]},{"id":"dac4e55d.f70d18","type":"mqtt out","z":"b6bf4fb2.8e8618","name":"edf/index_hc_wh","topic":"edf/index_hc_kwh","qos":"","retain":"true","broker":"580338f6.25a79","x":1330,"y":320,"wires":[]},{"id":"b042d1e6.2264e","type":"rbe","z":"b6bf4fb2.8e8618","name":"","func":"rbe","gap":"","start":"","inout":"out","property":"payload","x":1110,"y":340,"wires":[["dac4e55d.f70d18","2a2f87fa.cb4dc8"]]},{"id":"3adb384.0d426c8","type":"rbe","z":"b6bf4fb2.8e8618","name":"","func":"rbe","gap":"","start":"","inout":"out","property":"payload","x":1110,"y":280,"wires":[["7a3dcfd0.a80b8","9cca2954.3e65e"]]},{"id":"58790411.399b94","type":"debug","z":"b6bf4fb2.8e8618","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":650,"y":300,"wires":[]},{"id":"a34454a0.f9e508","type":"debug","z":"b6bf4fb2.8e8618","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":450,"y":300,"wires":[]},{"id":"420cccfd.18dbfc","type":"debug","z":"b6bf4fb2.8e8618","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":270,"y":300,"wires":[]},{"id":"cf3f5ea2.318c38","type":"function","z":"b6bf4fb2.8e8618","name":"PTEC","func":"var PTEC = msg.payload.PTEC\n\nmsg.payload = PTEC\nreturn msg;","outputs":1,"noerr":0,"x":870,"y":580,"wires":[["aed6ada5.e41f18"]]},{"id":"d71fee6.969b89","type":"mqtt out","z":"b6bf4fb2.8e8618","name":"edf/ptec","topic":"edf/ptec","qos":"","retain":"true","broker":"580338f6.25a79","x":1300,"y":720,"wires":[]},{"id":"f395beb.f5510c","type":"debug","z":"b6bf4fb2.8e8618","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1290,"y":680,"wires":[]},{"id":"aed6ada5.e41f18","type":"rbe","z":"b6bf4fb2.8e8618","name":"","func":"rbe","gap":"","start":"","inout":"out","property":"payload","x":1110,"y":580,"wires":[["f395beb.f5510c","d71fee6.969b89"]]},{"id":"8a5d12df.7e9878","type":"api-get-history","z":"ca87c975.6f38b","name":"index edf -2mn","server":"43d85569dace75e0","version":0,"startdate":"","enddate":"","entityid":"sensor.index_edf_wh","entityidtype":"is","useRelativeTime":true,"relativeTime":"2m","flatten":true,"output_type":"array","output_location_type":"msg","output_location":"payload","x":280,"y":360,"wires":[["1114b491.4e8903"]]},{"id":"2dea21b8.fd7f3e","type":"api-current-state","z":"ca87c975.6f38b","name":"index edf now","server":"","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.index_edf_wh","state_type":"num","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"for":0,"forType":"num","forUnits":"minutes","x":280,"y":460,"wires":[["293d209b.f1d7a8"]]},{"id":"1114b491.4e8903","type":"function","z":"ca87c975.6f38b","name":"","func":"msg2 = {};\nmsg2.payload = {};\ntopic = 'old';\nmsg2.payload.old_state = parseFloat(msg.payload[0].state);\nmsg2.payload.old_date = Date.parse(msg.payload[0].last_changed)/1000|0;\nmsg2.topic = topic;\nreturn msg2;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":450,"y":360,"wires":[["fea858fd.3c007","f50434ab.e5e0c"]]},{"id":"fea858fd.3c007","type":"join","z":"ca87c975.6f38b","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":590,"y":400,"wires":[["a23f2227.24dd38"]]},{"id":"a23f2227.24dd38","type":"function","z":"ca87c975.6f38b","name":"","func":"old = msg.payload.old.old_state;\ncurrent = msg.payload.new.new_state;\ndiff_index = current - old;\ndiff_seconds = msg.payload.new.new_date - msg.payload.old.old_date;\ncoeff = diff_seconds / 3600\nconso = diff_index / coeff\nconso = Math.round(conso*100)/100\nmsg2 = {};\nmsg2.payload = {};\nmsg2.payload.conso = conso;\nreturn msg2;","outputs":1,"noerr":0,"x":770,"y":400,"wires":[["d8b67352.20eda8"]]},{"id":"dca20d0b.d64048","type":"inject","z":"ca87c975.6f38b","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"120","crontab":"","once":true,"onceDelay":"30","topic":"","payload":"","payloadType":"date","x":110,"y":420,"wires":[["8a5d12df.7e9878","2dea21b8.fd7f3e"]]},{"id":"293d209b.f1d7a8","type":"function","z":"ca87c975.6f38b","name":"","func":"msg3 = {};\nmsg3.payload = {};\ntopic = 'new';\nmsg3.payload.new_state = parseFloat(msg.payload);\nmsg3.payload.new_date = Date.parse(msg.data.last_changed)/1000|0;\nmsg3.topic = topic;\nreturn msg3;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":450,"y":460,"wires":[["fea858fd.3c007","b34ca34f.bb8688"]]},{"id":"ae07498a.aed6e8","type":"mqtt out","z":"ca87c975.6f38b","name":"puissance instantanée","topic":"edf/puissance_inst","qos":"","retain":"true","broker":"580338f6.25a79","x":1280,"y":400,"wires":[]},{"id":"d8b67352.20eda8","type":"function","z":"ca87c975.6f38b","name":"transforme en nombre","func":"\nmsg.payload= parseFloat(msg.payload.conso);\n\nreturn msg;\n\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1020,"y":400,"wires":[["ae07498a.aed6e8"]]},{"id":"f50434ab.e5e0c","type":"debug","z":"ca87c975.6f38b","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":585,"y":315,"wires":[]},{"id":"b34ca34f.bb8688","type":"debug","z":"ca87c975.6f38b","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":590,"y":480,"wires":[]},{"id":"1ab3348390070769","type":"api-render-template","z":"c375fce693136161","name":"Prévision Méteo","server":"43d85569dace75e0","version":0,"template":"Coucou ... bulletin méteo... Une journée{% set condition =\n(states.weather.la_chevroliere.attributes.forecast[0].condition) %} {% set\nconditions = {'clear-night': 'nuit dégagée', 'cloudy': 'nuageuse',\n'exceptional': 'exceptionnelle', 'fog': ' avec broullard', 'hail': 'grêle',\n'lightning': 'Orageuse', 'lightning-rainy': 'orageuse avec de la pluie',\n'partlycloudy': 'partiellement nuageuse', 'pouring': ' avec pluie\ntorentielle', 'rainy': 'pluvieuse', 'snowy': 'avec de la neige',\n'snowy-rainy': ' avec neige et pluvieuse', 'sunny': 'ensoleillé', 'windy':\n'Venteuse', 'windy-variant': 'variante venteuse'} %} {{\nconditions[condition] }} est attendue aujourd'hui , avec une température\nmoyenne de {{state_attr('weather.la_chevroliere', 'forecast')[0].temperature\n}}°C et un minimum de {{state_attr('weather.la_chevroliere',\n'forecast')[0].templow }}°C. Demain une journée {% set condition =\n(states.weather.la_chevroliere.attributes.forecast[1].condition) %} {% set\nconditions = {'clear-night': 'nuit claire', 'cloudy': 'nuageuse',\n'exceptional': 'exceptionnelle', 'fog': ' avec broullard', 'hail': 'grêle',\n'lightning': 'Orageuse', 'lightning-rainy': 'orageuse avec de la pluie',\n'partlycloudy': 'partiellement nuageuse', 'pouring': ' avec pluie\ntorentielle', 'rainy': 'pluvieuse', 'snowy': 'avec de la neige',\n'snowy-rainy': ' avec neige et pluvieuse', 'sunny': 'ensoleillé', 'windy':\n'Venteuse', 'windy-variant': 'variante venteuse'} %} {{\nconditions[condition] }} est prévue avec une température maxi de\n{{state_attr('weather.la_chevroliere', 'forecast')[1].temperature }}","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":500,"y":160,"wires":[["617bac76d94e3936"]]},{"id":"617bac76d94e3936","type":"link out","z":"c375fce693136161","name":"","mode":"link","links":["93d062bbf9af5c89"],"x":655,"y":160,"wires":[]},{"id":"549940cc36b460a9","type":"cron","z":"c375fce693136161","name":"At 8:30 AM","crontab":"30 8 * * *","x":180,"y":160,"wires":[["1ab3348390070769"]]},{"id":"fa7caa2883360450","type":"comment","z":"c375fce693136161","name":"Prévision méteo","info":"","x":390,"y":100,"wires":[]},{"id":"5ed6b5d38eb561b0","type":"server-state-changed","z":"c375fce693136161","name":"","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.44_weather_alert","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":290,"y":320,"wires":[["c2697669f5108af5"]]},{"id":"c2697669f5108af5","type":"switch","z":"c375fce693136161","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"jaune","vt":"str"},{"t":"eq","v":"orange","vt":"str"},{"t":"eq","v":"rouge","vt":"str"},{"t":"eq","v":"vert","vt":"str"}],"checkall":"true","repair":false,"outputs":4,"x":630,"y":320,"wires":[["1ce7ae990e95a6e2"],["1ce7ae990e95a6e2"],["1ce7ae990e95a6e2"],["fb85617466739913"]]},{"id":"1ce7ae990e95a6e2","type":"api-render-template","z":"c375fce693136161","name":"Message alerte méteo","server":"43d85569dace75e0","version":0,"template":"    Alerte météo {{states('sensor.44_weather_alert')}} en cours:\n     {%- for attr in ['Vent violent', 'Pluie-inondation', 'Orages', 'Inondation', 'Neige-verglas', 'Canicule', 'Grand-froid', 'Avalanches', 'Vagues-submersion'] -%} {%- if state_attr('sensor.44_weather_alert', attr) != 'Vert' and state_attr('sensor.44_weather_alert', attr) != None %}\n     - {{attr}} : {{state_attr('sensor.44_weather_alert', attr)}} {%- endif -%} {% endfor -%}","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":900,"y":300,"wires":[["52ce9b2eeac28c0a"]]},{"id":"52ce9b2eeac28c0a","type":"link out","z":"c375fce693136161","name":"","mode":"link","links":["93d062bbf9af5c89"],"x":1055,"y":300,"wires":[]},{"id":"9552decce3c2c903","type":"inject","z":"c375fce693136161","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":710,"y":260,"wires":[["1ce7ae990e95a6e2"]]},{"id":"fb85617466739913","type":"function","z":"c375fce693136161","name":"Fin de l'alerte","func":"msg.payload =\n\n\"Fin de l'alerte météo\" \n\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":900,"y":360,"wires":[["52ce9b2eeac28c0a"]]},{"id":"069e8e73edbbd340","type":"comment","z":"c375fce693136161","name":"Prévision méteo","info":"","x":380,"y":260,"wires":[]},{"id":"2f4f2f4f9664c625","type":"inject","z":"c375fce693136161","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":210,"y":100,"wires":[["1ab3348390070769"]]},{"id":"cefdbd741ccca6a9","type":"api-render-template","z":"c375fce693136161","name":"Prévision Méteo","server":"43d85569dace75e0","version":0,"template":"Coucou ... bulletin méteo... Une journée{% set condition =\n(states.weather.la_chevroliere.attributes.forecast[0].condition) %} {% set\nconditions = {'clear-night': 'nuit dégagée', 'cloudy': 'nuageuse',\n'exceptional': 'exceptionnelle', 'fog': ' avec broullard', 'hail': 'grêle',\n'lightning': 'Orageuse', 'lightning-rainy': 'orageuse avec de la pluie',\n'partlycloudy': 'partiellement nuageuse', 'pouring': ' avec pluie\ntorentielle', 'rainy': 'pluvieuse', 'snowy': 'avec de la neige',\n'snowy-rainy': ' avec neige et pluvieuse', 'sunny': 'ensoleillé', 'windy':\n'Venteuse', 'windy-variant': 'variante venteuse'} %} {{\nconditions[condition] }} est attendue aujourd'hui , avec une température\nmoyenne de {{state_attr('weather.la_chevroliere', 'forecast')[0].temperature\n}}°C et un minimum de {{state_attr('weather.la_chevroliere',\n'forecast')[0].templow }}°C. Demain une journée {% set condition =\n(states.weather.la_chevroliere.attributes.forecast[1].condition) %} {% set\nconditions = {'clear-night': 'nuit claire', 'cloudy': 'nuageuse',\n'exceptional': 'exceptionnelle', 'fog': ' avec broullard', 'hail': 'grêle',\n'lightning': 'Orageuse', 'lightning-rainy': 'orageuse avec de la pluie',\n'partlycloudy': 'partiellement nuageuse', 'pouring': ' avec pluie\ntorentielle', 'rainy': 'pluvieuse', 'snowy': 'avec de la neige',\n'snowy-rainy': ' avec neige et pluvieuse', 'sunny': 'ensoleillé', 'windy':\n'Venteuse', 'windy-variant': 'variante venteuse'} %} {{\nconditions[condition] }} est prévue avec une température maxi de\n{{state_attr('weather.la_chevroliere', 'forecast')[1].temperature }}","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":480,"y":580,"wires":[["50550b3226604282"]]},{"id":"50550b3226604282","type":"link out","z":"c375fce693136161","name":"","mode":"link","links":["93d062bbf9af5c89"],"x":635,"y":580,"wires":[]},{"id":"7251c6bb3c48619e","type":"comment","z":"c375fce693136161","name":"Prévision méteo","info":"","x":370,"y":520,"wires":[]},{"id":"754c951524912d4a","type":"inject","z":"c375fce693136161","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":190,"y":600,"wires":[["376d94a97ba0f4bb"]]},{"id":"376d94a97ba0f4bb","type":"function","z":"c375fce693136161","name":"Fin de l'alerte","func":"msg.payload =\n\n\"Fin de l'alerte météo \" + \"😁\"\n\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":480,"y":660,"wires":[["50550b3226604282"]]},{"id":"f675e9223eab38a4","type":"server-state-changed","z":"d7f40c000c1a05ef","name":"","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.myups_status","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":210,"y":340,"wires":[["b1f17329ce9f5fa9"]]},{"id":"56811617225d77bb","type":"server-state-changed","z":"d7f40c000c1a05ef","name":"","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"switch.nas_netgear","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":200,"y":260,"wires":[["55ff6fd3205be22b","6c4e885d50c8a89a"]]},{"id":"a15f2aab9e2ee711","type":"server-state-changed","z":"d7f40c000c1a05ef","name":"","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"switch.nas_nl54","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":210,"y":200,"wires":[["55ff6fd3205be22b","6c4e885d50c8a89a"]]},{"id":"55ff6fd3205be22b","type":"or-gate","z":"d7f40c000c1a05ef","name":"","rules":[{"t":"eq","v":"on","vt":"str","propertyType":"msg","property":"payload","topic":"switch.nas_nl54"},{"t":"eq","v":"on","vt":"str","propertyType":"msg","property":"payload","topic":"switch.nas_netgear"}],"outputTopic":"OrGate","gateType":"or","emitOnlyIfTrue":false,"x":480,"y":220,"wires":[["b1f17329ce9f5fa9"]]},{"id":"6c4e885d50c8a89a","type":"debug","z":"d7f40c000c1a05ef","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":520,"y":120,"wires":[]},{"id":"b1f17329ce9f5fa9","type":"and-gate","z":"d7f40c000c1a05ef","name":"","rules":[{"t":"eq","v":"On Battery Battery Discharging","vt":"str","propertyType":"msg","property":"payload","topic":"sensor.myups_status"},{"t":"true","propertyType":"msg","property":"payload","topic":"OrGate"}],"outputTopic":"","gateType":"and","emitOnlyIfTrue":true,"x":460,"y":320,"wires":[["7abec066704f616b"]]},{"id":"7abec066704f616b","type":"api-call-service","z":"d7f40c000c1a05ef","name":"NL54L OFF","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"shell_command","service":"turn_off_nas_nl54l","entityId":"","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":630,"y":280,"wires":[["c99e04c1506bee07"]]},{"id":"c99e04c1506bee07","type":"api-call-service","z":"d7f40c000c1a05ef","name":"NETGEAR OFF","server":"43d85569dace75e0","version":3,"debugenabled":false,"service_domain":"shell_command","service":"turn_off_nas_netgear","entityId":"","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":820,"y":220,"wires":[["e2b93ebf17b14a31"]]},{"id":"29fb1bebf00572d8","type":"function","z":"d7f40c000c1a05ef","name":"Intrusion détectée","func":"msg.payload =\n    \n    \"Coupure électrique détectée - extinction des NAS!! \" +\n    \" Nouveau statut: \" + msg.upsstatus\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1130,"y":280,"wires":[["1ac313adc77c3f51","1eaf29c1664d62d0"]]},{"id":"1ac313adc77c3f51","type":"link out","z":"d7f40c000c1a05ef","name":"Vers Pascal Telegram SMS","mode":"link","links":["93d062bbf9af5c89","a7ddbf0dfd2c325b"],"x":1400,"y":280,"wires":[],"l":true},{"id":"7109fdf4a0af3474","type":"inject","z":"d7f40c000c1a05ef","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":600,"y":560,"wires":[["e2b93ebf17b14a31"]]},{"id":"e2b93ebf17b14a31","type":"api-render-template","z":"d7f40c000c1a05ef","name":"UPS STATUT","server":"43d85569dace75e0","version":0,"template":"{{states('sensor.myups_status') }}","resultsLocation":"upsstatus","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":1020,"y":340,"wires":[["29fb1bebf00572d8","1eaf29c1664d62d0"]]},{"id":"1eaf29c1664d62d0","type":"debug","z":"d7f40c000c1a05ef","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":1270,"y":400,"wires":[]},{"id":"0a26de175c3c9fc4","type":"comment","z":"d7f40c000c1a05ef","name":"Auto OFF des NAS en cas de panne","info":"","x":310,"y":80,"wires":[]},{"id":"ec9d3a1c1dc839bf","type":"comment","z":"d7f40c000c1a05ef","name":"Notification - NAS-NETGEAR ou TRUENAS - ON","info":"Notifier quand NAS-NETGEAR OU TRUENAS est ON après une commande Alexa","x":340,"y":640,"wires":[]},{"id":"2698cd3d153c15d0","type":"server-state-changed","z":"d7f40c000c1a05ef","name":"","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"switch.nas_netgear","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":180,"y":780,"wires":[["e896ecf441d6b4a2"]]},{"id":"e896ecf441d6b4a2","type":"switch","z":"d7f40c000c1a05ef","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"eq","v":"off","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":460,"y":780,"wires":[["5ceaaa8711f49652"],["208f6454a82f298c"]]},{"id":"cce8ecd5bfb5e15d","type":"function","z":"d7f40c000c1a05ef","name":"Notification - Serveur Netgear","func":"msg.payload =\n\n\"Information matériel: Le serveur Netgear est en marche\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1000,"y":780,"wires":[["a223a810b90ddc58"]]},{"id":"a223a810b90ddc58","type":"link out","z":"d7f40c000c1a05ef","name":"VersEchos","mode":"link","links":["a7ddbf0dfd2c325b","ced87f2e5d5c0601","d1dc7f1a2fa6359d"],"x":1260,"y":780,"wires":[],"l":true},{"id":"bc10b2d959762d32","type":"server-state-changed","z":"d7f40c000c1a05ef","name":"","server":"43d85569dace75e0","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"switch.nas_nl54","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":180,"y":900,"wires":[["1e901736a61274f9"]]},{"id":"1e901736a61274f9","type":"switch","z":"d7f40c000c1a05ef","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"eq","v":"off","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":470,"y":900,"wires":[["c69c44324725d284"],["5e8e6ca82e9ace6d"]]},{"id":"e888639162360703","type":"function","z":"d7f40c000c1a05ef","name":"Notification - Serveur de fichiers","func":"msg.payload =\n\n\"Information matériel: Le serveur fichiers est en marche\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1020,"y":900,"wires":[["7352a58f1f38b85b"]]},{"id":"7352a58f1f38b85b","type":"link out","z":"d7f40c000c1a05ef","name":"VersTelegram","mode":"link","links":["a7ddbf0dfd2c325b"],"x":1270,"y":900,"wires":[],"l":true},{"id":"c69c44324725d284","type":"api-render-template","z":"d7f40c000c1a05ef","name":"isNL54On","server":"43d85569dace75e0","version":0,"template":"{{true if states('switch.nas_nl54') != 'on' }}\n{{false if states('switch.nas_nl54') == 'on' }}","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":630,"y":900,"wires":[["19f67a3ea3ffa196"]]},{"id":"19f67a3ea3ffa196","type":"switch","z":"d7f40c000c1a05ef","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"True","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":780,"y":900,"wires":[["e888639162360703"]]},{"id":"5ceaaa8711f49652","type":"api-render-template","z":"d7f40c000c1a05ef","name":"isNetgearON","server":"43d85569dace75e0","version":0,"template":"{{true if states('switch.nas_netgear') != 'on' }}\n{{false if states('switch.nas_netgear') == 'on' }}","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":640,"y":780,"wires":[["ea7b8edd7e91a9d4"]]},{"id":"ea7b8edd7e91a9d4","type":"switch","z":"d7f40c000c1a05ef","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"True","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":800,"y":780,"wires":[["cce8ecd5bfb5e15d"]]},{"id":"d67d1a6d0dc5fcd3","type":"function","z":"d7f40c000c1a05ef","name":"Notification - Serveur Netgear","func":"msg.payload =\n\n\"Information matériel: Le serveur Netgear est arrêté\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1000,"y":820,"wires":[["c0393896f8e316ad"]]},{"id":"c0393896f8e316ad","type":"link out","z":"d7f40c000c1a05ef","name":"VersEchos","mode":"link","links":["a7ddbf0dfd2c325b","ced87f2e5d5c0601","d1dc7f1a2fa6359d"],"x":1260,"y":820,"wires":[],"l":true},{"id":"208f6454a82f298c","type":"api-render-template","z":"d7f40c000c1a05ef","name":"isNetgearOFF","server":"43d85569dace75e0","version":0,"template":"{{true if states('switch.nas_netgear') != 'off' }}\n{{false if states('switch.nas_netgear') == 'off' }}","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":650,"y":820,"wires":[["4ccb6acf94f26f5d"]]},{"id":"4ccb6acf94f26f5d","type":"switch","z":"d7f40c000c1a05ef","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"True","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":800,"y":820,"wires":[["d67d1a6d0dc5fcd3"]]},{"id":"5076ec3b69ac4314","type":"function","z":"d7f40c000c1a05ef","name":"Notification - Serveur de fichiers","func":"msg.payload =\n\n\"Information matériel: Le serveur fichiers est arrêté\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1020,"y":960,"wires":[["9a92f32be29dff0b"]]},{"id":"9a92f32be29dff0b","type":"link out","z":"d7f40c000c1a05ef","name":"VersTelegram","mode":"link","links":["a7ddbf0dfd2c325b"],"x":1270,"y":960,"wires":[],"l":true},{"id":"5e8e6ca82e9ace6d","type":"api-render-template","z":"d7f40c000c1a05ef","name":"isNL54On","server":"43d85569dace75e0","version":0,"template":"{{true if states('switch.nas_nl54') != 'off' }}\n{{false if states('switch.nas_nl54') == 'off' }}","resultsLocation":"payload","resultsLocationType":"msg","templateLocation":"template","templateLocationType":"msg","x":630,"y":960,"wires":[["e23f0a185513ede3"]]},{"id":"e23f0a185513ede3","type":"switch","z":"d7f40c000c1a05ef","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"True","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":780,"y":960,"wires":[["5076ec3b69ac4314"]]}]