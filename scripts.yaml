desactivation_alarme_nuit:
  alias: Alarme - Désactivation mode nuit
  sequence:
  - type: turn_off
    device_id: 1108bbb071a63feba904b38a0809c9ef
    entity_id: switch.sirene_garage_switch
    domain: switch
  - service: script.notification_alexa_cuisine
    data:
      message: <amazon:effect name='whispered'>Alarme pour la nuit est maintenant
        désactivée!!!</amazon:effect>
  - service: alarm_control_panel.alarm_disarm
    data: {}
    entity_id: alarm_control_panel.blink_maison
  - service: script.telegram_tous
    data:
      message: Alarme  désactivée à {{ states('sensor.time') }}
  mode: single
  icon: mdi:alarm-bell
envoyer_last_ring_doorbird_telegram:
  alias: Doorbird - Envoyer last_Ring via telegram
  sequence:
  - delay: '5'
  - service: camera.snapshot
    entity_id: camera.portier_last_ring
    data:
      filename: /config/www/snapshots/snapshots_portier_last_ring.jpg
  - delay: '2'
  - service: telegram_bot.send_photo
    data:
      file: /config/www/snapshots/snapshots_portier_last_ring.jpg
      target: '246735540'
  mode: single
  icon: mdi:camera-front
envoyer_un_mms:
  alias: Envoyer un mms
  sequence:
  - service: notify.sms_pascal
    data:
      title: Doorbell
      message: Une personne sonne au portail
      data:
        images:
        - /config/www/snapshots/snapshots_portier_last_ring.jpg
  mode: single
snapshot_cam_garage_vers_telegram:
  alias: Camera Garage - Snapshot vers telegram
  sequence:
  - service: blink.trigger_camera
    data:
      entity_id: camera.blink_cam_garage
  - delay: '5'
  - service: blink.blink_update
    data: {}
  - delay: '2'
  - service: camera.snapshot
    data:
      filename: /config/www/snapshots/snapshots_blink_cam_garage.jpg
    entity_id: camera.blink_cam_garage
  - service: telegram_bot.send_photo
    data:
      file: /config/www/snapshots/snapshots_blink_cam_garage.jpg
      target: '246735540'
  - service: telegram_bot.send_photo
    data:
      file: /config/www/snapshots/snapshots_blink_cam_garage.jpg
      target: '315573228'
  mode: single
  icon: mdi:cctv
alexa_colis:
  alias: Notification - annoncer un colis
  sequence:
  - service: script.notification_sms_variable_message_obligatoire_stephanie_duplicate
    data:
      message: Un colis a été déposé dans la boite aux lettres !!!
  - delay:
      hours: 0
      minutes: 0
      seconds: 10
      milliseconds: 0
  - service: script.notification_sms_variable_obligatoire_pascal
    data:
      message: Un colis a été déposé dans la boite aux lettres !!!
  - service: script.snapshot_doobird_telegram
    data: {}
  - service: script.notification_alexa_cuisine
    data:
      message: Un colis a été déposé dans la boite aux lettres !!!
  mode: single
  icon: mdi:cube
eteindre_des_appareils_pour_la_nuit:
  alias: Alarme - Éteindre des appareils en mode nuit
  sequence:
  - type: turn_off
    device_id: 3c5b5cf5f84886f42059d0a23d64ac09
    entity_id: switch.prisetv_salon_switch
    domain: switch
  - type: turn_off
    device_id: 4942a6bddcf769b3f7ec50a2877fe694
    entity_id: switch.prise_bureau_chambre_clarence
    domain: switch
  - type: turn_off
    device_id: 18a82f3877d876fdbb8f16e454b6f845
    entity_id: switch.onoff_tv_chambre_jardin_switch_2
    domain: switch
  - type: turn_off
    device_id: 87b502772e2fe9cb7c2dad2f09dbd72a
    entity_id: switch.onoff_tv_chambre_parent_switch
    domain: switch
  mode: single
  icon: mdi:alarm-bell
alarme_desactivation:
  alias: Alarme - Désactivation
  sequence:
  - type: turn_off
    device_id: 1108bbb071a63feba904b38a0809c9ef
    entity_id: switch.sirene_garage_switch
    domain: switch
  - type: turn_off
    device_id: 2c8fd124a13a66f5d4c300bc0b5f15d3
    entity_id: switch.sirene_entree_switch_2
    domain: switch
  - service: script.alarme_notification
    data:
      message: Alarme  désactivée à "{{ states('sensor.time') }}"
  - service: script.notification_alexa_cuisine
    data:
      message: Alarme  désactivée à "{{ states('sensor.time') }}"
  - service: alarm_control_panel.alarm_disarm
    data: {}
    entity_id: alarm_control_panel.blink_maison
  mode: single
  icon: mdi:alarm-bell
allumer_des_appareils_quand_alarme_eteinte:
  alias: Alarme - Allumer des appareils après mode nuit
  sequence:
  - type: turn_on
    device_id: 4942a6bddcf769b3f7ec50a2877fe694
    entity_id: switch.prise_bureau_chambre_clarence
    domain: switch
  - type: turn_on
    device_id: 3c5b5cf5f84886f42059d0a23d64ac09
    entity_id: switch.prisetv_salon_switch
    domain: switch
  mode: single
  icon: mdi:alarm-bell
telegram_tous:
  alias: Telegram - Notification Variable {{message}} obligatoire - Tous
  sequence:
  - service: notify.telegram_pascal
    data:
      message: '{{ message }}'
  - service: notify.telegram_stephanie
    data:
      message: '{{ message }}'
  - service: notify.telegram_eloise
    data:
      message: '{{ message }}'
  mode: single
envoyer_last_move_doorbird_via_telegram_duplicate:
  alias: Doorbird - Envoyer last_motion via telegram
  sequence:
  - delay: '5'
  - service: camera.snapshot
    entity_id: camera.portier_last_motion
    data:
      filename: /config/www/snapshots/snapshots_portier_last_motion.jpg
  - delay: '2'
  - service: telegram_bot.send_photo
    data:
      file: /config/www/snapshots/snapshots_portier_last_motion.jpg
      target: '246735540'
  - service: telegram_bot.send_photo
    data:
      file: /config/www/snapshots/snapshots_portier_last_motion.jpg
      target: '315573228'
  mode: single
  icon: mdi:camera-front
ouverture_partielle_portail:
  alias: Portail extérieur - Ouverture partielle portail
  sequence:
  - type: turn_on
    device_id: 45e8584c4797248cd483bcf51c0664a9
    entity_id: switch.portail_exterieur
    domain: switch
  - delay: '6'
  - type: turn_on
    device_id: 45e8584c4797248cd483bcf51c0664a9
    entity_id: switch.portail_exterieur
    domain: switch
  mode: single
  icon: mdi:gate
snapshot_doobird_telegram:
  alias: Doorbird - Snapshot via telegram
  sequence:
  - service: camera.snapshot
    data:
      filename: /config/www/snapshots/snapshots_doorbird.jpg
    entity_id: camera.portier_live
  - delay: '5'
  - service: telegram_bot.send_photo
    data:
      file: /config/www/snapshots/snapshots_doorbird.jpg
      target: '246735540'
  - service: telegram_bot.send_photo
    data:
      file: /config/www/snapshots/snapshots_doorbird.jpg
      target: '315573228'
  - service: telegram_bot.send_photo
    data:
      target: '2099122657'
      file: /config/www/snapshots/snapshots_doorbird.jpg
  mode: single
  icon: mdi:camera-front
alexa_courrier:
  alias: Notification - annonce un courrier
  sequence:
  - service: script.notification_sms_variable_message_obligatoire_stephanie_duplicate
    data:
      message: Du courrier a été déposé dans la boite aux lettres !!!
  - service: script.snapshot_doobird_telegram
    data: {}
  - delay:
      hours: 0
      minutes: 0
      seconds: 10
      milliseconds: 0
  - service: script.notification_sms_variable_obligatoire_pascal
    data:
      message: Du courrier a été déposé dans la boite aux lettres !!!
  - service: script.notification_alexa_cuisine
    data:
      message: Du courrier a été déposé dans la boite aux lettres !!!
  mode: single
  icon: mdi:email-newsletter
notification_alexa_cuisine:
  alias: Alexa - Notification - Cuisine - Variable
  sequence:
  - service: notify.alexa_media_echo_cuisine
    data:
      data:
        type: announce
      message: '{{ message }}'
  mode: single
  icon: mdi:cube
notification_alexa_clarence:
  alias: Alexa - Notification - Clarence - Variable
  sequence:
  - service: media_player.volume_up
    data: {}
    entity_id: media_player.joret_2eme_echo_dot
  - delay: '2'
  - service: notify.alexa_media_echo_clarence
    data:
      data:
        type: announce
      message: '{{ message }}'
  mode: single
  icon: mdi:cube
notification_alexa_eloise:
  alias: Alexa - Notification - Eloise - Variable
  sequence:
  - service: media_player.volume_up
    data: {}
    entity_id: media_player.cuisine_echo_dot
  - delay: '2'
  - service: notify.alexa_media_echo_eloise
    data:
      data:
        type: announce
      message: '{{ message }}'
  mode: single
  icon: mdi:cube
volume_alexa_tous:
  alias: Alexa - Volume - Tous
  sequence:
  - service: media_player.volume_up
    data: {}
    entity_id: media_player.joret_2eme_echo_dot
  - delay: '1'
  - service: media_player.volume_up
    data: {}
    entity_id: media_player.cuisine_echo_dot
  - delay: '1'
  - service: media_player.volume_up
    data: {}
    entity_id: media_player.joret_3eme_echo_dot
  mode: single
  icon: mdi:cube
alexa_notification_tous:
  alias: Alexa - Notification - Tous
  sequence:
  - service: notify.alexa_media_echo_clarence
    data:
      data:
        type: announce
      message: '{{ message }}'
  - service: notify.alexa_media_echo_eloise
    data:
      data:
        type: announce
      message: '{{ message }}'
  - service: notify.alexa_media_echo_cuisine
    data:
      data:
        type: announce
      message: '{{ message }}'
  mode: single
  icon: mdi:cube
telegram_notification_pascal:
  alias: Telegram - Notification Variable {{message}} obligatoire - Pascal
  sequence:
  - service: notify.telegram_pascal
    data:
      message: '{{ message }}'
  mode: single
telegram_notification_stephanie:
  alias: Telegram - Notification Variable {{message}} obligatoire - Stephanie
  sequence:
  - service: notify.telegram_stephanie
    data:
      message: '{{ message }}'
  mode: single
alarme_notification:
  alias: Alarme - Notification
  sequence:
  - service: script.telegram_tous
    data:
      message: '{{ message }}'
  - service: script.notification_sms_variable_message_obligatoire_stephanie_duplicate
    data:
      message: '{{ message }}'
  - service: script.notification_sms_variable_obligatoire_pascal
    data:
      message: '{{ message }}'
  mode: single
  icon: mdi:alarm-bell
notification_sms_variable_obligatoire_pascal:
  alias: Notification SMS - Variable {{message}} obligatoire - Pascal
  sequence:
  - service: notify.huawei_lte
    data:
      target: 650295195
      message: '{{ message }}'
  mode: single
notification_sms_variable_message_obligatoire_stephanie_duplicate:
  alias: Notification SMS - Variable {{message}} obligatoire - Stephanie
  sequence:
  - service: notify.huawei_lte
    data:
      message: '{{ message }}'
      target: 604420252
  mode: single
notification_sms_variable_message_obligatoire_eloise:
  alias: 'Notification SMS - Variable {{message}} obligatoire - Eloise '
  sequence:
  - service: notify.huawei_lte
    data:
      message: '{{ message }}'
      target: 651213063
  mode: single
notification_sms_variable_message_obligatoire_clarence:
  alias: Notification SMS - Variable {{message}} obligatoire - Clarence
  sequence:
  - service: notify.huawei_lte
    data:
      message: '{{ message }}'
      target: 752031947
  mode: single
notification_sms_variable_message_obligatoire_tous:
  alias: Notification SMS - Variable {{message}} obligatoire - Tous
  sequence:
  - service: notify.huawei_lte
    data:
      message: '{{ message }}'
      target: 604420252
  - delay:
      hours: 0
      minutes: 0
      seconds: 5
      milliseconds: 0
  - service: notify.huawei_lte
    data:
      message: '{{ message }}'
      target: 752031947
  - delay:
      hours: 0
      minutes: 0
      seconds: 5
      milliseconds: 0
  - service: notify.huawei_lte
    data:
      message: '{{ message }}'
      target: 651213063
  - delay:
      hours: 0
      minutes: 0
      seconds: 5
      milliseconds: 0
  - service: notify.huawei_lte
    data:
      target: 650295195
      message: '{{ message }}'
  mode: single
aspirateur_nettoyage_des_segments:
  alias: Aspirateur Nettoyage Segments rdc
  sequence:
  - service: script.turn_on
    target:
      entity_id: script.aspirateur_nettoyage_segments_message
    data:
      variables:
        segments: '{{expand("group.aspirateurs_rooms_rdc") | selectattr("state","eq","on")  |
          map(attribute="attributes.room_id") | list | to_json}}'
  mode: single
  icon: mdi:arrow-right
aspirateur_nettoyage_segments_message:
  alias: Aspirateur nettoyage segments message rdc
  sequence:
  - service: mqtt.publish
    data:
      topic: valetudo/aspirateur_dream_d9_rdc/MapSegmentationCapability/clean/set
      payload_template: '{"segment_ids": {{segments}}}'
  mode: single
alarme_passage_des_radiateurs_en_mode_eco:
  alias: Alarme - passage des radiateurs en mode Eco
  sequence:
  - service: climate.set_preset_mode
    target:
      entity_id:
      - climate.radiateur_buanderie
    data:
      preset_mode: eco
  - delay:
      hours: 0
      minutes: 0
      seconds: 2
      milliseconds: 0
  - service: climate.set_preset_mode
    target:
      entity_id:
      - climate.radiateur_ch_jardin
    data:
      preset_mode: eco
  - delay:
      hours: 0
      minutes: 0
      seconds: 2
      milliseconds: 0
  - service: climate.set_preset_mode
    target:
      entity_id:
      - climate.radiateur_ch_rue
    data:
      preset_mode: eco
  - service: climate.set_preset_mode
    target:
      entity_id:
      - climate.radiateur_cuisine
    data:
      preset_mode: eco
  - delay:
      hours: 0
      minutes: 0
      seconds: 2
      milliseconds: 0
  - service: climate.set_preset_mode
    target:
      entity_id:
      - climate.radiateur_sam
    data:
      preset_mode: eco
  - delay:
      hours: 0
      minutes: 0
      seconds: 2
      milliseconds: 0
  - service: script.telegram_tous
    data:
      message: ' Passage des radiateurs en mode eco pour la nuit'
  mode: single
  icon: mdi:radiator-off
aspirateur_nettoyage_segments_message_etage:
  alias: Aspirateur nettoyage segments message etage
  sequence:
  - service: mqtt.publish
    data:
      topic: valetudo/aspirateur_etage_dream_d9/MapSegmentationCapability/clean/set
      payload_template: '{"segment_ids": {{segments}}}'
  mode: single
aspirateur_nettoyage_segments_etage:
  alias: Aspirateur Nettoyage Segments etage
  sequence:
  - service: script.turn_on
    target:
      entity_id: script.aspirateur_nettoyage_segments_message_etage
    data:
      variables:
        segments: '{{expand("group.aspirateurs_rooms_etage") | selectattr("state","eq","on")  |
          map(attribute="attributes.room_id") | list | to_json}}'
  mode: single
  icon: mdi:arrow-right
alexa_notification_sam_variable:
  alias: Alexa - Notification - SAM - Variable
  sequence:
  - service: notify.alexa_media_joret_echo_flex
    data:
      data:
        type: announce
      message: '{{ message }}'
  mode: single
  icon: mdi:cube
alarme_fermeture_des_volets:
  alias: Alarme - Fermeture des volets
  sequence:
  - service: cover.close_cover
    target:
      entity_id:
      - cover.volet_sam_grand
  mode: single
  icon: mdi:curtains-closed
alarme_eteindre_des_appareils_en_mode_totale:
  alias: Alarme - Éteindre des appareils en mode totale
  sequence:
  - type: turn_off
    device_id: 3c5b5cf5f84886f42059d0a23d64ac09
    entity_id: switch.prisetv_salon_switch
    domain: switch
  - type: turn_off
    device_id: 4942a6bddcf769b3f7ec50a2877fe694
    entity_id: switch.prise_bureau_chambre_clarence
    domain: switch
  - type: turn_off
    device_id: 18a82f3877d876fdbb8f16e454b6f845
    entity_id: switch.onoff_tv_chambre_jardin_switch_2
    domain: switch
  - type: turn_off
    device_id: 87b502772e2fe9cb7c2dad2f09dbd72a
    entity_id: switch.onoff_tv_chambre_parent_switch
    domain: switch
  - type: turn_off
    device_id: f2ce7fb51b013bada97928ca97d7a817
    entity_id: switch.onoff_bureau_salon_switch_3
    domain: switch
  - type: turn_on
    device_id: 6f9cedbbd8180b11e3a173ec3491c13a
    entity_id: switch.onoff_distributeurchaleur_switch
    domain: switch
  mode: single
  icon: mdi:alarm-bell
